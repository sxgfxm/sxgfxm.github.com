<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Light's Blog]]></title>
  <link href="http://sxgfxm.github.io/atom.xml" rel="self"/>
  <link href="http://sxgfxm.github.io/"/>
  <updated>2017-09-30T10:07:17+08:00</updated>
  <id>http://sxgfxm.github.io/</id>
  <author>
    <name><![CDATA[Light]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[iOS知识小集-170925]]></title>
    <link href="http://sxgfxm.github.io/blog/2017/09/29/ioszhi-shi-xiao-ji-170925/"/>
    <updated>2017-09-29T17:49:31+08:00</updated>
    <id>http://sxgfxm.github.io/blog/2017/09/29/ioszhi-shi-xiao-ji-170925</id>
    <content type="html"><![CDATA[<h2>URL encode</h2>

<p>string -> url，特殊字符需要编码。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="p">-</span> <span class="p">(</span><span class="bp">NSString</span> <span class="o">*</span><span class="p">)</span><span class="nf">urlEncode:</span><span class="p">(</span><span class="bp">NSString</span> <span class="o">*</span><span class="p">)</span><span class="nv">string</span> <span class="p">{</span>
</span><span class='line'>  <span class="bp">NSCharacterSet</span> <span class="o">*</span><span class="n">set</span> <span class="o">=</span> <span class="p">[</span><span class="bp">NSCharacterSet</span> <span class="nl">characterSetWithCharactersInString</span><span class="p">:</span><span class="s">@&quot;;/?:@=&amp;&lt;&gt;</span><span class="se">\&quot;</span><span class="s">#%{}|</span><span class="se">\\</span><span class="s">^~[]` ()&quot;</span><span class="p">].</span><span class="n">invertedSet</span><span class="p">;</span>
</span><span class='line'>  <span class="k">return</span> <span class="p">[</span><span class="n">string</span> <span class="nl">stringByAddingPercentEncodingWithAllowedCharacters</span><span class="p">:</span><span class="n">set</span><span class="p">];</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>




<!-- more -->


<h2>Git fetch remote branch</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'>  <span class="n">git</span> <span class="n">fetch</span>
</span><span class='line'>  <span class="n">git</span> <span class="n">checkout</span> <span class="o">-</span><span class="n">b</span> <span class="n">localBanchName</span> <span class="n">remoteBranchName</span>
</span><span class='line'>  <span class="n">git</span> <span class="n">branch</span> <span class="o">-</span><span class="n">vv</span>
</span></code></pre></td></tr></table></div></figure>


<h2>NSNumberFormatter</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'>  <span class="bp">NSNumberFormatter</span> <span class="o">*</span><span class="n">formatter</span> <span class="o">=</span> <span class="p">[[</span><span class="bp">NSNumberFormatter</span> <span class="n">alloc</span><span class="p">]</span> <span class="n">init</span><span class="p">];</span>
</span><span class='line'>  <span class="n">formatter</span><span class="p">.</span><span class="n">numberStyle</span> <span class="o">=</span> <span class="n">NSNumberFormatterPercentStyle</span><span class="p">;</span>
</span><span class='line'>  <span class="bp">NSNumber</span> <span class="o">*</span><span class="n">number</span> <span class="o">=</span> <span class="p">[</span><span class="n">formatter</span> <span class="nl">numberFromString</span><span class="p">:</span><span class="n">index</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure>


<h2>layoutSubviews</h2>

<p>当frame改变时调用</p>

<h2>AVAudioSession</h2>

<p>The session&rsquo;s category and mode together define how the application intends to use audio.</p>

<h2>AVAudioSessionCategory</h2>

<p>Each app running in iOS has a single audio session, which in turn has a single category. You can change your audio session’s category while your app is running.</p>

<p><strong>AVAudioSessionCategoryAmbient</strong>：可以与其他app混合，锁屏停止播放，受静音键控制。<br/>
<strong>AVAudioSessionCategorySoloAmbient</strong>：默认设置，不可以与其他app混合，锁屏停止播放，受静音键控制。<br/>
<strong>AVAudioSessionCategoryPlayback</strong>：混合其他app需要设置，后台播放需要设置，锁屏继续播放，不受静音键控制。<br/>
<strong>AVAudioSessionCategoryRecord</strong>：用于录音，会打断音频播放，后台录音需要设置，且需要申请录音权限。<br/>
<strong>AVAudioSessionCategoryPlayAndRecord</strong>：既可以录音也可以播放，混合其他app需要设置。<br/>
<strong>AVAudioSessionCategoryMultiRoute</strong>：既可以录音也可以播放，用于多路输出。</p>

<h2>AVAudioSessionCategoryOptions</h2>

<p>Constants that specify optional audio behaviors. Each option is valid only with specific audio session categories.<br/>
options需要配合category使用。</p>

<p><strong>AVAudioSessionCategoryOptionMixWithOthers</strong>：允许与其他active session混合。<br/>
<strong>AVAudioSessionCategoryOptionDuckOthers</strong>：使其他audio session声音减弱。<br/>
<strong>AVAudioSessionCategoryOptionAllowBluetooth</strong>：使蓝牙设备可作为音频输入设备。<br/>
<strong>AVAudioSessionCategoryOptionDefaultToSpeaker</strong>：在没有其他输出设备时，通过手机扬声器播放音频，否则通过听筒播放。<br/>
<strong>AVAudioSessionCategoryOptionInterruptSpokenAudioAndMixWithOthers</strong>：会暂停其他音乐播放，适用于指引类app。<br/>
<strong>AVAudioSessionCategoryOptionAllowAirPlay</strong>：允许AirPlay播放。<br/>
<strong>AVAudioSessionCategoryOptionAllowBluetoothA2DP</strong>：允许蓝牙播放。</p>

<p>语音识别界面：可录音，可播放，不受静音键控制；可混合；扬声器发声；可蓝牙播放；可后台播放。</p>

<h2><a href="https://github.com/ReactiveCocoa/ReactiveCocoa">ReactiveCocoa</a></h2>

<p>ReactiveCocoa is an open source library that brings Functional Reactive Programming paradigm to Objective-C.<br/>
Functional Reactive Programming (FRP) is a way of thinking about software in terms of transforming inputs to produce output continuously over time.</p>

<p>ReactiveCocoa is comprised of two major components: signals (<strong>RACSignal</strong>) and sequences (<strong>RACSequence</strong>).
Both signals and sequences are kinds of streams, sharing many of the same operators. Signals are a push-driven stream, and sequences are a pull-driven stream.</p>

<h3>RACSignal</h3>

<ol>
<li>Handling Asynchronous Or Event-driven Data Sources.</li>
<li>Chaining Dependent Operations.</li>
<li>Parallelizing Independent Work.</li>
</ol>


<p>Events signals send:<br/>
1. The <strong>next</strong> event provides a new value from the stream.
2. The <strong>error</strong> event indicates that an error occurred before the signal could finish.
3. The <strong>completed</strong> event indicates that the signal finished successfully, and that no more values will be added to the stream.</p>

<h3>RACSequence</h3>

<p>Simplifying Collection Transformations.<br/>
The values in a sequence are evaluated lazily (i.e., only when they are needed) by default.<br/>
Just like Cocoa collections, sequences cannot contain nil.</p>

<h3>RAC vs. KVO</h3>

<p>KVO is neither pleasant nor easy to use: its API is overwrought with unused parameters and sorely lacking a blocks-based interface.</p>

<h3>RAC vs. Bindings</h3>

<p>RAC offers a clear, understandable, and extensible code-based API that works in iOS and is apt to replace all but the most trivial uses of bindings in your OS X application.</p>

<h2><a href="https://github.com/ReactiveCocoa/ReactiveObjC">ReactiveObjC</a></h2>

<p>ReactiveObjC(RAC) is an Objective-C framework inspired by <a href="https://en.wikipedia.org/wiki/Functional_reactive_programming">Functional Reactive Programming</a>.<br/>
It provides APIs for <strong>composing and transforming streams of values. </strong><br/>
ReactiveObjC supports OS X 10.8+ and <strong>iOS 8.0+</strong>.</p>

<h3>Features:</h3>

<ol>
<li>RAC provides <strong>signals</strong> (represented by <strong>RACSigal</strong>) that capture present and future values.</li>
<li>RAC provides <strong>unified approach</strong> to dealing with asynchronous behaviors.</li>
<li>Signals can be <strong>chained together</strong> and operated on.</li>
<li>Signals can be used to <strong>derive state</strong>.</li>
<li>Signals can be built on <strong>any stream of values</strong> over time.</li>
<li>Signals can also represent timers, other UI events, or anything else that <strong>changes over time</strong>.</li>
<li>Signals can be chained to <strong>sequentially execute asynchronous operations</strong>, instead of nesting callbacks with blocks.</li>
<li>RAC even makes it easy to <strong>bind</strong> to the result of an asynchronous operation.</li>
</ol>


<h3>When to use ReactiveObjC</h3>

<ol>
<li>Handling asynchronous or event-driven data sources.</li>
<li>Chaining dependent operations.</li>
<li>Parallelizing independent work.</li>
<li>Simplifying collection transformations.<p class='post-footer'>
原始地址：
<a href='http://sxgfxm.github.io/blog/2017/09/29/ioszhi-shi-xiao-ji-170925/'><a href="http://sxgfxm.github.io/blog/2017/09/29/ioszhi-shi-xiao-ji-170925/">http://sxgfxm.github.io/blog/2017/09/29/ioszhi-shi-xiao-ji-170925/</a></a><br/>
written by <a href='http://sxgfxm.github.io'>Light</a>
&nbsp;posted at <a href='http://sxgfxm.github.io'><a href="http://sxgfxm.github.io">http://sxgfxm.github.io</a></a>
</p></li>
</ol>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[iOS知识小集-170918]]></title>
    <link href="http://sxgfxm.github.io/blog/2017/09/22/ioszhi-shi-xiao-ji-170918/"/>
    <updated>2017-09-22T10:50:20+08:00</updated>
    <id>http://sxgfxm.github.io/blog/2017/09/22/ioszhi-shi-xiao-ji-170918</id>
    <content type="html"><![CDATA[<h2>UIButton Gestures</h2>

<p><code>UIControlEventTouchDown</code>：按下button；<br/>
<code>UIControlEventTouchDragExit</code>：拖动至button范围（button四周有一定范围）外；<br/>
<code>UIControlEventTouchDragEnter</code>：拖动至button范围（button四周有一定范围）内。<br/>
<code>UIControlEventTouchUpInside</code>：在button内松手；<br/>
<code>UIControlEventTouchUpOutside</code>：在button外松手；<br/>
<code>UIControlEventTouchDragOutside</code>：在button外拖动。<br/>
<code>UIControlEventTouchDragInside</code>：在button内拖动；<br/>
<code>UIControlEventTouchCancel</code>：系统行为取消touch；</p>

<!-- more -->


<h2>UIGraphics Image Context</h2>

<p>参考<a href="https://onevcat.com/2013/04/using-blending-in-ios/">这篇文章</a>。</p>

<p>关于blend mode参数解释：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>R is the premultiplied result
</span><span class='line'>S is the source color, and includes alpha
</span><span class='line'>D is the destination color, and includes alpha
</span><span class='line'>Ra, Sa, and Da are the alpha components of R, S, and D</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="c1">//  UIImage+Tint.m</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#import &quot;UIImage+Tint.h&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="k">@implementation</span> <span class="bp">UIImage</span> <span class="nl">(Tint)</span>
</span><span class='line'><span class="p">-</span> <span class="p">(</span><span class="bp">UIImage</span> <span class="o">*</span><span class="p">)</span> <span class="nf">imageWithTintColor:</span><span class="p">(</span><span class="bp">UIColor</span> <span class="o">*</span><span class="p">)</span><span class="nv">tintColor</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="p">[</span><span class="nb">self</span> <span class="nl">imageWithTintColor</span><span class="p">:</span><span class="n">tintColor</span> <span class="nl">blendMode</span><span class="p">:</span><span class="n">kCGBlendModeDestinationIn</span><span class="p">];</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="p">-</span> <span class="p">(</span><span class="bp">UIImage</span> <span class="o">*</span><span class="p">)</span> <span class="nf">imageWithGradientTintColor:</span><span class="p">(</span><span class="bp">UIColor</span> <span class="o">*</span><span class="p">)</span><span class="nv">tintColor</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="p">[</span><span class="nb">self</span> <span class="nl">imageWithTintColor</span><span class="p">:</span><span class="n">tintColor</span> <span class="nl">blendMode</span><span class="p">:</span><span class="n">kCGBlendModeOverlay</span><span class="p">];</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="p">-</span> <span class="p">(</span><span class="bp">UIImage</span> <span class="o">*</span><span class="p">)</span> <span class="nf">imageWithTintColor:</span><span class="p">(</span><span class="bp">UIColor</span> <span class="o">*</span><span class="p">)</span><span class="nv">tintColor</span> <span class="nf">blendMode:</span><span class="p">(</span><span class="bp">CGBlendMode</span><span class="p">)</span><span class="nv">blendMode</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="c1">//We want to keep alpha, set opaque to NO; Use 0.0f for scale to use the scale factor of the device’s main screen.</span>
</span><span class='line'>    <span class="n">UIGraphicsBeginImageContextWithOptions</span><span class="p">(</span><span class="nb">self</span><span class="p">.</span><span class="n">size</span><span class="p">,</span> <span class="nb">NO</span><span class="p">,</span> <span class="mf">0.0f</span><span class="p">);</span>
</span><span class='line'>    <span class="p">[</span><span class="n">tintColor</span> <span class="n">setFill</span><span class="p">];</span>
</span><span class='line'>    <span class="bp">CGRect</span> <span class="n">bounds</span> <span class="o">=</span> <span class="n">CGRectMake</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">self</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">width</span><span class="p">,</span> <span class="nb">self</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">height</span><span class="p">);</span>
</span><span class='line'>    <span class="n">UIRectFill</span><span class="p">(</span><span class="n">bounds</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">//Draw the tinted image in context</span>
</span><span class='line'>    <span class="p">[</span><span class="nb">self</span> <span class="nl">drawInRect</span><span class="p">:</span><span class="n">bounds</span> <span class="nl">blendMode</span><span class="p">:</span><span class="n">blendMode</span> <span class="nl">alpha</span><span class="p">:</span><span class="mf">1.0f</span><span class="p">];</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="n">blendMode</span> <span class="o">!=</span> <span class="n">kCGBlendModeDestinationIn</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="p">[</span><span class="nb">self</span> <span class="nl">drawInRect</span><span class="p">:</span><span class="n">bounds</span> <span class="nl">blendMode</span><span class="p">:</span><span class="n">kCGBlendModeDestinationIn</span> <span class="nl">alpha</span><span class="p">:</span><span class="mf">1.0f</span><span class="p">];</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="bp">UIImage</span> <span class="o">*</span><span class="n">tintedImage</span> <span class="o">=</span> <span class="n">UIGraphicsGetImageFromCurrentImageContext</span><span class="p">();</span>
</span><span class='line'>    <span class="n">UIGraphicsEndImageContext</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="n">tintedImage</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">@end</span>
</span></code></pre></td></tr></table></div></figure>


<h2>正五边形</h2>

<p>绘制正五边形步骤：</p>

<ol>
<li>初始化数据；</li>
<li>计算各个顶点坐标，18° + 54° = 72°，通过三角函数计算；</li>
<li>使用UIBezierPath绘制五边形path，使用CAShapeLayer渲染五边形；</li>
</ol>


<p>注：可使用matrix优化缩放。</p>

<h2>返回手势</h2>

<ol>
<li>如果无leftBarButtonItem，点击返回及右滑返回均系统支持；</li>
<li>如果有leftBarButtonItem，点击返回逻辑需自己添加，右滑返回默认不支持。如果想支持右滑返回，需要设置<code>navigationController.interactivePopGestureRecognizer.delegate</code>，并实现<code>-gestureRecognizerShouldBegin</code>代理方法。注意右滑时需要判断当前栈中是否有足够的viewController以供pop。</li>
</ol>


<h2>View与View的参数分离</h2>

<p>自定义view时，将参数与view本身分离，并用常量定义参数，节省代码量，且易于统一修改处理。</p>

<h2>UIWebView</h2>

<p>如果webView加载的内容被卡住，<code>[self.webView canGoBack]</code>不能立即返回，如果使用该方法判断是否可以pop页面，可能会造成卡顿。<p class='post-footer'>
  原始地址：
  <a href='http://sxgfxm.github.io/blog/2017/09/22/ioszhi-shi-xiao-ji-170918/'><a href="http://sxgfxm.github.io/blog/2017/09/22/ioszhi-shi-xiao-ji-170918/">http://sxgfxm.github.io/blog/2017/09/22/ioszhi-shi-xiao-ji-170918/</a></a><br/>
  written by <a href='http://sxgfxm.github.io'>Light</a>
  &nbsp;posted at <a href='http://sxgfxm.github.io'><a href="http://sxgfxm.github.io">http://sxgfxm.github.io</a></a>
  </p></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[iOS知识小集-170911]]></title>
    <link href="http://sxgfxm.github.io/blog/2017/09/15/ioszhi-shi-xiao-ji-170911/"/>
    <updated>2017-09-15T17:20:49+08:00</updated>
    <id>http://sxgfxm.github.io/blog/2017/09/15/ioszhi-shi-xiao-ji-170911</id>
    <content type="html"><![CDATA[<h2>长按语音控制</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="o">-</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">setupBtn</span><span class="p">{</span>
</span><span class='line'>  <span class="c1">//  按下按钮</span>
</span><span class='line'>  <span class="p">[</span><span class="n">self</span><span class="p">.</span><span class="n">voiceBtn</span> <span class="nl">addTarget</span><span class="p">:</span><span class="n">self</span> <span class="nl">action</span><span class="p">:</span><span class="err">@</span><span class="n">selector</span><span class="p">(</span><span class="nl">btnTouchBegin</span><span class="p">:)</span> <span class="nl">forControlEvents</span><span class="p">:</span><span class="n">UIControlEventTouchDown</span><span class="p">];</span>
</span><span class='line'>  <span class="c1">//  立刻松开</span>
</span><span class='line'>  <span class="p">[</span><span class="n">self</span><span class="p">.</span><span class="n">voiceBtn</span> <span class="nl">addTarget</span><span class="p">:</span><span class="n">self</span> <span class="nl">action</span><span class="p">:</span><span class="err">@</span><span class="n">selector</span><span class="p">(</span><span class="nl">btnTouchEnd</span><span class="p">:)</span> <span class="nl">forControlEvents</span><span class="p">:</span><span class="n">UIControlEventTouchUpInside</span><span class="p">];</span>
</span><span class='line'>  <span class="c1">//  上划取消</span>
</span><span class='line'>  <span class="p">[</span><span class="n">self</span><span class="p">.</span><span class="n">voiceBtn</span> <span class="nl">addTarget</span><span class="p">:</span><span class="n">self</span> <span class="nl">action</span><span class="p">:</span><span class="err">@</span><span class="n">selector</span><span class="p">(</span><span class="n">cancelSpeak</span><span class="p">)</span> <span class="nl">forControlEvents</span><span class="p">:</span><span class="n">UIControlEventTouchDragExit</span><span class="p">];</span>
</span><span class='line'>  <span class="c1">//  外部松开</span>
</span><span class='line'>  <span class="p">[</span><span class="n">self</span><span class="p">.</span><span class="n">voiceBtn</span> <span class="nl">addTarget</span><span class="p">:</span><span class="n">self</span> <span class="nl">action</span><span class="p">:</span><span class="err">@</span><span class="n">selector</span><span class="p">(</span><span class="nl">btnTouchEnd</span><span class="p">:)</span> <span class="nl">forControlEvents</span><span class="p">:</span><span class="n">UIControlEventTouchUpOutside</span><span class="p">];</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//  通过计时器区分“点击”还是“长按”</span>
</span><span class='line'><span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nl">btnTouchBegin</span><span class="p">:(</span><span class="n">UIButton</span> <span class="o">*</span><span class="p">)</span><span class="n">button</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">self</span><span class="p">.</span><span class="n">countNum</span> <span class="o">=</span> <span class="mf">0.0f</span><span class="p">;</span>
</span><span class='line'>  <span class="n">self</span><span class="p">.</span><span class="n">timer</span> <span class="o">=</span>
</span><span class='line'>      <span class="p">[</span><span class="n">NSTimer</span> <span class="nl">scheduledTimerWithTimeInterval</span><span class="p">:</span><span class="mf">0.1</span> <span class="nl">target</span><span class="p">:</span><span class="n">self</span> <span class="nl">selector</span><span class="p">:</span><span class="err">@</span><span class="n">selector</span><span class="p">(</span><span class="n">handleTimer</span><span class="p">)</span> <span class="nl">userInfo</span><span class="p">:</span><span class="n">nil</span> <span class="nl">repeats</span><span class="p">:</span><span class="n">YES</span><span class="p">];</span>
</span><span class='line'>  <span class="p">[</span><span class="n">self</span><span class="p">.</span><span class="n">timer</span> <span class="n">fire</span><span class="p">];</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nl">btnTouchEnd</span><span class="p">:(</span><span class="n">UIButton</span> <span class="o">*</span><span class="p">)</span><span class="n">button</span> <span class="p">{</span>
</span><span class='line'>  <span class="p">[</span><span class="n">self</span><span class="p">.</span><span class="n">timer</span> <span class="n">invalidate</span><span class="p">];</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">if</span> <span class="p">([</span><span class="n">self</span> <span class="n">isLongPressGesture</span><span class="p">])</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1">//  执行长按操作</span>
</span><span class='line'>  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1">//  执行点击操作</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// 处理时间</span>
</span><span class='line'><span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">handleTimer</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">self</span><span class="p">.</span><span class="n">countNum</span> <span class="o">+=</span> <span class="mf">0.1</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">if</span> <span class="p">([</span><span class="n">self</span> <span class="n">isLongPressGesture</span><span class="p">])</span> <span class="p">{</span>
</span><span class='line'>    <span class="p">[</span><span class="n">self</span><span class="p">.</span><span class="n">timer</span> <span class="n">invalidate</span><span class="p">];</span>
</span><span class='line'>    <span class="p">[</span><span class="n">self</span> <span class="n">longPressVoiceBegin</span><span class="p">];</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// 判断是否为长按手势</span>
</span><span class='line'><span class="o">-</span> <span class="p">(</span><span class="n">BOOL</span><span class="p">)</span><span class="n">isLongPressGesture</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="n">countNum</span> <span class="o">&gt;=</span> <span class="mf">0.5</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// 上划取消语音输入</span>
</span><span class='line'><span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">cancelSpeak</span> <span class="p">{</span>
</span><span class='line'>  <span class="p">[</span><span class="n">self</span> <span class="n">voiceEnd</span><span class="p">];</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>




<!-- more -->


<h2>长按手势控制</h2>

<p>添加长按手势</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">addLongPressGesture</span><span class="p">{</span>
</span><span class='line'>  <span class="bp">UILongPressGestureRecognizer</span> <span class="o">*</span><span class="n">longPressGesture</span> <span class="o">=</span> <span class="p">[[</span><span class="bp">UILongPressGestureRecognizer</span> <span class="n">alloc</span><span class="p">]</span> <span class="nl">initWithTarget</span><span class="p">:</span><span class="nb">self</span> <span class="nl">action</span><span class="p">:</span><span class="k">@selector</span><span class="p">(</span><span class="nl">longPressGestureAction</span><span class="p">:)];</span>
</span><span class='line'>  <span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">voiceBtn</span> <span class="nl">addGestureRecognizer</span><span class="p">:</span><span class="n">longPressGesture</span><span class="p">];</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>处理长按手势</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">longPressGestureAction:</span><span class="p">(</span><span class="bp">UILongPressGestureRecognizer</span> <span class="o">*</span><span class="p">)</span><span class="nv">longPress</span> <span class="p">{</span>
</span><span class='line'>  <span class="bp">CGPoint</span> <span class="n">point</span> <span class="o">=</span> <span class="p">[</span><span class="n">longPress</span> <span class="nl">locationInView</span><span class="p">:</span><span class="nb">self</span><span class="p">.</span><span class="n">voiceBtn</span><span class="p">];</span>
</span><span class='line'>  <span class="k">switch</span> <span class="p">(</span><span class="n">longPress</span><span class="p">.</span><span class="n">state</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">case</span> <span class="nl">UIGestureRecognizerStateBegan</span><span class="p">:</span>
</span><span class='line'>      <span class="c1">//  长按手势开始</span>
</span><span class='line'>      <span class="k">break</span><span class="p">;</span>
</span><span class='line'>    <span class="k">case</span> <span class="nl">UIGestureRecognizerStateChanged</span><span class="p">:</span>
</span><span class='line'>      <span class="c1">//  长按滑动</span>
</span><span class='line'>      <span class="k">break</span><span class="p">;</span>
</span><span class='line'>    <span class="k">case</span> <span class="nl">UIGestureRecognizerStateEnded</span><span class="p">:</span>
</span><span class='line'>      <span class="c1">//  长按手势结束</span>
</span><span class='line'>      <span class="k">break</span><span class="p">;</span>
</span><span class='line'>    <span class="k">default</span><span class="o">:</span>
</span><span class='line'>      <span class="k">break</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//  判断触点是否在特定区域内</span>
</span><span class='line'><span class="p">-</span> <span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span><span class="nf">isInViewAreaWithTouchPoint:</span><span class="p">(</span><span class="bp">CGPoint</span><span class="p">)</span><span class="nv">touchPoint</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">return</span> <span class="n">touchPoint</span><span class="p">.</span><span class="n">y</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>




<p class='post-footer'>
  原始地址：
  <a href='http://sxgfxm.github.io/blog/2017/09/15/ioszhi-shi-xiao-ji-170911/'>http://sxgfxm.github.io/blog/2017/09/15/ioszhi-shi-xiao-ji-170911/</a><br/>
  written by <a href='http://sxgfxm.github.io'>Light</a>
  &nbsp;posted at <a href='http://sxgfxm.github.io'>http://sxgfxm.github.io</a>
  </p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[iOS知识小集-170904]]></title>
    <link href="http://sxgfxm.github.io/blog/2017/09/15/ioszhi-shi-xiao-ji-170904/"/>
    <updated>2017-09-15T17:19:17+08:00</updated>
    <id>http://sxgfxm.github.io/blog/2017/09/15/ioszhi-shi-xiao-ji-170904</id>
    <content type="html"><![CDATA[<h2>Git Delete Branch</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="n">git</span> <span class="n">branch</span> <span class="o">-</span><span class="n">a</span>
</span><span class='line'><span class="n">git</span> <span class="n">branch</span> <span class="o">-</span><span class="n">d</span> <span class="o">&lt;</span><span class="n">branch_name</span><span class="o">&gt;</span>
</span><span class='line'><span class="n">git</span> <span class="n">branch</span> <span class="o">-</span><span class="n">D</span> <span class="o">&lt;</span><span class="n">branch_name</span><span class="o">&gt;</span> <span class="c1">// force delete</span>
</span></code></pre></td></tr></table></div></figure>




<!-- more -->


<h2>MVC</h2>

<h2>&lt;> &amp; &ldquo;&rdquo;<p class='post-footer'></h2>

<p>  原始地址：
  <a href='http://sxgfxm.github.io/blog/2017/09/15/ioszhi-shi-xiao-ji-170904/'><a href="http://sxgfxm.github.io/blog/2017/09/15/ioszhi-shi-xiao-ji-170904/">http://sxgfxm.github.io/blog/2017/09/15/ioszhi-shi-xiao-ji-170904/</a></a><br/>
  written by <a href='http://sxgfxm.github.io'>Light</a>
  &nbsp;posted at <a href='http://sxgfxm.github.io'><a href="http://sxgfxm.github.io">http://sxgfxm.github.io</a></a>
  </p></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[iOS知识小集-170828]]></title>
    <link href="http://sxgfxm.github.io/blog/2017/09/04/ioszhi-shi-xiao-ji-170828/"/>
    <updated>2017-09-04T14:12:44+08:00</updated>
    <id>http://sxgfxm.github.io/blog/2017/09/04/ioszhi-shi-xiao-ji-170828</id>
    <content type="html"><![CDATA[<h2>TableView Header / Footer Height</h2>

<p>UITableView默认有section header/footer高度，设为0无效，最小可设为1。</p>

<h2>CNContactPickerViewController</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">pickContact</span><span class="p">{</span>
</span><span class='line'>  <span class="n">CNContactPickerViewController</span> <span class="o">*</span><span class="n">controller</span> <span class="o">=</span> <span class="p">[[</span><span class="n">CNContactPickerViewController</span> <span class="n">alloc</span><span class="p">]</span> <span class="n">init</span><span class="p">];</span>
</span><span class='line'>  <span class="n">controller</span><span class="p">.</span><span class="n">delegate</span> <span class="o">=</span> <span class="nb">self</span><span class="p">;</span>
</span><span class='line'>  <span class="p">[</span><span class="nb">self</span> <span class="nl">presentViewController</span><span class="p">:</span><span class="n">controller</span> <span class="nl">animated</span><span class="p">:</span><span class="nb">YES</span> <span class="nl">completion</span><span class="p">:</span><span class="nb">nil</span><span class="p">];</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">contactPicker:</span><span class="p">(</span><span class="n">CNContactPickerViewController</span> <span class="o">*</span><span class="p">)</span><span class="nv">picker</span>
</span><span class='line'>    <span class="nf">didSelectContactProperty:</span><span class="p">(</span><span class="n">CNContactProperty</span> <span class="o">*</span><span class="p">)</span><span class="nv">contactProperty</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">CNContact</span> <span class="o">*</span><span class="n">contact</span> <span class="o">=</span> <span class="n">contactProperty</span><span class="p">.</span><span class="n">contact</span><span class="p">;</span>
</span><span class='line'>  <span class="bp">NSString</span> <span class="o">*</span><span class="n">name</span> <span class="o">=</span> <span class="p">[</span><span class="n">CNContactFormatter</span> <span class="nl">stringFromContact</span><span class="p">:</span><span class="n">contact</span> <span class="nl">style</span><span class="p">:</span><span class="n">CNContactFormatterStyleFullName</span><span class="p">];</span>
</span><span class='line'>  <span class="n">CNPhoneNumber</span> <span class="o">*</span><span class="n">phoneValue</span> <span class="o">=</span> <span class="n">contactProperty</span><span class="p">.</span><span class="n">value</span><span class="p">;</span>
</span><span class='line'>  <span class="bp">NSString</span> <span class="o">*</span><span class="n">phoneNumber</span> <span class="o">=</span> <span class="n">phoneValue</span><span class="p">.</span><span class="n">stringValue</span><span class="p">;</span>
</span><span class='line'>  <span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;%@--%@&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">phoneNumber</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>




<!-- more -->


<h2>CNContactStore</h2>

<p>info.plist添加<code>Privacy - Contacts Usage Description</code>。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">checkAuthorization</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;Contact - Check Authorization&quot;</span><span class="p">);</span>
</span><span class='line'>  <span class="c1">//  status</span>
</span><span class='line'>  <span class="n">CNAuthorizationStatus</span> <span class="n">status</span> <span class="o">=</span>
</span><span class='line'>      <span class="p">[</span><span class="n">CNContactStore</span> <span class="nl">authorizationStatusForEntityType</span><span class="p">:</span><span class="n">CNEntityTypeContacts</span><span class="p">];</span>
</span><span class='line'>  <span class="c1">//  check authorization</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="n">status</span> <span class="o">!=</span> <span class="n">CNAuthorizationStatusAuthorized</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;Contact - Not Authorized&quot;</span><span class="p">);</span>
</span><span class='line'>    <span class="c1">//  request access</span>
</span><span class='line'>    <span class="n">CNContactStore</span> <span class="o">*</span><span class="n">store</span> <span class="o">=</span> <span class="p">[</span><span class="n">CNContactStore</span> <span class="n">new</span><span class="p">];</span>
</span><span class='line'>    <span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;Contact - Request Authorization&quot;</span><span class="p">);</span>
</span><span class='line'>    <span class="p">[</span><span class="n">store</span>
</span><span class='line'>        <span class="nl">requestAccessForEntityType</span><span class="p">:</span><span class="n">CNEntityTypeContacts</span>
</span><span class='line'>                 <span class="nl">completionHandler</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="kt">BOOL</span> <span class="n">granted</span><span class="p">,</span> <span class="bp">NSError</span> <span class="o">*</span><span class="n">_Nullable</span> <span class="n">error</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                   <span class="k">if</span> <span class="p">(</span><span class="n">granted</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                     <span class="c1">//  YES</span>
</span><span class='line'>                     <span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;Contact - Authorized&quot;</span><span class="p">);</span>
</span><span class='line'>                     <span class="p">[</span><span class="nb">self</span> <span class="n">fetchContact</span><span class="p">];</span>
</span><span class='line'>                   <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>                     <span class="c1">//  No</span>
</span><span class='line'>                     <span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;Contact - Not Authorized&quot;</span><span class="p">);</span>
</span><span class='line'>                   <span class="p">}</span>
</span><span class='line'>                 <span class="p">}];</span>
</span><span class='line'>  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;Contact - Authorized&quot;</span><span class="p">);</span>
</span><span class='line'>    <span class="p">[</span><span class="nb">self</span> <span class="n">fetchContact</span><span class="p">];</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">fetchContact</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;Contact - Fetch Contact&quot;</span><span class="p">);</span>
</span><span class='line'>  <span class="c1">//  keys</span>
</span><span class='line'>  <span class="bp">NSArray</span> <span class="o">*</span><span class="n">keys</span> <span class="o">=</span> <span class="l">@[</span>
</span><span class='line'>    <span class="n">CNContactPhoneNumbersKey</span><span class="p">,</span>
</span><span class='line'>    <span class="n">CNContactGivenNameKey</span><span class="p">,</span>
</span><span class='line'>    <span class="n">CNContactFamilyNameKey</span>
</span><span class='line'>  <span class="l">]</span><span class="p">;</span>
</span><span class='line'>  <span class="c1">//  request</span>
</span><span class='line'>  <span class="n">CNContactFetchRequest</span> <span class="o">*</span><span class="n">request</span> <span class="o">=</span>
</span><span class='line'>      <span class="p">[[</span><span class="n">CNContactFetchRequest</span> <span class="n">alloc</span><span class="p">]</span> <span class="nl">initWithKeysToFetch</span><span class="p">:</span><span class="n">keys</span><span class="p">];</span>
</span><span class='line'>  <span class="c1">//  store</span>
</span><span class='line'>  <span class="bp">NSError</span> <span class="o">*</span><span class="n">error</span> <span class="o">=</span> <span class="nb">nil</span><span class="p">;</span>
</span><span class='line'>  <span class="n">CNContactStore</span> <span class="o">*</span><span class="n">store</span> <span class="o">=</span> <span class="p">[</span><span class="n">CNContactStore</span> <span class="n">new</span><span class="p">];</span>
</span><span class='line'>  <span class="p">[</span><span class="n">store</span>
</span><span class='line'>      <span class="nl">enumerateContactsWithFetchRequest</span><span class="p">:</span><span class="n">request</span>
</span><span class='line'>                                  <span class="nl">error</span><span class="p">:</span><span class="o">&amp;</span><span class="n">error</span>
</span><span class='line'>                             <span class="nl">usingBlock</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">CNContact</span> <span class="o">*</span><span class="n">_Nonnull</span> <span class="n">contact</span><span class="p">,</span>
</span><span class='line'>                                          <span class="kt">BOOL</span> <span class="o">*</span><span class="n">_Nonnull</span> <span class="n">stop</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                               <span class="c1">//  contact</span>
</span><span class='line'>                               <span class="bp">NSString</span> <span class="o">*</span><span class="n">firstName</span> <span class="o">=</span> <span class="n">contact</span><span class="p">.</span><span class="n">familyName</span><span class="p">;</span>
</span><span class='line'>                               <span class="bp">NSString</span> <span class="o">*</span><span class="n">lastName</span> <span class="o">=</span> <span class="n">contact</span><span class="p">.</span><span class="n">givenName</span><span class="p">;</span>
</span><span class='line'>                               <span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;%@ %@&quot;</span><span class="p">,</span> <span class="n">firstName</span><span class="p">,</span> <span class="n">lastName</span><span class="p">);</span>
</span><span class='line'>                               <span class="c1">//  phone number</span>
</span><span class='line'>                               <span class="k">for</span> <span class="p">(</span><span class="n">CNLabeledValue</span> <span class="o">*</span><span class="n">labeledValue</span> <span class="k">in</span> <span class="n">contact</span>
</span><span class='line'>                                        <span class="p">.</span><span class="n">phoneNumbers</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                                 <span class="n">CNPhoneNumber</span> <span class="o">*</span><span class="n">phoneValue</span> <span class="o">=</span> <span class="n">labeledValue</span><span class="p">.</span><span class="n">value</span><span class="p">;</span>
</span><span class='line'>                                 <span class="bp">NSString</span> <span class="o">*</span><span class="n">phoneNumber</span> <span class="o">=</span> <span class="n">phoneValue</span><span class="p">.</span><span class="n">stringValue</span><span class="p">;</span>
</span><span class='line'>                                 <span class="bp">NSString</span> <span class="o">*</span><span class="n">label</span> <span class="o">=</span> <span class="p">[</span><span class="n">CNLabeledValue</span>
</span><span class='line'>                                     <span class="nl">localizedStringForLabel</span><span class="p">:</span><span class="n">labeledValue</span>
</span><span class='line'>                                                                 <span class="p">.</span><span class="n">label</span><span class="p">];</span>
</span><span class='line'>                                 <span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;%@ : %@&quot;</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">phoneNumber</span><span class="p">);</span>
</span><span class='line'>                               <span class="p">}</span>
</span><span class='line'>                               <span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;&quot;</span><span class="p">);</span>
</span><span class='line'>                             <span class="p">}];</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>iOS本地化</h2>

<ol>
<li>Project -> Localizations -> Add Chinese</li>
<li>New File -> Strings File</li>
<li>Strings File -> Utities -> Localization -> Add Chinese</li>
<li>Add Localized String</li>
</ol>


<h2>灯效说明</h2>

<p>继承</p>

<h2>智能家居控制</h2>

<p>分解<p class='post-footer'>
  原始地址：
  <a href='http://sxgfxm.github.io/blog/2017/09/04/ioszhi-shi-xiao-ji-170828/'><a href="http://sxgfxm.github.io/blog/2017/09/04/ioszhi-shi-xiao-ji-170828/">http://sxgfxm.github.io/blog/2017/09/04/ioszhi-shi-xiao-ji-170828/</a></a><br/>
  written by <a href='http://sxgfxm.github.io'>Light</a>
  &nbsp;posted at <a href='http://sxgfxm.github.io'><a href="http://sxgfxm.github.io">http://sxgfxm.github.io</a></a>
  </p></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[iOS知识小集-170821]]></title>
    <link href="http://sxgfxm.github.io/blog/2017/08/28/ioszhi-shi-xiao-ji-170821/"/>
    <updated>2017-08-28T11:39:03+08:00</updated>
    <id>http://sxgfxm.github.io/blog/2017/08/28/ioszhi-shi-xiao-ji-170821</id>
    <content type="html"><![CDATA[<h2>ipa架构</h2>

<pre><code>IPA File
  Payload
    {appname}.app
      Application Binary
      Mobile Provision File
      Code Signature
      Bundled Resource File
  iTunesArtwork
  iTunesMetadata.plist
</code></pre>

<!-- more -->


<h2>Insecure Local Data Storage</h2>

<ol>
<li>PropertyList files</li>
<li>NSUserDefaults class</li>
<li>KeyChain</li>
<li>CoreData and SQLite databases</li>
</ol>


<h2>Apple Data Protection API</h2>

<ol>
<li>Complete Protection (NSFileProtectionComplete)</li>
<li>Protected Unless Open (NSFileProtectionCompleteUnlessOpen)</li>
<li>Protected Until First User Authentication (NSFileProtectionCompleteUntilFirstUserAuthentication)</li>
<li>No Protection (NSFileProtectionNone)</li>
</ol>


<h2>NSTimeZone</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="bp">NSTimeZone</span> <span class="o">*</span><span class="n">timeZone</span> <span class="o">=</span> <span class="p">[</span><span class="bp">NSTimeZone</span> <span class="n">localTimeZone</span><span class="p">];</span>
</span><span class='line'><span class="c1">//  Asia/Shanghai</span>
</span><span class='line'><span class="bp">NSString</span> <span class="o">*</span><span class="n">name</span> <span class="o">=</span> <span class="n">timeZone</span><span class="p">.</span><span class="n">name</span><span class="p">;</span>
</span><span class='line'><span class="c1">//  GMT+8</span>
</span><span class='line'><span class="bp">NSString</span> <span class="o">*</span><span class="n">abbreviation</span> <span class="o">=</span> <span class="n">timeZone</span><span class="p">.</span><span class="n">abbreviation</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Prevent Buffer Overflows</h2>

<ol>
<li>Address Space Layout Randomization (ASLR)</li>
<li>Automatic Reference Counting (ARC)</li>
<li>Stack Protectors</li>
</ol>


<h2>System Call</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">makeCall:</span><span class="p">(</span><span class="bp">NSString</span> <span class="o">*</span><span class="p">)</span><span class="nv">phone</span><span class="p">{</span>
</span><span class='line'>  <span class="bp">NSString</span> <span class="o">*</span><span class="n">phoneNumber</span> <span class="o">=</span> <span class="p">[</span><span class="s">@&quot;telprompt://&quot;</span> <span class="nl">stringByAppendingString</span><span class="p">:</span><span class="n">phone</span><span class="p">];</span>
</span><span class='line'>  <span class="p">[[</span><span class="bp">UIApplication</span> <span class="n">sharedApplication</span><span class="p">]</span> <span class="nl">openURL</span><span class="p">:[</span><span class="bp">NSURL</span> <span class="nl">URLWithString</span><span class="p">:</span><span class="n">phoneNumber</span><span class="p">]];</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>NSString to NSURL</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="bp">NSString</span> <span class="o">*</span><span class="n">encodeURL</span> <span class="o">=</span> <span class="p">[</span><span class="n">string</span> <span class="nl">stringByAddingPercentEncodingWithAllowedCharacters</span><span class="p">:[</span><span class="bp">NSCharacterSet</span> <span class="n">URLQueryAllowedCharacterSet</span><span class="p">]];</span>
</span><span class='line'><span class="bp">NSURL</span> <span class="o">*</span><span class="n">url</span> <span class="o">=</span> <span class="p">[</span><span class="bp">NSURL</span> <span class="nl">URLWithString</span><span class="p">:</span><span class="n">encodeURL</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure>




<p class='post-footer'>
  原始地址：
  <a href='http://sxgfxm.github.io/blog/2017/08/28/ioszhi-shi-xiao-ji-170821/'>http://sxgfxm.github.io/blog/2017/08/28/ioszhi-shi-xiao-ji-170821/</a><br/>
  written by <a href='http://sxgfxm.github.io'>Light</a>
  &nbsp;posted at <a href='http://sxgfxm.github.io'>http://sxgfxm.github.io</a>
  </p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[iOS知识小集-170814]]></title>
    <link href="http://sxgfxm.github.io/blog/2017/08/22/iosxiao-ji-170814/"/>
    <updated>2017-08-22T10:13:36+08:00</updated>
    <id>http://sxgfxm.github.io/blog/2017/08/22/iosxiao-ji-170814</id>
    <content type="html"><![CDATA[<h2>使用Xcode查看代码作者和提交信息</h2>

<p>切换为“Blame”和“Log”模式即可。</p>

<h2>AVAudioSession</h2>

<p>AVAudioSessionCategoryOptionDefaultToSpeaker：通过扬声器播放声音。<br/>
AVAudioSessionCategoryOptionMixWithOthers：不打断其他App音频播放。</p>

<h2>JSONModel</h2>

<p>下划线key转驼峰key。
<code>[JSONKeyMapper mapperFromUnderscoreCaseToCamelCase]</code>已废弃，
现在使用<code>[JSONKeyMapper mapperForSnakeCase]</code>。</p>

<h2>Acoustic Echo Cancellation</h2>

<p>Audio Unit回声消除。<p class='post-footer'>
  原始地址：
  <a href='http://sxgfxm.github.io/blog/2017/08/22/iosxiao-ji-170814/'><a href="http://sxgfxm.github.io/blog/2017/08/22/iosxiao-ji-170814/">http://sxgfxm.github.io/blog/2017/08/22/iosxiao-ji-170814/</a></a><br/>
  written by <a href='http://sxgfxm.github.io'>Light</a>
  &nbsp;posted at <a href='http://sxgfxm.github.io'><a href="http://sxgfxm.github.io">http://sxgfxm.github.io</a></a>
  </p></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[iOS知识小集-170807]]></title>
    <link href="http://sxgfxm.github.io/blog/2017/08/22/ioszhi-shi-xiao-ji-170807/"/>
    <updated>2017-08-22T10:12:54+08:00</updated>
    <id>http://sxgfxm.github.io/blog/2017/08/22/ioszhi-shi-xiao-ji-170807</id>
    <content type="html"><![CDATA[<p class='post-footer'>
  原始地址：
  <a href='http://sxgfxm.github.io/blog/2017/08/22/ioszhi-shi-xiao-ji-170807/'>http://sxgfxm.github.io/blog/2017/08/22/ioszhi-shi-xiao-ji-170807/</a><br/>
  written by <a href='http://sxgfxm.github.io'>Light</a>
  &nbsp;posted at <a href='http://sxgfxm.github.io'>http://sxgfxm.github.io</a>
  </p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[iOS知识小集-170731]]></title>
    <link href="http://sxgfxm.github.io/blog/2017/08/07/ioszhi-shi-xiao-ji-170731/"/>
    <updated>2017-08-07T10:03:41+08:00</updated>
    <id>http://sxgfxm.github.io/blog/2017/08/07/ioszhi-shi-xiao-ji-170731</id>
    <content type="html"><![CDATA[<h2>UIImage Tint Color</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="p">[</span><span class="n">cell</span><span class="p">.</span><span class="n">icon</span> <span class="nl">sd_setImageWithURL</span><span class="p">:[</span><span class="bp">NSURL</span> <span class="nl">URLWithString</span><span class="p">:</span><span class="n">myURL</span><span class="p">]</span> <span class="nl">placeholderImage</span><span class="p">:[</span><span class="bp">UIImage</span> <span class="nl">imageNamed</span><span class="p">:</span><span class="n">imageName</span><span class="p">]</span> <span class="nl">options</span><span class="p">:</span><span class="n">SDWebImageRefreshCached</span> <span class="nl">completed</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="bp">UIImage</span> <span class="o">*</span><span class="n">image</span><span class="p">,</span> <span class="bp">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">,</span> <span class="n">SDImageCacheType</span> <span class="n">cacheType</span><span class="p">,</span> <span class="bp">NSURL</span> <span class="o">*</span><span class="n">imageURL</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">cell</span><span class="p">.</span><span class="n">icon</span><span class="p">.</span><span class="n">image</span> <span class="o">=</span> <span class="p">[</span><span class="n">image</span> <span class="nl">imageWithRenderingMode</span><span class="p">:</span><span class="n">UIImageRenderingModeAlwaysTemplate</span><span class="p">];</span>
</span><span class='line'><span class="p">}];</span>
</span></code></pre></td></tr></table></div></figure>


<h2>调整屏幕亮度</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="p">[[</span><span class="bp">UIScreen</span> <span class="n">mainScreen</span><span class="p">]</span> <span class="nl">setBrightness</span><span class="p">:</span><span class="mf">0.5</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure>


<h2>保持屏幕常亮</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="p">[</span><span class="bp">UIApplication</span> <span class="n">sharedApplication</span><span class="p">].</span><span class="n">idleTimerDisabled</span> <span class="o">=</span> <span class="nb">YES</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>




<!-- more -->


<h2>cell.contentView VS cell</h2>

<p>If you want to customize cells by simply adding additional views, you should add them to the content view so they will be positioned appropriately as the cell transitions into and out of editing mode.</p>

<h2>NSURLSession</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="bp">NSURLSessionConfiguration</span> <span class="o">*</span><span class="n">config</span> <span class="o">=</span> <span class="p">[</span><span class="bp">NSURLSessionConfiguration</span> <span class="n">defaultSessionConfiguration</span><span class="p">];</span>
</span><span class='line'><span class="bp">NSURLSession</span> <span class="o">*</span><span class="n">session</span> <span class="o">=</span>
</span><span class='line'>      <span class="p">[</span><span class="bp">NSURLSession</span> <span class="nl">sessionWithConfiguration</span><span class="p">:</span><span class="n">config</span> <span class="nl">delegate</span><span class="p">:</span><span class="nb">self</span> <span class="nl">delegateQueue</span><span class="p">:[</span><span class="bp">NSOperationQueue</span> <span class="n">mainQueue</span><span class="p">]];</span>
</span><span class='line'><span class="p">[</span><span class="n">session</span> <span class="nl">dataTaskWithRequest</span><span class="p">:</span><span class="n">request</span><span class="p">];</span>
</span><span class='line'>
</span><span class='line'><span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">URLSession:</span><span class="p">(</span><span class="bp">NSURLSession</span> <span class="o">*</span><span class="p">)</span><span class="nv">session</span>
</span><span class='line'>                          <span class="nf">task:</span><span class="p">(</span><span class="bp">NSURLSessionTask</span> <span class="o">*</span><span class="p">)</span><span class="nv">task</span>
</span><span class='line'>    <span class="nf">willPerformHTTPRedirection:</span><span class="p">(</span><span class="bp">NSHTTPURLResponse</span> <span class="o">*</span><span class="p">)</span><span class="nv">response</span>
</span><span class='line'>                    <span class="nf">newRequest:</span><span class="p">(</span><span class="bp">NSURLRequest</span> <span class="o">*</span><span class="p">)</span><span class="nv">request</span>
</span><span class='line'>             <span class="nf">completionHandler:</span><span class="p">(</span><span class="kt">void</span> <span class="p">(</span><span class="o">^</span><span class="p">)(</span><span class="bp">NSURLRequest</span> <span class="o">*</span><span class="n">_Nullable</span><span class="p">))</span><span class="nv">completionHandler</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;urlsession request %@&quot;</span><span class="p">,</span> <span class="n">request</span><span class="p">.</span><span class="n">URL</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>后台运行</h2>

<p>Target -> Capabilities -> Background Modes -> Audio；<br/>
在info.plist中 添加<code>Required background modes</code> = <code>App plays audio or streams audio/video using AirPlay</code>。<br/>
如果启用后台录音，会有红色显示条。</p>

<h2>应用进入前台或后台通知</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="c1">// app启动或者app从后台进入前台都会调用这个方法</span>
</span><span class='line'><span class="p">[[</span><span class="bp">NSNotificationCenter</span> <span class="n">defaultCenter</span><span class="p">]</span> <span class="nl">addObserver</span><span class="p">:</span><span class="nb">self</span> <span class="nl">selector</span><span class="p">:</span><span class="k">@selector</span><span class="p">(</span><span class="n">applicationBecomeActive</span><span class="p">)</span> <span class="nl">name</span><span class="p">:</span><span class="n">UIApplicationDidBecomeActiveNotification</span> <span class="nl">object</span><span class="p">:</span><span class="nb">nil</span><span class="p">];</span>
</span><span class='line'><span class="c1">// app从后台进入前台都会调用这个方法</span>
</span><span class='line'><span class="p">[[</span><span class="bp">NSNotificationCenter</span> <span class="n">defaultCenter</span><span class="p">]</span> <span class="nl">addObserver</span><span class="p">:</span><span class="nb">self</span> <span class="nl">selector</span><span class="p">:</span><span class="k">@selector</span><span class="p">(</span><span class="n">applicationBecomeActive</span><span class="p">)</span> <span class="nl">name</span><span class="p">:</span><span class="n">UIApplicationWillEnterForegroundNotification</span> <span class="nl">object</span><span class="p">:</span><span class="nb">nil</span><span class="p">];</span>
</span><span class='line'><span class="c1">// 添加检测app进入后台的观察者</span>
</span><span class='line'><span class="p">[[</span><span class="bp">NSNotificationCenter</span> <span class="n">defaultCenter</span><span class="p">]</span> <span class="nl">addObserver</span><span class="p">:</span><span class="nb">self</span> <span class="nl">selector</span><span class="p">:</span><span class="k">@selector</span><span class="p">(</span><span class="n">applicationEnterBackground</span><span class="p">)</span> <span class="nl">name</span><span class="p">:</span> <span class="n">UIApplicationDidEnterBackgroundNotification</span> <span class="nl">object</span><span class="p">:</span><span class="nb">nil</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Logging Malloc Stack</h2>

<p>如果不关闭，会导致大量无法自动清除的系统log，占用巨大磁盘空间。  <p class='post-footer'>
  原始地址：
  <a href='http://sxgfxm.github.io/blog/2017/08/07/ioszhi-shi-xiao-ji-170731/'><a href="http://sxgfxm.github.io/blog/2017/08/07/ioszhi-shi-xiao-ji-170731/">http://sxgfxm.github.io/blog/2017/08/07/ioszhi-shi-xiao-ji-170731/</a></a><br/>
  written by <a href='http://sxgfxm.github.io'>Light</a>
  &nbsp;posted at <a href='http://sxgfxm.github.io'><a href="http://sxgfxm.github.io">http://sxgfxm.github.io</a></a>
  </p></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[iOS知识小集-170724]]></title>
    <link href="http://sxgfxm.github.io/blog/2017/07/31/ioszhi-shi-xiao-ji-170724/"/>
    <updated>2017-07-31T10:17:32+08:00</updated>
    <id>http://sxgfxm.github.io/blog/2017/07/31/ioszhi-shi-xiao-ji-170724</id>
    <content type="html"><![CDATA[<h2>JavaScriptCore</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">webView</span> <span class="nl">stringByEvaluatingJavaScriptFromString</span><span class="p">:</span><span class="s">@&quot;document.getElementsByTagName(&#39;audio&#39;)[0].play()&quot;</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure>




<!-- more -->


<h2>调整button点击区域</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="nb">self</span><span class="p">.</span><span class="n">playBtn</span><span class="p">.</span><span class="n">contentMode</span> <span class="o">=</span> <span class="n">UIViewContentModeScaleAspectFit</span><span class="p">;</span>
</span><span class='line'><span class="nb">self</span><span class="p">.</span><span class="n">closeBtn</span><span class="p">.</span><span class="n">contentMode</span> <span class="o">=</span> <span class="n">UIViewContentModeScaleAspectFit</span><span class="p">;</span>
</span><span class='line'><span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">playBtn</span> <span class="nl">setImageEdgeInsets</span><span class="p">:</span><span class="n">UIEdgeInsetsMake</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)];</span>
</span><span class='line'><span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">closeBtn</span> <span class="nl">setImageEdgeInsets</span><span class="p">:</span><span class="n">UIEdgeInsetsMake</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)];</span>
</span></code></pre></td></tr></table></div></figure>


<h2>判断网络状态</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="p">-</span> <span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span><span class="nf">connected</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">NetworkStatus</span> <span class="n">internetStatus</span> <span class="o">=</span> <span class="p">[[</span><span class="n">Reachability</span> <span class="n">reachabilityForInternetConnection</span><span class="p">]</span> <span class="n">currentReachabilityStatus</span><span class="p">];</span>
</span><span class='line'>  <span class="k">return</span> <span class="n">internetStatus</span> <span class="o">!=</span> <span class="n">NotReachable</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>




<p class='post-footer'>
  原始地址：
  <a href='http://sxgfxm.github.io/blog/2017/07/31/ioszhi-shi-xiao-ji-170724/'>http://sxgfxm.github.io/blog/2017/07/31/ioszhi-shi-xiao-ji-170724/</a><br/>
  written by <a href='http://sxgfxm.github.io'>Light</a>
  &nbsp;posted at <a href='http://sxgfxm.github.io'>http://sxgfxm.github.io</a>
  </p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[iOS知识小集-170717]]></title>
    <link href="http://sxgfxm.github.io/blog/2017/07/24/ioszhi-shi-xiao-ji-170717/"/>
    <updated>2017-07-24T09:36:53+08:00</updated>
    <id>http://sxgfxm.github.io/blog/2017/07/24/ioszhi-shi-xiao-ji-170717</id>
    <content type="html"><![CDATA[<h2>Set UITableViewHeaderFooterView backgroundColor transparent</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="nb">self</span><span class="p">.</span><span class="n">backgroundView</span> <span class="o">=</span> <span class="p">[[</span><span class="bp">UIImageView</span> <span class="n">alloc</span><span class="p">]</span> <span class="nl">initWithImage</span><span class="p">:[</span><span class="bp">UIImage</span> <span class="n">new</span><span class="p">]];</span>
</span></code></pre></td></tr></table></div></figure>




<p class='post-footer'>
  原始地址：
  <a href='http://sxgfxm.github.io/blog/2017/07/24/ioszhi-shi-xiao-ji-170717/'>http://sxgfxm.github.io/blog/2017/07/24/ioszhi-shi-xiao-ji-170717/</a><br/>
  written by <a href='http://sxgfxm.github.io'>Light</a>
  &nbsp;posted at <a href='http://sxgfxm.github.io'>http://sxgfxm.github.io</a>
  </p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[iOS知识小集-170710]]></title>
    <link href="http://sxgfxm.github.io/blog/2017/07/15/ioszhi-shi-xiao-ji-170710/"/>
    <updated>2017-07-15T15:08:46+08:00</updated>
    <id>http://sxgfxm.github.io/blog/2017/07/15/ioszhi-shi-xiao-ji-170710</id>
    <content type="html"><![CDATA[<h2><a href="https://github.com/airbnb/lottie-ios">Lottie</a></h2>

<p>Lottie is a mobile library for Android and iOS that parses Adobe After Effects animations exported as json with bodymovin and renders the vector animations natively on mobile and through React Native!<br/>
Common Animations</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">LOTAnimationView</span> <span class="o">*</span><span class="n">animation</span> <span class="o">=</span> <span class="p">[</span><span class="n">LOTAnimationView</span> <span class="nl">animationNamed</span><span class="p">:</span><span class="s">@&quot;Lottie&quot;</span><span class="p">];</span>
</span><span class='line'><span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">view</span> <span class="nl">addSubview</span><span class="p">:</span><span class="n">animation</span><span class="p">];</span>
</span><span class='line'><span class="p">[</span><span class="n">animation</span> <span class="nl">playWithCompletion</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="kt">BOOL</span> <span class="n">animationFinished</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="c1">// Do Something</span>
</span><span class='line'><span class="p">}];</span>
</span></code></pre></td></tr></table></div></figure>




<!-- more -->


<p>UIViewController Transition</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="p">-</span> <span class="p">(</span><span class="kt">id</span><span class="o">&lt;</span><span class="bp">UIViewControllerAnimatedTransitioning</span><span class="o">&gt;</span><span class="p">)</span><span class="nf">animationControllerForPresentedController:</span><span class="p">(</span><span class="bp">UIViewController</span> <span class="o">*</span><span class="p">)</span><span class="nv">presented</span>
</span><span class='line'>                                                                  <span class="nf">presentingController:</span><span class="p">(</span><span class="bp">UIViewController</span> <span class="o">*</span><span class="p">)</span><span class="nv">presenting</span>
</span><span class='line'>                                                                      <span class="nf">sourceController:</span><span class="p">(</span><span class="bp">UIViewController</span> <span class="o">*</span><span class="p">)</span><span class="nv">source</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">LOTAnimationTransitionController</span> <span class="o">*</span><span class="n">animationController</span> <span class="o">=</span> <span class="p">[[</span><span class="n">LOTAnimationTransitionController</span> <span class="n">alloc</span><span class="p">]</span> <span class="nl">initWithAnimationNamed</span><span class="p">:</span><span class="s">@&quot;vcTransition1&quot;</span>
</span><span class='line'>                                                                                                          <span class="nl">fromLayerNamed</span><span class="p">:</span><span class="s">@&quot;outLayer&quot;</span>
</span><span class='line'>                                                                                                            <span class="nl">toLayerNamed</span><span class="p">:</span><span class="s">@&quot;inLayer&quot;</span><span class="p">];</span>
</span><span class='line'>  <span class="k">return</span> <span class="n">animationController</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="p">-</span> <span class="p">(</span><span class="kt">id</span><span class="o">&lt;</span><span class="bp">UIViewControllerAnimatedTransitioning</span><span class="o">&gt;</span><span class="p">)</span><span class="nf">animationControllerForDismissedController:</span><span class="p">(</span><span class="bp">UIViewController</span> <span class="o">*</span><span class="p">)</span><span class="nv">dismissed</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">LOTAnimationTransitionController</span> <span class="o">*</span><span class="n">animationController</span> <span class="o">=</span> <span class="p">[[</span><span class="n">LOTAnimationTransitionController</span> <span class="n">alloc</span><span class="p">]</span> <span class="nl">initWithAnimationNamed</span><span class="p">:</span><span class="s">@&quot;vcTransition2&quot;</span>
</span><span class='line'>                                                                                                          <span class="nl">fromLayerNamed</span><span class="p">:</span><span class="s">@&quot;outLayer&quot;</span>
</span><span class='line'>                                                                                                            <span class="nl">toLayerNamed</span><span class="p">:</span><span class="s">@&quot;inLayer&quot;</span><span class="p">];</span>
</span><span class='line'>  <span class="k">return</span> <span class="n">animationController</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>导航栏设为透明</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">navigationController</span><span class="p">.</span><span class="n">navigationBar</span> <span class="nl">setBackgroundImage</span><span class="p">:[</span><span class="bp">UIImage</span> <span class="n">new</span><span class="p">]</span> <span class="nl">forBarMetrics</span><span class="p">:</span><span class="n">UIBarMetricsDefault</span><span class="p">];</span>
</span><span class='line'><span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">navigationController</span><span class="p">.</span><span class="n">navigationBar</span> <span class="nl">setShadowImage</span><span class="p">:[</span><span class="bp">UIImage</span> <span class="n">new</span><span class="p">]];</span>
</span></code></pre></td></tr></table></div></figure>


<h2>导航栏还原</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">navigationController</span><span class="p">.</span><span class="n">navigationBar</span> <span class="nl">setBackgroundImage</span><span class="p">:</span><span class="nb">nil</span> <span class="nl">forBarMetrics</span><span class="p">:</span><span class="n">UIBarMetricsDefault</span><span class="p">];</span>
</span><span class='line'><span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">navigationController</span><span class="p">.</span><span class="n">navigationBar</span> <span class="nl">setShadowImage</span><span class="p">:</span><span class="nb">nil</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Change UITextField Placeholder Color</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'>  <span class="bp">NSString</span> <span class="o">*</span><span class="n">string</span> <span class="o">=</span> <span class="s">@&quot;请输入Wi-Fi名称&quot;</span><span class="p">;</span>
</span><span class='line'>  <span class="bp">NSMutableAttributedString</span> <span class="o">*</span><span class="n">attributedString</span> <span class="o">=</span> <span class="p">[[</span><span class="bp">NSMutableAttributedString</span> <span class="n">alloc</span><span class="p">]</span> <span class="nl">initWithString</span><span class="p">:</span><span class="n">string</span><span class="p">];</span>
</span><span class='line'>  <span class="p">[</span><span class="n">attributedString</span> <span class="nl">addAttribute</span><span class="p">:</span><span class="n">NSForegroundColorAttributeName</span> <span class="nl">value</span><span class="p">:[</span><span class="bp">UIColor</span> <span class="n">whiteColor</span><span class="p">]</span> <span class="nl">range</span><span class="p">:</span><span class="n">NSMakeRange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">string</span><span class="p">.</span><span class="n">length</span><span class="p">)];</span>
</span><span class='line'>  <span class="nb">self</span><span class="p">.</span><span class="n">wifiNameTF</span><span class="p">.</span><span class="n">attributedPlaceholder</span> <span class="o">=</span> <span class="n">attributedString</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<h2>KVO NSKeyValueObservingOptions</h2>

<p>NSKeyValueObservingOptionNew：获取新值<br/>
NSKeyValueObservingOptionOld：获取旧值<br/>
NSKeyValueObservingOptionInitial：获取初始值<br/>
NSKeyValueObservingOptionPrior：获取新旧值</p>

<h2>UITextField nil While Editing</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="p">-</span> <span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span><span class="nf">textField:</span><span class="p">(</span><span class="bp">UITextField</span><span class="o">*</span><span class="p">)</span><span class="nv">textField</span> <span class="nf">shouldChangeCharactersInRange:</span><span class="p">(</span><span class="n">NSRange</span><span class="p">)</span><span class="nv">range</span> <span class="nf">replacementString:</span><span class="p">(</span><span class="bp">NSString</span><span class="o">*</span><span class="p">)</span><span class="nv">string</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="n">range</span><span class="p">.</span><span class="n">location</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">string</span><span class="p">.</span><span class="n">length</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="c1">//textField is empty</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="k">return</span> <span class="nb">YES</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>UIKeyboardAppearance</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">textField</span><span class="p">.</span><span class="n">keyboardAppearance</span> <span class="o">=</span> <span class="n">UIKeyboardAppearanceDark</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<h2>UIView Transition Animation</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="p">[</span><span class="bp">UIView</span> <span class="nl">transitionFromView</span><span class="p">:</span><span class="n">view1</span>
</span><span class='line'>                   <span class="nl">toView</span><span class="p">:</span><span class="n">view2</span>
</span><span class='line'>                 <span class="nl">duration</span><span class="p">:</span><span class="mi">2</span>
</span><span class='line'>                  <span class="nl">options</span><span class="p">:</span><span class="n">animationTransitionType</span>
</span><span class='line'>               <span class="nl">completion</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="kt">BOOL</span> <span class="n">finished</span><span class="p">){</span>
</span><span class='line'>                            <span class="p">[</span><span class="n">view1</span> <span class="n">removeFromSuperview</span><span class="p">];</span>
</span><span class='line'>                          <span class="p">}];</span>
</span><span class='line'><span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">view</span> <span class="nl">addSubview</span><span class="p">:</span><span class="n">view2</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure>


<h2>UIView Fade In Fade Out</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="p">[</span><span class="n">view</span> <span class="nl">setAlpha</span><span class="p">:</span><span class="mf">0.f</span><span class="p">];</span>
</span><span class='line'><span class="p">[</span><span class="bp">UIView</span> <span class="nl">animateWithDuration</span><span class="p">:</span><span class="mf">2.f</span> <span class="nl">delay</span><span class="p">:</span><span class="mf">0.f</span> <span class="nl">options</span><span class="p">:</span><span class="n">UIViewAnimationOptionCurveEaseIn</span> <span class="nl">animations</span><span class="p">:</span><span class="o">^</span><span class="p">{</span>
</span><span class='line'>    <span class="c1">//  fade in</span>
</span><span class='line'>    <span class="p">[</span><span class="n">view</span> <span class="nl">setAlpha</span><span class="p">:</span><span class="mf">1.f</span><span class="p">];</span>
</span><span class='line'><span class="p">}</span> <span class="nl">completion</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="kt">BOOL</span> <span class="n">finished</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="p">[</span><span class="bp">UIView</span> <span class="nl">animateWithDuration</span><span class="p">:</span><span class="mf">2.f</span> <span class="nl">delay</span><span class="p">:</span><span class="mf">0.f</span> <span class="nl">options</span><span class="p">:</span><span class="n">UIViewAnimationOptionCurveEaseInOut</span> <span class="nl">animations</span><span class="p">:</span><span class="o">^</span><span class="p">{</span>
</span><span class='line'>        <span class="c1">//  fade out</span>
</span><span class='line'>        <span class="p">[</span><span class="n">view</span> <span class="nl">setAlpha</span><span class="p">:</span><span class="mf">0.f</span><span class="p">];</span>
</span><span class='line'>    <span class="p">}</span> <span class="nl">completion</span><span class="p">:</span><span class="nb">nil</span><span class="p">];</span>
</span><span class='line'><span class="p">}];</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Reachability</h2>

<p>ReachableViaWiFi</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="nb">self</span><span class="p">.</span><span class="n">reachability</span> <span class="o">=</span> <span class="p">[</span><span class="n">Reachability</span> <span class="n">reachabilityForInternetConnection</span><span class="p">];</span>
</span><span class='line'><span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">reachability</span> <span class="n">startNotifier</span><span class="p">];</span>
</span><span class='line'><span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">reachability</span> <span class="n">stopNotifier</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure>


<p>Wi-Fi Name</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="p">+</span> <span class="p">(</span><span class="bp">NSString</span> <span class="o">*</span><span class="p">)</span><span class="nf">currentWifiName</span> <span class="p">{</span>
</span><span class='line'>  <span class="bp">NSArray</span> <span class="o">*</span><span class="n">ifs</span> <span class="o">=</span> <span class="p">(</span><span class="k">__bridge_transfer</span> <span class="bp">NSArray</span> <span class="o">*</span><span class="p">)</span><span class="n">CNCopySupportedInterfaces</span><span class="p">();</span>
</span><span class='line'>  <span class="bp">NSString</span> <span class="o">*</span><span class="n">ifnam</span> <span class="o">=</span> <span class="p">[</span><span class="n">ifs</span> <span class="n">firstObject</span><span class="p">];</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">ifnam</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nb">nil</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="bp">NSDictionary</span> <span class="o">*</span><span class="n">info</span> <span class="o">=</span> <span class="p">(</span><span class="k">__bridge_transfer</span> <span class="bp">NSDictionary</span> <span class="o">*</span><span class="p">)</span><span class="n">CNCopyCurrentNetworkInfo</span><span class="p">((</span><span class="k">__bridge</span> <span class="n">CFStringRef</span><span class="p">)</span><span class="n">ifnam</span><span class="p">);</span>
</span><span class='line'>  <span class="k">return</span> <span class="n">info</span><span class="p">[</span><span class="s">@&quot;SSID&quot;</span><span class="p">];</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>NetworkExtension</h2>

<p>Configure VPN tunnels. Customize and extend core networking features.</p>

<h3>Personal VPN</h3>

<p><code>NEVPNManager</code>: is used to create and manage VPN configurations and to control the resulting VPN tunnel connections.<br/>
Non-Personal VPN configurations take precedence over Personal VPN configurations.<br/>
Enable the &ldquo;Personal VPN&rdquo; capability for your app in Xcode.</p>

<h2>UIViewController</h2>

<h2>UINavigationController</h2>

<h2>UITabBarController</h2>

<p class='post-footer'>
  原始地址：
  <a href='http://sxgfxm.github.io/blog/2017/07/15/ioszhi-shi-xiao-ji-170710/'>http://sxgfxm.github.io/blog/2017/07/15/ioszhi-shi-xiao-ji-170710/</a><br/>
  written by <a href='http://sxgfxm.github.io'>Light</a>
  &nbsp;posted at <a href='http://sxgfxm.github.io'>http://sxgfxm.github.io</a>
  </p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[iOS知识小集-170703]]></title>
    <link href="http://sxgfxm.github.io/blog/2017/07/10/ioszhi-shi-xiao-ji-170703/"/>
    <updated>2017-07-10T11:09:16+08:00</updated>
    <id>http://sxgfxm.github.io/blog/2017/07/10/ioszhi-shi-xiao-ji-170703</id>
    <content type="html"><![CDATA[<h2>CAKeyFrameAnimation</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="p">-</span> <span class="p">(</span><span class="bp">CAKeyframeAnimation</span> <span class="o">*</span><span class="p">)</span><span class="nf">circleShake</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">_circleShake</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">CGFloat</span> <span class="n">baseX</span> <span class="o">=</span> <span class="nb">self</span><span class="p">.</span><span class="n">circleMask</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">x</span><span class="p">;</span>
</span><span class='line'>    <span class="n">_circleShake</span> <span class="o">=</span> <span class="p">[</span><span class="bp">CAKeyframeAnimation</span> <span class="nl">animationWithKeyPath</span><span class="p">:</span><span class="s">@&quot;position.x&quot;</span><span class="p">];</span>
</span><span class='line'>    <span class="n">_circleShake</span><span class="p">.</span><span class="n">keyTimes</span> <span class="o">=</span> <span class="l">@[</span>
</span><span class='line'>      <span class="mi">@0</span><span class="p">,</span>
</span><span class='line'>      <span class="l">@(</span><span class="mf">0.1</span> <span class="o">/</span> <span class="mf">0.8</span><span class="l">)</span><span class="p">,</span>
</span><span class='line'>      <span class="l">@(</span><span class="mf">0.2</span> <span class="o">/</span> <span class="mf">0.8</span><span class="l">)</span><span class="p">,</span>
</span><span class='line'>      <span class="l">@(</span><span class="mf">0.3</span> <span class="o">/</span> <span class="mf">0.8</span><span class="l">)</span><span class="p">,</span>
</span><span class='line'>      <span class="l">@(</span><span class="mf">0.5</span> <span class="o">/</span> <span class="mf">0.8</span><span class="l">)</span><span class="p">,</span>
</span><span class='line'>      <span class="l">@(</span><span class="mf">0.76</span> <span class="o">/</span> <span class="mf">0.8</span><span class="l">)</span>
</span><span class='line'>    <span class="l">]</span><span class="p">;</span>
</span><span class='line'>    <span class="n">_circleShake</span><span class="p">.</span><span class="n">values</span> <span class="o">=</span> <span class="l">@[</span>
</span><span class='line'>      <span class="l">@(</span><span class="n">baseX</span><span class="l">)</span><span class="p">,</span>
</span><span class='line'>      <span class="l">@(</span><span class="n">baseX</span> <span class="o">-</span> <span class="mi">11</span><span class="l">)</span><span class="p">,</span>
</span><span class='line'>      <span class="l">@(</span><span class="n">baseX</span> <span class="o">+</span> <span class="mi">11</span><span class="l">)</span><span class="p">,</span>
</span><span class='line'>      <span class="l">@(</span><span class="n">baseX</span> <span class="o">-</span> <span class="mi">11</span><span class="l">)</span><span class="p">,</span>
</span><span class='line'>      <span class="l">@(</span><span class="n">baseX</span> <span class="o">+</span> <span class="mi">11</span><span class="l">)</span><span class="p">,</span>
</span><span class='line'>      <span class="l">@(</span><span class="n">baseX</span><span class="l">)</span>
</span><span class='line'>    <span class="l">]</span><span class="p">;</span>
</span><span class='line'>    <span class="n">_circleShake</span><span class="p">.</span><span class="n">duration</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">;</span>
</span><span class='line'>    <span class="n">_circleShake</span><span class="p">.</span><span class="n">removedOnCompletion</span> <span class="o">=</span> <span class="nb">YES</span><span class="p">;</span>
</span><span class='line'>    <span class="n">_circleShake</span><span class="p">.</span><span class="n">fillMode</span> <span class="o">=</span> <span class="n">kCAFillModeForwards</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="k">return</span> <span class="n">_circleShake</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>




<!-- more -->


<h2>Identify CAAnimation within the aniamtionDidStop delegate</h2>

<p>The animation is <strong>copied</strong> before being added to the layer, so any subsequent modifications to <code>anim</code> will have no affect unless it is added to another layer.<br/>
Use <code>animationForKey:</code> to identify.<br/>
Create one animation and add to multiple layers.</p>

<h2>Apply changes when animation finished</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">animation</span><span class="p">.</span><span class="n">removedOnCompletion</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span>
</span><span class='line'><span class="n">animation</span><span class="p">.</span><span class="n">fillMode</span> <span class="o">=</span> <span class="n">kCAFillModeForwards</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Resume changes when animation finished</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">animation</span><span class="p">.</span><span class="n">removedOnCompletion</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span>
</span><span class='line'><span class="n">animation</span><span class="p">.</span><span class="n">fillMode</span> <span class="o">=</span> <span class="n">kCAFillModeBackwards</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Use CAAnimationGroup to run animations cocurrently</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="p">-</span> <span class="p">(</span><span class="bp">CAAnimationGroup</span> <span class="o">*</span><span class="p">)</span><span class="nf">circleBig</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">_circleBig</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">_circleBig</span> <span class="o">=</span> <span class="p">[</span><span class="bp">CAAnimationGroup</span> <span class="n">animation</span><span class="p">];</span>
</span><span class='line'>    <span class="bp">CABasicAnimation</span> <span class="o">*</span><span class="n">circleBig</span> <span class="o">=</span>
</span><span class='line'>        <span class="p">[</span><span class="bp">CABasicAnimation</span> <span class="nl">animationWithKeyPath</span><span class="p">:</span><span class="s">@&quot;path&quot;</span><span class="p">];</span>
</span><span class='line'>    <span class="n">circleBig</span><span class="p">.</span><span class="n">fromValue</span> <span class="o">=</span> <span class="p">(</span><span class="k">__bridge</span> <span class="kt">id</span><span class="p">)</span><span class="nb">self</span><span class="p">.</span><span class="n">circleMask</span><span class="p">.</span><span class="n">path</span><span class="p">;</span>
</span><span class='line'>    <span class="n">circleBig</span><span class="p">.</span><span class="n">toValue</span> <span class="o">=</span>
</span><span class='line'>        <span class="p">(</span><span class="k">__bridge</span> <span class="kt">id</span><span class="p">)[</span><span class="bp">UIBezierPath</span> <span class="nl">bezierPathWithArcCenter</span><span class="p">:</span><span class="nb">self</span><span class="p">.</span><span class="n">centerPoint</span>
</span><span class='line'>                                                    <span class="nl">radius</span><span class="p">:</span><span class="mf">12.5</span>
</span><span class='line'>                                                <span class="nl">startAngle</span><span class="p">:</span><span class="mi">0</span>
</span><span class='line'>                                                  <span class="nl">endAngle</span><span class="p">:</span><span class="n">M_PI</span> <span class="o">*</span> <span class="mi">2</span>
</span><span class='line'>                                                 <span class="nl">clockwise</span><span class="p">:</span><span class="nb">YES</span><span class="p">]</span>
</span><span class='line'>            <span class="p">.</span><span class="bp">CGPath</span><span class="p">;</span>
</span><span class='line'>    <span class="n">circleBig</span><span class="p">.</span><span class="n">duration</span> <span class="o">=</span> <span class="nb">self</span><span class="p">.</span><span class="n">spreadDuration</span><span class="p">;</span>
</span><span class='line'>    <span class="n">circleBig</span><span class="p">.</span><span class="n">removedOnCompletion</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span>
</span><span class='line'>    <span class="n">circleBig</span><span class="p">.</span><span class="n">fillMode</span> <span class="o">=</span> <span class="n">kCAFillModeForwards</span><span class="p">;</span>
</span><span class='line'>    <span class="n">circleBig</span><span class="p">.</span><span class="n">timingFunction</span> <span class="o">=</span> <span class="p">[</span><span class="bp">CAMediaTimingFunction</span>
</span><span class='line'>        <span class="nl">functionWithName</span><span class="p">:</span><span class="n">kCAMediaTimingFunctionEaseInEaseOut</span><span class="p">];</span>
</span><span class='line'>    <span class="bp">CABasicAnimation</span> <span class="o">*</span><span class="n">changeWidth</span> <span class="o">=</span>
</span><span class='line'>        <span class="p">[</span><span class="bp">CABasicAnimation</span> <span class="nl">animationWithKeyPath</span><span class="p">:</span><span class="s">@&quot;lineWidth&quot;</span><span class="p">];</span>
</span><span class='line'>    <span class="n">changeWidth</span><span class="p">.</span><span class="n">fromValue</span> <span class="o">=</span> <span class="l">@(</span><span class="nb">self</span><span class="p">.</span><span class="n">circleMask</span><span class="p">.</span><span class="n">lineWidth</span><span class="l">)</span><span class="p">;</span>
</span><span class='line'>    <span class="n">changeWidth</span><span class="p">.</span><span class="n">toValue</span> <span class="o">=</span> <span class="l">@(</span><span class="mi">5</span><span class="l">)</span><span class="p">;</span>
</span><span class='line'>    <span class="n">changeWidth</span><span class="p">.</span><span class="n">duration</span> <span class="o">=</span> <span class="nb">self</span><span class="p">.</span><span class="n">spreadDuration</span><span class="p">;</span>
</span><span class='line'>    <span class="n">changeWidth</span><span class="p">.</span><span class="n">removedOnCompletion</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span>
</span><span class='line'>    <span class="n">changeWidth</span><span class="p">.</span><span class="n">fillMode</span> <span class="o">=</span> <span class="n">kCAFillModeForwards</span><span class="p">;</span>
</span><span class='line'>    <span class="n">_circleBig</span><span class="p">.</span><span class="n">animations</span> <span class="o">=</span> <span class="l">@[</span> <span class="n">circleBig</span><span class="p">,</span> <span class="n">changeWidth</span> <span class="l">]</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="k">return</span> <span class="n">_circleBig</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>TabBar背景设为透明色</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="p">[[</span><span class="bp">UITabBar</span> <span class="n">appearance</span><span class="p">]</span> <span class="nl">setShadowImage</span><span class="p">:[</span><span class="n">WWImageUtil</span> <span class="nl">imageWithColor</span><span class="p">:[</span><span class="bp">UIColor</span> <span class="n">clearColor</span><span class="p">]]];</span>
</span><span class='line'><span class="p">[[</span><span class="bp">UITabBar</span> <span class="n">appearance</span><span class="p">]</span> <span class="nl">setBackgroundImage</span><span class="p">:[</span><span class="n">WWImageUtil</span> <span class="nl">imageWithColor</span><span class="p">:[</span><span class="bp">UIColor</span> <span class="n">clearColor</span><span class="p">]]];</span>
</span><span class='line'><span class="p">[</span><span class="bp">UITabBar</span> <span class="n">appearance</span><span class="p">].</span><span class="n">translucent</span> <span class="o">=</span> <span class="nb">YES</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<h2>TabBar去除黑线</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="p">[[</span><span class="bp">UITabBar</span> <span class="n">appearance</span><span class="p">]</span> <span class="nl">setClipsToBounds</span><span class="p">:</span><span class="nb">YES</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure>


<h2>self.title</h2>

<p><code>self.title</code>：同时设置导航栏和tabBar的title；<br/>
<code>self.navigationItem.title</code>：设置导航栏title；<br/>
<code>self.tabBarItem.title</code>：设置tabBartitle。</p>

<h2>InHouse 和 Debug配置不同</h2>

<p class='post-footer'>
  原始地址：
  <a href='http://sxgfxm.github.io/blog/2017/07/10/ioszhi-shi-xiao-ji-170703/'>http://sxgfxm.github.io/blog/2017/07/10/ioszhi-shi-xiao-ji-170703/</a><br/>
  written by <a href='http://sxgfxm.github.io'>Light</a>
  &nbsp;posted at <a href='http://sxgfxm.github.io'>http://sxgfxm.github.io</a>
  </p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[iOS知识小集-170626]]></title>
    <link href="http://sxgfxm.github.io/blog/2017/07/03/ioszhi-shi-xiao-ji-170626/"/>
    <updated>2017-07-03T09:09:47+08:00</updated>
    <id>http://sxgfxm.github.io/blog/2017/07/03/ioszhi-shi-xiao-ji-170626</id>
    <content type="html"><![CDATA[<h2>隐藏tabBar</h2>

<p><code>self.tabBarController.tabBar.hidden=YES;</code></p>

<h2>UIView animate height from bottom to top</h2>

<p>Increase the height while decreasing the origin.y by the same amount.</p>

<p class='post-footer'>
  原始地址：
  <a href='http://sxgfxm.github.io/blog/2017/07/03/ioszhi-shi-xiao-ji-170626/'>http://sxgfxm.github.io/blog/2017/07/03/ioszhi-shi-xiao-ji-170626/</a><br/>
  written by <a href='http://sxgfxm.github.io'>Light</a>
  &nbsp;posted at <a href='http://sxgfxm.github.io'>http://sxgfxm.github.io</a>
  </p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[iOS知识小集-170619]]></title>
    <link href="http://sxgfxm.github.io/blog/2017/06/26/ioszhi-shi-xiao-ji-170619/"/>
    <updated>2017-06-26T11:57:15+08:00</updated>
    <id>http://sxgfxm.github.io/blog/2017/06/26/ioszhi-shi-xiao-ji-170619</id>
    <content type="html"><![CDATA[<h2>Enable file sharing</h2>

<p>Application Supports iTunes file sharing = YES</p>

<h2>Image Slicing</h2>

<p>使用Xcode Image Slicing图片需为标准的PNG图片。</p>

<h2>TabBar</h2>

<p>高度49</p>

<!-- more -->


<h2>UIPageViewController</h2>

<p>子controller并不会被缩放，而是从上到下布局，可能被截断。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">setupPageController</span><span class="p">{</span>
</span><span class='line'>  <span class="nb">self</span><span class="p">.</span><span class="n">pageController</span> <span class="o">=</span>
</span><span class='line'>      <span class="p">[[</span><span class="bp">UIPageViewController</span> <span class="n">alloc</span><span class="p">]</span> <span class="nl">initWithTransitionStyle</span><span class="p">:</span><span class="n">UIPageViewControllerTransitionStyleScroll</span>
</span><span class='line'>                                      <span class="nl">navigationOrientation</span><span class="p">:</span><span class="n">UIPageViewControllerNavigationOrientationVertical</span>
</span><span class='line'>                                                    <span class="nl">options</span><span class="p">:</span><span class="n">options</span><span class="p">];</span>
</span><span class='line'>  <span class="nb">self</span><span class="p">.</span><span class="n">pageController</span><span class="p">.</span><span class="n">view</span><span class="p">.</span><span class="n">frame</span> <span class="o">=</span> <span class="n">CGRectMake</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="n">kScreen_Width</span><span class="p">,</span> <span class="n">kScreen_Height</span> <span class="o">-</span> <span class="mi">64</span> <span class="o">-</span> <span class="mi">49</span><span class="p">);</span>
</span><span class='line'>  <span class="nb">self</span><span class="p">.</span><span class="n">pageController</span><span class="p">.</span><span class="n">dataSource</span> <span class="o">=</span> <span class="nb">self</span><span class="p">;</span>
</span><span class='line'>  <span class="nb">self</span><span class="p">.</span><span class="n">pages</span> <span class="o">=</span> <span class="l">@[</span> <span class="nb">self</span><span class="p">.</span><span class="n">mainVC</span><span class="p">,</span> <span class="nb">self</span><span class="p">.</span><span class="n">bottomVC</span> <span class="l">]</span><span class="p">;</span>
</span><span class='line'>  <span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">pageController</span> <span class="nl">setViewControllers</span><span class="p">:</span><span class="l">@[</span> <span class="nb">self</span><span class="p">.</span><span class="n">pages</span><span class="p">.</span><span class="n">firstObject</span> <span class="l">]</span>
</span><span class='line'>                                <span class="nl">direction</span><span class="p">:</span><span class="n">UIPageViewControllerNavigationDirectionForward</span>
</span><span class='line'>                                 <span class="nl">animated</span><span class="p">:</span><span class="nb">YES</span>
</span><span class='line'>                               <span class="nl">completion</span><span class="p">:</span><span class="nb">nil</span><span class="p">];</span>
</span><span class='line'>  <span class="p">[</span><span class="nb">self</span> <span class="nl">addChildViewController</span><span class="p">:</span><span class="nb">self</span><span class="p">.</span><span class="n">pageController</span><span class="p">];</span>
</span><span class='line'>  <span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">view</span> <span class="nl">addSubview</span><span class="p">:</span><span class="nb">self</span><span class="p">.</span><span class="n">pageController</span><span class="p">.</span><span class="n">view</span><span class="p">];</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="cp">#pragma mark - UIPageViewControllerDataSource</span>
</span><span class='line'><span class="p">-</span> <span class="p">(</span><span class="bp">UIViewController</span> <span class="o">*</span><span class="p">)</span><span class="nf">pageViewController:</span><span class="p">(</span><span class="bp">UIPageViewController</span> <span class="o">*</span><span class="p">)</span><span class="nv">pageViewController</span>
</span><span class='line'>      <span class="nf">viewControllerBeforeViewController:</span><span class="p">(</span><span class="bp">UIViewController</span> <span class="o">*</span><span class="p">)</span><span class="nv">viewController</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">([</span><span class="n">viewController</span> <span class="nl">isKindOfClass</span><span class="p">:[</span><span class="n">ViewController1</span> <span class="k">class</span><span class="p">]])</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nb">nil</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">([</span><span class="n">viewController</span> <span class="nl">isKindOfClass</span><span class="p">:[</span><span class="n">ViewController2</span> <span class="k">class</span><span class="p">]])</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nb">self</span><span class="p">.</span><span class="n">pages</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="k">return</span> <span class="nb">nil</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="p">-</span> <span class="p">(</span><span class="bp">UIViewController</span> <span class="o">*</span><span class="p">)</span><span class="nf">pageViewController:</span><span class="p">(</span><span class="bp">UIPageViewController</span> <span class="o">*</span><span class="p">)</span><span class="nv">pageViewController</span>
</span><span class='line'>       <span class="nf">viewControllerAfterViewController:</span><span class="p">(</span><span class="bp">UIViewController</span> <span class="o">*</span><span class="p">)</span><span class="nv">viewController</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">([</span><span class="n">viewController</span> <span class="nl">isKindOfClass</span><span class="p">:[</span><span class="n">ViewController1</span> <span class="k">class</span><span class="p">]])</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nb">self</span><span class="p">.</span><span class="n">pages</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">([</span><span class="n">viewController</span> <span class="nl">isKindOfClass</span><span class="p">:[</span><span class="n">ViewController2</span> <span class="k">class</span><span class="p">]])</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nb">nil</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="k">return</span> <span class="nb">nil</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>




<p class='post-footer'>
  原始地址：
  <a href='http://sxgfxm.github.io/blog/2017/06/26/ioszhi-shi-xiao-ji-170619/'>http://sxgfxm.github.io/blog/2017/06/26/ioszhi-shi-xiao-ji-170619/</a><br/>
  written by <a href='http://sxgfxm.github.io'>Light</a>
  &nbsp;posted at <a href='http://sxgfxm.github.io'>http://sxgfxm.github.io</a>
  </p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[iOS知识小集-170612]]></title>
    <link href="http://sxgfxm.github.io/blog/2017/06/16/ioszhi-shi-xiao-ji-170612/"/>
    <updated>2017-06-16T14:08:12+08:00</updated>
    <id>http://sxgfxm.github.io/blog/2017/06/16/ioszhi-shi-xiao-ji-170612</id>
    <content type="html"><![CDATA[<h2>MBProgressHUD需要在主线程调用</h2>

<p>UI在主线程操作。</p>

<!-- more -->


<h2>引入库</h2>

<p><code>#import &lt;&gt;</code>: global include<br/>
<code>#import ""</code>: local include<br/>
<code>#import</code>: only include once<br/>
<code>#include</code>: may recursive include<br/>
<code>@import</code>: done automatically</p>

<h2>Edit Scheme</h2>

<p>定义不同的宏</p>

<h2>NSAssert</h2>

<p>多用断言</p>

<h2>打包和解包</h2>

<p>打包：头 + 长度 + 内容。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="p">-</span> <span class="p">(</span><span class="bp">NSData</span> <span class="o">*</span><span class="p">)</span><span class="nf">packageData:</span><span class="p">(</span><span class="bp">NSData</span> <span class="o">*</span><span class="p">)</span><span class="nv">data</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">NSAssert</span><span class="p">(</span><span class="n">data</span> <span class="o">&amp;&amp;</span> <span class="n">data</span><span class="p">.</span><span class="n">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s">@&quot;Data cannot be empty&quot;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="bp">NSMutableData</span> <span class="o">*</span><span class="n">payload</span> <span class="o">=</span> <span class="p">[</span><span class="bp">NSMutableData</span> <span class="n">data</span><span class="p">];</span>
</span><span class='line'>  <span class="kt">int</span> <span class="n">length</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">data</span><span class="p">.</span><span class="n">length</span><span class="p">;</span>
</span><span class='line'>  <span class="p">[</span><span class="n">payload</span> <span class="nl">appendBytes</span><span class="p">:</span><span class="n">kMagicHeader</span> <span class="nl">length</span><span class="p">:</span><span class="mi">4</span><span class="p">];</span>
</span><span class='line'>  <span class="p">[</span><span class="n">payload</span> <span class="nl">appendBytes</span><span class="p">:</span><span class="o">&amp;</span><span class="n">length</span> <span class="nl">length</span><span class="p">:</span><span class="mi">4</span><span class="p">];</span>
</span><span class='line'>  <span class="p">[</span><span class="n">payload</span> <span class="nl">appendData</span><span class="p">:</span><span class="n">data</span><span class="p">];</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">return</span> <span class="n">payload</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>解包：取头 + 取长度 + 取内容。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">parseData:</span><span class="p">(</span><span class="bp">NSData</span> <span class="o">*</span><span class="p">)</span><span class="nv">data</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">@synchronized</span><span class="p">(</span><span class="nb">self</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">writeBuffer</span> <span class="nl">appendData</span><span class="p">:</span><span class="n">data</span><span class="p">];</span>
</span><span class='line'>    <span class="k">while</span> <span class="p">(</span><span class="nb">self</span><span class="p">.</span><span class="n">writeBuffer</span><span class="p">.</span><span class="n">length</span> <span class="o">-</span> <span class="nb">self</span><span class="p">.</span><span class="n">writeBufferOffset</span> <span class="o">&gt;</span> <span class="mi">8</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="c1">// Parse header</span>
</span><span class='line'>      <span class="kt">char</span> <span class="n">header</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
</span><span class='line'>      <span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">writeBuffer</span> <span class="nl">getBytes</span><span class="p">:</span><span class="n">header</span> <span class="nl">range</span><span class="p">:</span><span class="n">NSMakeRange</span><span class="p">(</span><span class="nb">self</span><span class="p">.</span><span class="n">writeBufferOffset</span><span class="p">,</span> <span class="mi">4</span><span class="p">)];</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="n">header</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">kMagicHeader</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">||</span> <span class="n">header</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">kMagicHeader</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">||</span> <span class="n">header</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="n">kMagicHeader</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">||</span>
</span><span class='line'>          <span class="n">header</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">!=</span> <span class="n">kMagicHeader</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="p">{</span>
</span><span class='line'>        <span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;Invalid magic header&quot;</span><span class="p">);</span>
</span><span class='line'>        <span class="nb">self</span><span class="p">.</span><span class="n">writeBufferOffset</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>        <span class="k">continue</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="c1">// Parse length</span>
</span><span class='line'>      <span class="kt">int</span> <span class="n">length</span><span class="p">;</span>
</span><span class='line'>      <span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">writeBuffer</span> <span class="nl">getBytes</span><span class="p">:</span><span class="o">&amp;</span><span class="n">length</span> <span class="nl">range</span><span class="p">:</span><span class="n">NSMakeRange</span><span class="p">(</span><span class="nb">self</span><span class="p">.</span><span class="n">writeBufferOffset</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)];</span>
</span><span class='line'>
</span><span class='line'>      <span class="c1">// Parse payload</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nb">self</span><span class="p">.</span><span class="n">writeBuffer</span><span class="p">.</span><span class="n">length</span> <span class="o">-</span> <span class="nb">self</span><span class="p">.</span><span class="n">writeBufferOffset</span> <span class="o">-</span> <span class="mi">8</span> <span class="o">&lt;</span> <span class="n">length</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">break</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="bp">NSData</span> <span class="o">*</span><span class="n">payload</span> <span class="o">=</span> <span class="p">[</span><span class="bp">NSData</span> <span class="nl">dataWithBytes</span><span class="p">:[</span><span class="nb">self</span><span class="p">.</span><span class="n">writeBuffer</span> <span class="n">bytes</span><span class="p">]</span> <span class="o">+</span> <span class="nb">self</span><span class="p">.</span><span class="n">writeBufferOffset</span> <span class="o">+</span> <span class="mi">8</span> <span class="nl">length</span><span class="p">:</span><span class="n">length</span><span class="p">];</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nb">self</span><span class="p">.</span><span class="n">delegate</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">delegate</span> <span class="nl">onIncomingData</span><span class="p">:</span><span class="n">payload</span><span class="p">];</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="nb">self</span><span class="p">.</span><span class="n">writeBufferOffset</span> <span class="o">=</span> <span class="nb">self</span><span class="p">.</span><span class="n">writeBufferOffset</span> <span class="o">+</span> <span class="mi">8</span> <span class="o">+</span> <span class="n">length</span><span class="p">;</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nb">self</span><span class="p">.</span><span class="n">writeBufferOffset</span> <span class="o">&gt;=</span> <span class="nb">self</span><span class="p">.</span><span class="n">writeBuffer</span><span class="p">.</span><span class="n">length</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="nb">self</span><span class="p">.</span><span class="n">writeBuffer</span> <span class="o">=</span> <span class="p">[[</span><span class="bp">NSMutableData</span> <span class="n">alloc</span><span class="p">]</span> <span class="n">init</span><span class="p">];</span>
</span><span class='line'>        <span class="nb">self</span><span class="p">.</span><span class="n">writeBufferOffset</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>NSNetServiceBrowser</h2>

<p>扫描service。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">start</span><span class="p">{</span>
</span><span class='line'>  <span class="bp">NSNetServiceBrowser</span> <span class="o">*</span><span class="n">browser</span> <span class="o">=</span> <span class="p">[[</span><span class="bp">NSNetServiceBrowser</span> <span class="n">alloc</span><span class="p">]</span> <span class="n">init</span><span class="p">];</span>
</span><span class='line'>  <span class="n">browser</span><span class="p">.</span><span class="n">delegate</span> <span class="o">=</span> <span class="nb">self</span><span class="p">;</span>
</span><span class='line'>  <span class="p">[</span><span class="n">browser</span> <span class="nl">searchForServicesOfType</span><span class="p">:</span><span class="s">@&quot;_http._tcp.&quot;</span> <span class="nl">inDomain</span><span class="p">:</span><span class="s">@&quot;&quot;</span><span class="p">];</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">netServiceBrowser:</span><span class="p">(</span><span class="bp">NSNetServiceBrowser</span> <span class="o">*</span><span class="p">)</span><span class="nv">aNetServiceBrowser</span>
</span><span class='line'>           <span class="nf">didFindService:</span><span class="p">(</span><span class="bp">NSNetService</span> <span class="o">*</span><span class="p">)</span><span class="nv">aNetService</span>
</span><span class='line'>               <span class="nf">moreComing:</span><span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span><span class="nv">moreComing</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">([</span><span class="nb">self</span><span class="p">.</span><span class="n">serviceTypes</span> <span class="nl">containsObject</span><span class="p">:</span><span class="n">aNetService</span><span class="p">.</span><span class="n">name</span><span class="p">])</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;Found a service: %@&quot;</span><span class="p">,</span> <span class="n">aNetService</span><span class="p">);</span>
</span><span class='line'>    <span class="n">aNetService</span><span class="p">.</span><span class="n">delegate</span> <span class="o">=</span> <span class="nb">self</span><span class="p">;</span>
</span><span class='line'>    <span class="p">[</span><span class="n">aNetService</span> <span class="nl">resolveWithTimeout</span><span class="p">:</span><span class="mi">5</span><span class="p">];</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">netServiceBrowser:</span><span class="p">(</span><span class="bp">NSNetServiceBrowser</span> <span class="o">*</span><span class="p">)</span><span class="nv">aNetServiceBrowser</span>
</span><span class='line'>         <span class="nf">didRemoveService:</span><span class="p">(</span><span class="bp">NSNetService</span> <span class="o">*</span><span class="p">)</span><span class="nv">aNetService</span>
</span><span class='line'>               <span class="nf">moreComing:</span><span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span><span class="nv">moreComing</span> <span class="p">{</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">netServiceDidResolveAddress:</span><span class="p">(</span><span class="bp">NSNetService</span> <span class="o">*</span><span class="p">)</span><span class="nv">netService</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">([</span><span class="nb">self</span><span class="p">.</span><span class="n">serviceTypes</span> <span class="nl">containsObject</span><span class="p">:</span><span class="n">netService</span><span class="p">.</span><span class="n">name</span><span class="p">])</span> <span class="p">{</span>
</span><span class='line'>    <span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">delegate</span> <span class="nl">serviceAdded</span><span class="p">:</span><span class="n">netService</span><span class="p">];</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="bp">NSURL</span> <span class="o">*</span><span class="n">serviceURL</span> <span class="o">=</span> <span class="p">[</span><span class="bp">NSURL</span> <span class="nl">URLWithString</span><span class="p">:[</span><span class="bp">NSString</span> <span class="nl">stringWithFormat</span><span class="p">:</span><span class="s">@&quot;http://%@:%li&quot;</span><span class="p">,</span> <span class="n">netService</span><span class="p">.</span><span class="n">hostName</span><span class="p">,</span> <span class="p">(</span><span class="kt">long</span><span class="p">)</span><span class="n">netService</span><span class="p">.</span><span class="n">port</span><span class="p">]];</span>
</span><span class='line'>  <span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;Resolved address for service %@: %@&quot;</span><span class="p">,</span> <span class="n">netService</span><span class="p">,</span> <span class="n">serviceURL</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">netService:</span><span class="p">(</span><span class="bp">NSNetService</span> <span class="o">*</span><span class="p">)</span><span class="nv">sender</span> <span class="nf">didNotResolve:</span><span class="p">(</span><span class="bp">NSDictionary</span> <span class="o">*</span><span class="p">)</span><span class="nv">errorDict</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;Couldn&#39;t resolve address for service %@: %@&quot;</span><span class="p">,</span> <span class="n">sender</span><span class="p">,</span> <span class="n">errorDict</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Compress files and folder</h2>

<p><strong>Zip</strong></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="n">zip</span> <span class="o">-</span><span class="n">r</span> <span class="o">-</span><span class="n">X</span> <span class="n">archive_name</span><span class="p">.</span><span class="n">zip</span> <span class="n">folder_to_compress</span>
</span><span class='line'><span class="n">unzip</span> <span class="n">archive_name</span><span class="p">.</span><span class="n">zip</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Upload a file to Google Drive from the command line</h2>

<p>Install <a href="https://github.com/prasmussen/gdrive">gdrive</a>, a command line utility for interacting with Google Drive.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="n">brew</span> <span class="n">install</span> <span class="n">gdrive</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="n">gdrive</span> <span class="n">list</span>
</span><span class='line'><span class="n">gdrive</span> <span class="n">download</span> <span class="n">file_name</span>
</span><span class='line'><span class="n">gdrive</span> <span class="n">upload</span> <span class="n">file_name</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Open a certain folder in Atom</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">cd</span> <span class="n">folder_path</span>
</span><span class='line'><span class="n">atom</span> <span class="p">.</span>
</span></code></pre></td></tr></table></div></figure>


<h2>AFHTTPSessionManager</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">AFHTTPSessionManager</span> <span class="o">*</span><span class="n">manager</span> <span class="o">=</span> <span class="p">[</span><span class="n">AFHTTPSessionManager</span> <span class="n">manager</span><span class="p">];</span>
</span><span class='line'>  <span class="n">manager</span><span class="p">.</span><span class="n">responseSerializer</span> <span class="o">=</span> <span class="p">[</span><span class="n">AFHTTPResponseSerializer</span> <span class="n">serializer</span><span class="p">];</span>
</span><span class='line'>  <span class="p">[</span><span class="n">manager</span> <span class="nl">GET</span><span class="p">:</span><span class="n">kXGFeedbackURL</span>
</span><span class='line'>      <span class="nl">parameters</span><span class="p">:</span><span class="nb">nil</span>
</span><span class='line'>      <span class="nl">success</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="bp">NSURLSessionDataTask</span> <span class="o">*</span><span class="n">_Nonnull</span> <span class="n">task</span><span class="p">,</span> <span class="kt">id</span> <span class="n">_Nonnull</span> <span class="n">responseObject</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="bp">NSError</span> <span class="o">*</span><span class="n">error</span> <span class="o">=</span> <span class="nb">nil</span><span class="p">;</span>
</span><span class='line'>        <span class="nb">self</span><span class="p">.</span><span class="n">dataSource</span> <span class="o">=</span> <span class="p">[[</span><span class="n">XGFeedbackResponse</span> <span class="n">alloc</span><span class="p">]</span> <span class="nl">initWithData</span><span class="p">:</span><span class="n">responseObject</span> <span class="nl">error</span><span class="p">:</span><span class="o">&amp;</span><span class="n">error</span><span class="p">];</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="n">DDLogDebug</span><span class="p">(</span><span class="s">@&quot;XG - Feedback response error %@&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">.</span><span class="n">localizedDescription</span><span class="p">);</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>        <span class="n">DDLogDebug</span><span class="p">(</span><span class="s">@&quot;XG - Feedback response %@&quot;</span><span class="p">,</span> <span class="nb">self</span><span class="p">.</span><span class="n">dataSource</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="nl">failure</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="bp">NSURLSessionDataTask</span> <span class="o">*</span><span class="n">_Nullable</span> <span class="n">task</span><span class="p">,</span> <span class="bp">NSError</span> <span class="o">*</span><span class="n">_Nonnull</span> <span class="n">error</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="n">DDLogDebug</span><span class="p">(</span><span class="s">@&quot;XG - Feedback fail %@&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">.</span><span class="n">localizedDescription</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}];</span>
</span></code></pre></td></tr></table></div></figure>


<h2>JSONModel</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="cp">#import &lt;JSONModel/JSONModel.h&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="k">@protocol</span> <span class="nc">XGFeedbackItem</span>;
</span><span class='line'><span class="k">@protocol</span> <span class="nc">XGFeedbackCategory</span>;
</span><span class='line'>
</span><span class='line'><span class="k">@interface</span> <span class="nc">XGFeedbackItem</span> : <span class="nc">JSONModel</span>
</span><span class='line'>
</span><span class='line'><span class="k">@property</span><span class="p">(</span><span class="k">nonatomic</span><span class="p">,</span> <span class="k">strong</span><span class="p">)</span> <span class="bp">NSString</span> <span class="o">*</span><span class="n">cn</span><span class="p">;</span>
</span><span class='line'><span class="k">@property</span><span class="p">(</span><span class="k">nonatomic</span><span class="p">,</span> <span class="k">strong</span><span class="p">)</span> <span class="bp">NSString</span> <span class="o">*</span><span class="n">en</span><span class="p">;</span>
</span><span class='line'><span class="k">@property</span><span class="p">(</span><span class="k">nonatomic</span><span class="p">,</span> <span class="k">strong</span><span class="p">)</span> <span class="bp">NSString</span> <span class="o">*</span><span class="n">tw</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="k">@end</span>
</span><span class='line'>
</span><span class='line'><span class="k">@interface</span> <span class="nc">XGFeedbackCategory</span> : <span class="nc">JSONModel</span>
</span><span class='line'>
</span><span class='line'><span class="k">@property</span><span class="p">(</span><span class="k">nonatomic</span><span class="p">,</span> <span class="k">strong</span><span class="p">)</span> <span class="n">XGFeedbackItem</span> <span class="o">*</span><span class="n">title</span><span class="p">;</span>
</span><span class='line'><span class="k">@property</span><span class="p">(</span><span class="k">nonatomic</span><span class="p">,</span> <span class="k">strong</span><span class="p">)</span> <span class="bp">NSArray</span><span class="o">&lt;</span><span class="n">XGFeedbackItem</span> <span class="o">*&gt;&lt;</span><span class="n">XGFeedbackItem</span><span class="o">&gt;</span> <span class="o">*</span><span class="n">detail</span><span class="p">;</span>
</span><span class='line'><span class="k">@property</span><span class="p">(</span><span class="k">nonatomic</span><span class="p">,</span> <span class="k">assign</span><span class="p">)</span> <span class="kt">BOOL</span> <span class="n">multiple</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="k">@end</span>
</span><span class='line'>
</span><span class='line'><span class="k">@interface</span> <span class="nc">XGFeedbackResponse</span> : <span class="nc">JSONModel</span>
</span><span class='line'>
</span><span class='line'><span class="k">@property</span><span class="p">(</span><span class="k">nonatomic</span><span class="p">,</span> <span class="k">strong</span><span class="p">)</span> <span class="bp">NSString</span> <span class="o">*</span><span class="n">product</span><span class="p">;</span>
</span><span class='line'><span class="k">@property</span><span class="p">(</span><span class="k">nonatomic</span><span class="p">,</span> <span class="k">strong</span><span class="p">)</span> <span class="bp">NSArray</span><span class="o">&lt;</span><span class="n">XGFeedbackCategory</span> <span class="o">*&gt;&lt;</span><span class="n">XGFeedbackCategory</span><span class="o">&gt;</span> <span class="o">*</span><span class="n">content</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="k">@end</span>
</span></code></pre></td></tr></table></div></figure>


<h2>获取系统语言</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="bp">NSString</span> <span class="o">*</span><span class="n">language</span> <span class="o">=</span> <span class="p">[[</span><span class="bp">NSLocale</span> <span class="n">preferredLanguages</span><span class="p">]</span> <span class="n">firstObject</span><span class="p">];</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">([</span><span class="n">language</span> <span class="nl">hasPrefix</span><span class="p">:</span><span class="s">@&quot;zh-Hans&quot;</span><span class="p">])</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nb">self</span><span class="p">.</span><span class="n">cn</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">([</span><span class="n">language</span> <span class="nl">hasPrefix</span><span class="p">:</span><span class="s">@&quot;zh-Hant&quot;</span><span class="p">])</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nb">self</span><span class="p">.</span><span class="n">tw</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nb">self</span><span class="p">.</span><span class="n">en</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>




<p class='post-footer'>
  原始地址：
  <a href='http://sxgfxm.github.io/blog/2017/06/16/ioszhi-shi-xiao-ji-170612/'>http://sxgfxm.github.io/blog/2017/06/16/ioszhi-shi-xiao-ji-170612/</a><br/>
  written by <a href='http://sxgfxm.github.io'>Light</a>
  &nbsp;posted at <a href='http://sxgfxm.github.io'>http://sxgfxm.github.io</a>
  </p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[ComponentKit Tutorial]]></title>
    <link href="http://sxgfxm.github.io/blog/2017/06/13/componentkit-tutorial/"/>
    <updated>2017-06-13T16:23:00+08:00</updated>
    <id>http://sxgfxm.github.io/blog/2017/06/13/componentkit-tutorial</id>
    <content type="html"><![CDATA[<h2>What&rsquo;s Component ?</h2>

<p>Components are <strong>immutable objects</strong> that specify how to configure views.<br/>
A component is a fixed description that can be used to paint a view but that is <strong>not a view itself</strong>.</p>

<!-- more -->


<h2>What&rsquo;s Special ?</h2>

<p><strong>Declarative</strong>: You directly declare the hierarchy of the component from up to down. It&rsquo;s different from what we used to layout views. It turns to <strong>layout your children</strong>, not <strong>layout yourself</strong>.<br/>
<strong>Functional</strong>: Data flows in one direction. Methods take data models and return totally <strong>immutable</strong> components. When state changes, ComponentKit re-renders from the root and reconciles the two component trees from the top with as few changes to the view hierarchy as possible. Cause of one direction data flow, you can focus on how to display the model and simply write unit test for the component.<br/>
<strong>Composable</strong>: A component is ofen composed of other components, building up a component hierarchy that describes a user interface. You can esaily reuse a component just in one line.</p>

<h2>What&rsquo;s Limitation ？</h2>

<p><strong>ListViews</strong>: ComponetKit is optimized to work well with a <strong>UICollectionView</strong>, and with more effort for <strong>UITableView</strong>. It&rsquo;s not efficient in other situation.<br/>
<strong>Gestures</strong>: ComponetKit can simply handle tap gesture but it&rsquo;s hard to implement more complicated gestures like panning, pinching, swiping and so on.<br/>
<strong>Animation</strong>: CKComponent forms a declarative mapping from model to view configuration. Animations should be handled fullyi n the view layer instead of inside Components.<br/>
<strong>LearningCost</strong>: ComponetKit is developed in C++. It will be difficult when you dig into if you are not familiar with C++. You have to get used to <strong>Reactive Philosophy</strong>.</p>

<h2>How to Define a Component ?</h2>

<p>Avoid subclassing <code>CKComponent</code> directly. Instead, subclassing <code>CKCompositeComponent</code>.<br/>
A &ldquo;composite component&rdquo; simply wraps another component, hiding its implementation details from the outside world.<br/>
Steps to define a component:  <br/>
1. Define the model;<br/>
2. Define a class inherit from <code>CKCompositeComponent</code>, and change the suffix from <code>.m</code> to <code>.mm</code>, because ComponetKit is developed in C++;<br/>
3. Add a constructor method use <code>+newWith...</code>;<br/>
4. Implement the <code>+newWith...</code> method by directly declare the hierarchy of the component.<br/>
5. Anywhere using component, the suffix of the implementation file should also be <code>.mm</code>.</p>

<p>An example to implement a custom VPADateComponent.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="k">@implementation</span> <span class="nc">VPADateComponent</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//  Data flows in one direction. Component is immutable.</span>
</span><span class='line'><span class="p">+(</span><span class="kt">instancetype</span><span class="p">)</span><span class="nf">newWithDateModel:</span><span class="p">(</span><span class="n">VPADateModel</span> <span class="o">*</span><span class="p">)</span><span class="nv">dateModel</span><span class="p">{</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">dateModel</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nb">nil</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="c1">//  Directly declare the hierarchy of the component from up to down.</span>
</span><span class='line'>  <span class="c1">//  VPADateComponent is composed of CKInsetComponent, CKCenterLayoutComponent and CKLabelComponent and they are alse reuseable.</span>
</span><span class='line'>  <span class="k">return</span> <span class="p">[</span><span class="nb">super</span> <span class="nl">newWithComponent</span><span class="p">:[</span><span class="n">CKInsetComponent</span>
</span><span class='line'>                                  <span class="nl">newWithInsets</span><span class="p">:{.</span><span class="n">left</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="p">.</span><span class="n">top</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="p">.</span><span class="n">right</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="p">.</span><span class="n">bottom</span> <span class="o">=</span> <span class="mi">10</span><span class="p">}</span>
</span><span class='line'>                                  <span class="nl">component</span><span class="p">:[</span><span class="n">CKCenterLayoutComponent</span>
</span><span class='line'>                                             <span class="nl">newWithCenteringOptions</span><span class="p">:</span><span class="n">CKCenterLayoutComponentCenteringXY</span>
</span><span class='line'>                                             <span class="nl">sizingOptions</span><span class="p">:</span><span class="n">CKCenterLayoutComponentSizingOptionDefault</span>
</span><span class='line'>                                             <span class="nl">child</span><span class="p">:[</span><span class="n">CKLabelComponent</span>
</span><span class='line'>                                                    <span class="nl">newWithLabelAttributes</span><span class="p">:{</span>
</span><span class='line'>                                                      <span class="p">.</span><span class="n">string</span> <span class="o">=</span> <span class="n">formatDate</span><span class="p">(</span><span class="n">dateModel</span><span class="p">.</span><span class="n">date</span><span class="p">),</span>
</span><span class='line'>                                                      <span class="p">.</span><span class="n">font</span> <span class="o">=</span> <span class="p">[</span><span class="bp">UIFont</span> <span class="nl">systemFontOfSize</span><span class="p">:</span><span class="mi">12</span><span class="p">],</span>
</span><span class='line'>                                                      <span class="p">.</span><span class="n">color</span> <span class="o">=</span> <span class="p">[</span><span class="bp">UIColor</span> <span class="n">whiteColor</span><span class="p">]</span>
</span><span class='line'>                                                    <span class="p">}</span>
</span><span class='line'>                                                    <span class="nl">viewAttributes</span><span class="p">:{</span>
</span><span class='line'>                                                      <span class="p">{</span><span class="k">@selector</span><span class="p">(</span><span class="nl">setBackgroundColor</span><span class="p">:),[</span><span class="bp">UIColor</span> <span class="n">clearColor</span><span class="p">]},</span>
</span><span class='line'>                                                      <span class="p">{</span><span class="k">@selector</span><span class="p">(</span><span class="nl">setUserInteractionEnabled</span><span class="p">:),</span> <span class="m">@NO</span><span class="p">}</span>
</span><span class='line'>                                                    <span class="p">}</span>
</span><span class='line'>                                                    <span class="nl">size</span><span class="p">:{}]</span>
</span><span class='line'>                                             <span class="nl">size</span><span class="p">:{}]]];</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">static</span> <span class="bp">NSString</span><span class="o">*</span> <span class="nf">formatDate</span><span class="p">(</span><span class="bp">NSDate</span><span class="o">*</span> <span class="n">date</span><span class="p">){</span>
</span><span class='line'>  <span class="bp">NSDateFormatter</span> <span class="o">*</span><span class="n">formatter</span> <span class="o">=</span> <span class="p">[[</span><span class="bp">NSDateFormatter</span> <span class="n">alloc</span><span class="p">]</span> <span class="n">init</span><span class="p">];</span>
</span><span class='line'>  <span class="n">formatter</span><span class="p">.</span><span class="n">dateFormat</span> <span class="o">=</span> <span class="s">@&quot;yyyy-MM-dd hh:mm:ss&quot;</span><span class="p">;</span>
</span><span class='line'>  <span class="k">return</span> <span class="p">[</span><span class="n">formatter</span> <span class="nl">stringFromDate</span><span class="p">:</span><span class="n">date</span><span class="p">];</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">@end</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Common UI Components</h2>

<h3>CKComponent</h3>

<p>The base class of all Components. You can never directly subclass <code>CKComponent</code>.<br/>
Constructor:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="cm">/**</span>
</span><span class='line'><span class="cm"> @param view A struct describing the view for this component. Pass {} to specify that no view should be created.</span>
</span><span class='line'><span class="cm"> @param size A size constraint that should apply to this component. Pass {} to specify no size constraint.</span>
</span><span class='line'><span class="cm"> */</span>
</span><span class='line'><span class="p">+</span> <span class="p">(</span><span class="kt">instancetype</span><span class="p">)</span><span class="nf">newWithView:</span><span class="p">(</span><span class="k">const</span> <span class="n">CKComponentViewConfiguration</span> <span class="o">&amp;</span><span class="p">)</span><span class="nv">view</span>
</span><span class='line'>                       <span class="nf">size:</span><span class="p">(</span><span class="k">const</span> <span class="n">CKComponentSize</span> <span class="o">&amp;</span><span class="p">)</span><span class="nv">size</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Exmaple:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">CKComponent</span> <span class="o">*</span><span class="n">component</span> <span class="o">=</span> <span class="p">[</span><span class="n">CKComponent</span>
</span><span class='line'>  <span class="nl">newWithView</span><span class="p">:{</span>
</span><span class='line'>    <span class="p">[</span><span class="bp">UIView</span> <span class="k">class</span><span class="p">],</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>      <span class="c1">//  set common properties of the view</span>
</span><span class='line'>      <span class="p">{</span><span class="k">@selector</span><span class="p">(</span><span class="nl">setBackgroundColor</span><span class="p">:),[</span><span class="bp">UIColor</span> <span class="n">redColor</span><span class="p">]},</span>
</span><span class='line'>      <span class="c1">//  set user interaction</span>
</span><span class='line'>      <span class="p">{</span><span class="k">@selector</span><span class="p">(</span><span class="nl">setUserInteractionEnabled</span><span class="p">:),</span> <span class="m">@YES</span><span class="p">},</span>
</span><span class='line'>      <span class="c1">//  set tap gesture</span>
</span><span class='line'>      <span class="p">{</span><span class="n">CKComponentTapGestureAttribute</span><span class="p">(</span><span class="k">@selector</span><span class="p">(</span><span class="n">tapAction</span><span class="p">))},</span>
</span><span class='line'>      <span class="c1">//  set layer properties</span>
</span><span class='line'>      <span class="p">{</span><span class="n">CKComponentViewAttribute</span><span class="o">::</span><span class="n">LayerAttribute</span><span class="p">(</span><span class="k">@selector</span><span class="p">(</span><span class="nl">setCornerRadius</span><span class="p">:)),</span> <span class="mf">@10.0</span><span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="nl">size</span><span class="p">:{</span><span class="mi">50</span><span class="p">,</span><span class="mi">50</span><span class="p">}];</span>
</span><span class='line'>
</span><span class='line'><span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">tapAction</span><span class="p">{</span>
</span><span class='line'>  <span class="c1">//  add tap action here</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h3>CKCompositeComponent</h3>

<p><code>CKCompositeComponent</code> allows you to hide your implementation details and avoid subclassing layout components like <code>CKStackLayoutComponent</code>. In almost all cases, you should subclass <code>CKCompositeComponent</code> instead of subclassing any other class directly. This hides your layout implementation details from the outside world.</p>

<h3>CKLabelComponent</h3>

<p>CKLabelComponent is a simplified text component that just displays NSStrings.<br/>
Constructor:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="cm">/**</span>
</span><span class='line'><span class="cm"> @param attributes The content and styling information for the text component.</span>
</span><span class='line'><span class="cm"> @param viewAttributes These are passed directly to CKTextComponent and its backing view.</span>
</span><span class='line'><span class="cm"> @param size The component size or {} for the default which is for the layout to take the maximum space available.</span>
</span><span class='line'><span class="cm"> */</span>
</span><span class='line'><span class="p">+</span> <span class="p">(</span><span class="kt">instancetype</span><span class="p">)</span><span class="nf">newWithLabelAttributes:</span><span class="p">(</span><span class="k">const</span> <span class="n">CKLabelAttributes</span> <span class="o">&amp;</span><span class="p">)</span><span class="nv">attributes</span>
</span><span class='line'>                        <span class="nf">viewAttributes:</span><span class="p">(</span><span class="k">const</span> <span class="n">CKViewComponentAttributeValueMap</span> <span class="o">&amp;</span><span class="p">)</span><span class="nv">viewAttributes</span>
</span><span class='line'>                                  <span class="nf">size:</span><span class="p">(</span><span class="k">const</span> <span class="n">CKComponentSize</span> <span class="o">&amp;</span><span class="p">)</span><span class="nv">size</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Example:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">CKLabelComponent</span> <span class="o">*</span><span class="n">labelComponent</span> <span class="o">=</span> <span class="p">[</span><span class="n">CKLabelComponent</span>
</span><span class='line'>  <span class="nl">newWithLabelAttributes</span><span class="p">:{</span>
</span><span class='line'>    <span class="p">.</span><span class="n">string</span> <span class="o">=</span> <span class="s">@&quot;Lable Component&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="p">.</span><span class="n">color</span> <span class="o">=</span> <span class="p">[</span><span class="bp">UIColor</span> <span class="n">blackColor</span><span class="p">],</span>
</span><span class='line'>    <span class="p">.</span><span class="n">font</span> <span class="o">=</span> <span class="p">[</span><span class="bp">UIFont</span> <span class="nl">systemFontOfSize</span><span class="p">:</span><span class="mi">17</span><span class="p">],</span>
</span><span class='line'>    <span class="p">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">NSTextAlignmentLeft</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="nl">viewAttributes</span><span class="p">:{</span>
</span><span class='line'>    <span class="p">{</span><span class="k">@selector</span><span class="p">(</span><span class="nl">setBackgroundColor</span><span class="p">:),[</span><span class="bp">UIColor</span> <span class="n">clearColor</span><span class="p">]},</span>
</span><span class='line'>    <span class="p">{</span><span class="k">@selector</span><span class="p">(</span><span class="nl">setUserInteractionEnabled</span><span class="p">:),</span> <span class="m">@NO</span><span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="nl">size</span><span class="p">:{.</span><span class="n">maxWidth</span> <span class="o">=</span> <span class="mi">250</span><span class="p">}]</span>
</span></code></pre></td></tr></table></div></figure>


<h3>CKButtonCompoent</h3>

<p>A component that creates a UIButton.<br/>
Constructor:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="cm">/**</span>
</span><span class='line'><span class="cm"> This component chooses the smallest size within its SizeRange that will fit its content. If its max size is smaller</span>
</span><span class='line'><span class="cm"> than the size required to fit its content, it will be truncated.</span>
</span><span class='line'><span class="cm"> */</span>
</span><span class='line'><span class="p">+</span> <span class="p">(</span><span class="kt">instancetype</span><span class="p">)</span><span class="nf">newWithTitles:</span><span class="p">(</span><span class="n">CKContainerWrapper</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">unordered_map</span><span class="o">&lt;</span><span class="n">UIControlState</span><span class="p">,</span> <span class="bp">NSString</span> <span class="o">*&gt;&gt;</span> <span class="o">&amp;&amp;</span><span class="p">)</span><span class="nv">titles</span>
</span><span class='line'>                  <span class="nf">titleColors:</span><span class="p">(</span><span class="n">CKContainerWrapper</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">unordered_map</span><span class="o">&lt;</span><span class="n">UIControlState</span><span class="p">,</span> <span class="bp">UIColor</span> <span class="o">*&gt;&gt;</span> <span class="o">&amp;&amp;</span><span class="p">)</span><span class="nv">titleColors</span>
</span><span class='line'>                       <span class="nf">images:</span><span class="p">(</span><span class="n">CKContainerWrapper</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">unordered_map</span><span class="o">&lt;</span><span class="n">UIControlState</span><span class="p">,</span> <span class="bp">UIImage</span> <span class="o">*&gt;&gt;</span> <span class="o">&amp;&amp;</span><span class="p">)</span><span class="nv">images</span>
</span><span class='line'>             <span class="nf">backgroundImages:</span><span class="p">(</span><span class="n">CKContainerWrapper</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">unordered_map</span><span class="o">&lt;</span><span class="n">UIControlState</span><span class="p">,</span> <span class="bp">UIImage</span> <span class="o">*&gt;&gt;</span> <span class="o">&amp;&amp;</span><span class="p">)</span><span class="nv">backgroundImages</span>
</span><span class='line'>                    <span class="nf">titleFont:</span><span class="p">(</span><span class="bp">UIFont</span> <span class="o">*</span><span class="p">)</span><span class="nv">titleFont</span>
</span><span class='line'>                     <span class="nf">selected:</span><span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span><span class="nv">selected</span>
</span><span class='line'>                      <span class="nf">enabled:</span><span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span><span class="nv">enabled</span>
</span><span class='line'>                       <span class="nf">action:</span><span class="p">(</span><span class="k">const</span> <span class="n">CKTypedComponentAction</span><span class="o">&lt;</span><span class="bp">UIEvent</span> <span class="o">*&gt;</span> <span class="o">&amp;</span><span class="p">)</span><span class="nv">action</span>
</span><span class='line'>                         <span class="nf">size:</span><span class="p">(</span><span class="k">const</span> <span class="n">CKComponentSize</span> <span class="o">&amp;</span><span class="p">)</span><span class="nv">size</span>
</span><span class='line'>   <span class="nf">accessibilityConfiguration:</span><span class="p">(</span><span class="n">CKButtonComponentAccessibilityConfiguration</span><span class="p">)</span><span class="nv">accessibilityConfiguration</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Example:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">CKButtonComponent</span> <span class="o">*</span><span class="n">buttonComponent</span> <span class="o">=</span> <span class="p">[</span><span class="n">CKButtonComponent</span>
</span><span class='line'>  <span class="nl">newWithTitles</span><span class="p">:{</span>
</span><span class='line'>    <span class="p">{</span><span class="n">UIControlStateNormal</span><span class="p">,</span><span class="s">@&quot;button&quot;</span><span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="nl">titleColors</span><span class="p">:{</span>
</span><span class='line'>    <span class="p">{</span><span class="n">UIControlStateNormal</span><span class="p">,[</span><span class="bp">UIColor</span> <span class="n">whiteColor</span><span class="p">]}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="nl">images</span><span class="p">:{}</span>
</span><span class='line'>  <span class="nl">backgroundImages</span><span class="p">:{}</span>
</span><span class='line'>  <span class="nl">titleFont</span><span class="p">:[</span><span class="bp">UIFont</span> <span class="nl">systemFontOfSize</span><span class="p">:</span><span class="mi">20</span><span class="p">]</span>
</span><span class='line'>  <span class="nl">selected</span><span class="p">:</span><span class="nb">NO</span>
</span><span class='line'>  <span class="nl">enabled</span><span class="p">:</span><span class="nb">YES</span>
</span><span class='line'>  <span class="nl">action</span><span class="p">:{</span><span class="n">scope</span><span class="p">,</span><span class="k">@selector</span><span class="p">(</span><span class="n">tapAction</span><span class="p">)}</span>
</span><span class='line'>  <span class="nl">size</span><span class="p">:{}</span>
</span><span class='line'>  <span class="nl">attributes</span><span class="p">:{</span>
</span><span class='line'>    <span class="p">{</span><span class="k">@selector</span><span class="p">(</span><span class="nl">setBackgroundColor</span><span class="p">:),[</span><span class="bp">UIColor</span> <span class="n">yellowColor</span><span class="p">]}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="nl">accessibilityConfiguration</span><span class="p">:{}]</span>
</span><span class='line'>
</span><span class='line'><span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">tapAction</span><span class="p">{</span>
</span><span class='line'>  <span class="c1">//  add tap action here</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h3>CKImageComponent</h3>

<p>A component that displays an image using UIImageView.<br/>
Constructor:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="cm">/**</span>
</span><span class='line'><span class="cm"> Uses a static layout with the given image size and applies additional attributes.</span>
</span><span class='line'><span class="cm"> */</span>
</span><span class='line'><span class="p">+</span> <span class="p">(</span><span class="kt">instancetype</span><span class="p">)</span><span class="nf">newWithImage:</span><span class="p">(</span><span class="bp">UIImage</span> <span class="o">*</span><span class="p">)</span><span class="nv">image</span>
</span><span class='line'>                  <span class="nf">attributes:</span><span class="p">(</span><span class="k">const</span> <span class="n">CKViewComponentAttributeValueMap</span> <span class="o">&amp;</span><span class="p">)</span><span class="nv">attributes</span>
</span><span class='line'>                        <span class="nf">size:</span><span class="p">(</span><span class="k">const</span> <span class="n">CKComponentSize</span> <span class="o">&amp;</span><span class="p">)</span><span class="nv">size</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Example:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">CKImageComponent</span> <span class="o">*</span><span class="n">imageComponent</span> <span class="o">=</span> <span class="p">[</span><span class="n">CKImageComponent</span>
</span><span class='line'>  <span class="nl">newWithImage</span><span class="p">:[</span><span class="bp">UIImage</span> <span class="nl">imageNamed</span><span class="p">:</span><span class="n">imageName</span><span class="p">]</span>
</span><span class='line'>  <span class="nl">attributes</span><span class="p">:{</span>
</span><span class='line'>    <span class="p">{</span><span class="k">@selector</span><span class="p">(</span><span class="nl">setUserInteractionEnabled</span><span class="p">:),</span> <span class="m">@NO</span><span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="nl">size</span><span class="p">:{</span><span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">}]]</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Common Layout Components</h2>

<p>ComponentKit includes a library of components that can be composed to declaratively specify a layout.</p>

<h3>CKStackLayoutComponent</h3>

<p>A simple layout component that stacks a list of children vertically or horizontally.</p>

<p>Constructor:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'> <span class="err"> </span><span class="cm">/** @param view A view configuration, or {} for no view. @param size A size, or {} for the default size. @param style Specifies how children are laid out. @param children A vector of children components. */</span>
</span><span class='line'><span class="o">+</span> <span class="p">(</span><span class="kt">instancetype</span><span class="p">)</span><span class="nl">newWithView</span><span class="p">:(</span><span class="k">const</span> <span class="n">CKComponentViewConfiguration</span> <span class="o">&amp;</span><span class="p">)</span><span class="n">view</span> <span class="err"> </span> <span class="err"> </span> <span class="err"> </span> <span class="err"> </span> <span class="err"> </span> <span class="err"> </span> <span class="err"> </span> <span class="err"> </span> <span class="err"> </span> <span class="err"> </span> <span class="err"> </span> <span class="nl">size</span><span class="p">:(</span><span class="k">const</span> <span class="n">CKComponentSize</span> <span class="o">&amp;</span><span class="p">)</span><span class="n">size</span> <span class="err"> </span> <span class="err"> </span> <span class="err"> </span> <span class="err"> </span> <span class="err"> </span> <span class="err"> </span> <span class="err"> </span> <span class="err"> </span> <span class="err"> </span> <span class="err"> </span>  <span class="nl">style</span><span class="p">:(</span><span class="k">const</span> <span class="n">CKStackLayoutComponentStyle</span> <span class="o">&amp;</span><span class="p">)</span><span class="n">style</span> <span class="err"> </span> <span class="err"> </span> <span class="err"> </span> <span class="err"> </span> <span class="err"> </span> <span class="err"> </span> <span class="err"> </span> <span class="err"> </span> <span class="err"> </span> <span class="nl">children</span><span class="p">:(</span><span class="n">CKContainerWrapper</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">CKStackLayoutComponentChild</span><span class="o">&gt;&gt;</span> <span class="o">&amp;&amp;</span><span class="p">)</span><span class="n">children</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Exmaple:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">CKStackLayoutComponent</span> <span class="o">*</span><span class="n">stackComponent</span> <span class="o">=</span> <span class="p">[</span><span class="n">CKStackLayoutComponent</span>
</span><span class='line'>  <span class="nl">newWithView</span><span class="p">:{}</span>
</span><span class='line'>  <span class="nl">size</span><span class="p">:{}</span>
</span><span class='line'>  <span class="nl">style</span><span class="p">:{.</span><span class="n">direction</span> <span class="o">=</span> <span class="n">CKStackLayoutDirectionVertical</span><span class="p">,</span> <span class="p">.</span><span class="n">alignItems</span> <span class="o">=</span> <span class="n">CKStackLayoutAlignItemsStretch</span><span class="p">}</span>
</span><span class='line'>  <span class="nl">children</span><span class="p">:{</span>
</span><span class='line'>    <span class="p">{</span><span class="n">labelComponent</span><span class="p">},</span>
</span><span class='line'>    <span class="p">{</span><span class="n">buttonComponent</span><span class="p">},</span>
</span><span class='line'>    <span class="p">{</span><span class="n">imageComponent</span><span class="p">}</span>
</span><span class='line'>  <span class="p">}];</span>
</span></code></pre></td></tr></table></div></figure>


<h3>CKInsetComponent</h3>

<p>A component that wraps another component, applying insets around it.<br/>
If the child component has a size specified as a percentage, the percentage is resolved against this component&rsquo;s parent size <strong>after</strong> applying insets.<br/>
CKInsetComponent&rsquo;s child behaves similarly to &ldquo;box-sizing: border-box&rdquo;. <br/>
Constructor:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="cm">/**</span>
</span><span class='line'><span class="cm"> @param view Passed to CKComponent +newWithView:size:. The view, if any, will extend outside the insets.</span>
</span><span class='line'><span class="cm"> @param insets The amount of space to inset on each side.</span>
</span><span class='line'><span class="cm"> @param component The wrapped child component to inset. If nil, this method returns nil.</span>
</span><span class='line'><span class="cm"> */</span>
</span><span class='line'><span class="p">+</span> <span class="p">(</span><span class="kt">instancetype</span><span class="p">)</span><span class="nf">newWithView:</span><span class="p">(</span><span class="k">const</span> <span class="n">CKComponentViewConfiguration</span> <span class="o">&amp;</span><span class="p">)</span><span class="nv">view</span>
</span><span class='line'>                     <span class="nf">insets:</span><span class="p">(</span><span class="bp">UIEdgeInsets</span><span class="p">)</span><span class="nv">insets</span>
</span><span class='line'>                  <span class="nf">component:</span><span class="p">(</span><span class="n">CKComponent</span> <span class="o">*</span><span class="p">)</span><span class="nv">component</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Example:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">CKInsetComponent</span> <span class="o">*</span><span class="n">insetComponent</span> <span class="o">=</span> <span class="p">[</span><span class="n">CKInsetComponent</span>
</span><span class='line'>  <span class="nl">newWithView</span><span class="p">:{}</span>
</span><span class='line'>  <span class="nl">insets</span><span class="p">:{.</span><span class="n">left</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="p">.</span><span class="n">top</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="p">.</span><span class="n">right</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="p">.</span><span class="n">bottom</span> <span class="o">=</span> <span class="mi">10</span><span class="p">}</span>
</span><span class='line'>  <span class="nl">component</span><span class="p">:</span> <span class="n">labelComponent</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure>


<h3>CKCenterLayoutComponent</h3>

<p>Lays out a single child component and position it so that it is centered into the layout bounds.<br/>
Constructor:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="cm">/**</span>
</span><span class='line'><span class="cm"> @param centeringOptions, see CKCenterLayoutComponentCenteringOptions.</span>
</span><span class='line'><span class="cm"> @param sizingOptions, see CKCenterLayoutComponentSizingOptions.</span>
</span><span class='line'><span class="cm"> @param child The child to center.</span>
</span><span class='line'><span class="cm"> @param size The component size or {} for the default which is for the layout to take the maximum space available.</span>
</span><span class='line'><span class="cm"> */</span>
</span><span class='line'><span class="p">+</span> <span class="p">(</span><span class="kt">instancetype</span><span class="p">)</span><span class="nf">newWithCenteringOptions:</span><span class="p">(</span><span class="n">CKCenterLayoutComponentCenteringOptions</span><span class="p">)</span><span class="nv">centeringOptions</span>
</span><span class='line'>                          <span class="nf">sizingOptions:</span><span class="p">(</span><span class="n">CKCenterLayoutComponentSizingOptions</span><span class="p">)</span><span class="nv">sizingOptions</span>
</span><span class='line'>                                  <span class="nf">child:</span><span class="p">(</span><span class="n">CKComponent</span> <span class="o">*</span><span class="p">)</span><span class="nv">child</span>
</span><span class='line'>                                   <span class="nf">size:</span><span class="p">(</span><span class="k">const</span> <span class="n">CKComponentSize</span> <span class="o">&amp;</span><span class="p">)</span><span class="nv">size</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Exmaple:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">CKCenterLayoutComponent</span> <span class="o">*</span> <span class="n">centerComponent</span> <span class="o">=</span> <span class="p">[</span><span class="n">CKCenterLayoutComponent</span>
</span><span class='line'>  <span class="nl">newWithCenteringOptions</span><span class="p">:</span><span class="n">CKCenterLayoutComponentCenteringXY</span>
</span><span class='line'>  <span class="nl">sizingOptions</span><span class="p">:</span><span class="n">CKCenterLayoutComponentSizingOptionDefault</span>
</span><span class='line'>  <span class="nl">child</span><span class="p">:</span><span class="n">labelComponent</span>
</span><span class='line'>  <span class="nl">size</span><span class="p">:{}];</span>
</span></code></pre></td></tr></table></div></figure>


<h3>CKOverlayLayoutComponent</h3>

<p>This component lays out a single component and then overlays a component on top of it streched to its size.<br/>
Constructor:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="p">+</span> <span class="p">(</span><span class="kt">instancetype</span><span class="p">)</span><span class="nf">newWithComponent:</span><span class="p">(</span><span class="n">CKComponent</span> <span class="o">*</span><span class="p">)</span><span class="nv">component</span>
</span><span class='line'>                         <span class="nf">overlay:</span><span class="p">(</span><span class="n">CKComponent</span> <span class="o">*</span><span class="p">)</span><span class="nv">overlay</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Exmaple:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">CKOverlayLayoutComponent</span> <span class="o">*</span><span class="n">overlayComponent</span> <span class="o">=</span> <span class="p">[</span><span class="n">CKOverlayLayoutComponent</span>
</span><span class='line'>  <span class="nl">newWithComponent</span><span class="p">:</span> <span class="n">imageComponent</span>
</span><span class='line'>  <span class="nl">overlay</span><span class="p">:</span> <span class="n">labelComponent</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure>


<h3>CKBackgroundLayoutComponent</h3>

<p>Lays out a single child component, then lays out a background component behind it stretched to its size.<br/>
Constructor:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="cm">/**</span>
</span><span class='line'><span class="cm"> @param component A child that is laid out to determine the size of this component. If this is nil, then this method</span>
</span><span class='line'><span class="cm">        returns nil.</span>
</span><span class='line'><span class="cm"> @param background A child that is laid out behind it. May be nil, in which case the background is omitted.</span>
</span><span class='line'><span class="cm"> */</span>
</span><span class='line'><span class="p">+</span> <span class="p">(</span><span class="kt">instancetype</span><span class="p">)</span><span class="nf">newWithComponent:</span><span class="p">(</span><span class="n">CKComponent</span> <span class="o">*</span><span class="p">)</span><span class="nv">component</span>
</span><span class='line'>                      <span class="nf">background:</span><span class="p">(</span><span class="n">CKComponent</span> <span class="o">*</span><span class="p">)</span><span class="nv">background</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Exmaple:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">CKBackgroundLayoutComponent</span> <span class="o">*</span><span class="n">backgroundComponent</span> <span class="o">=</span> <span class="p">[</span><span class="n">CKBackgroundLayoutComponent</span>
</span><span class='line'>  <span class="nl">newWithComponent</span><span class="p">:</span> <span class="n">labelComponent</span>
</span><span class='line'>  <span class="nl">background</span><span class="p">:</span> <span class="n">imageComponent</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure>


<h3>CKStaticLayoutComponent</h3>

<p>A component that positions children at fixed positions.<br/>
Computes a size that is the union of all childrens' frames.<br/>
Constructor:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="p">@</span><span class="n">param</span> <span class="n">view</span> <span class="n">Passed</span> <span class="n">to</span> <span class="n">the</span> <span class="nb">super</span> <span class="k">class</span> <span class="n">initializer</span><span class="p">.</span>
</span><span class='line'><span class="p">@</span><span class="n">param</span> <span class="n">children</span> <span class="n">Children</span> <span class="n">to</span> <span class="n">be</span> <span class="n">positioned</span> <span class="n">at</span> <span class="n">fixed</span> <span class="n">positions</span><span class="p">.</span>
</span><span class='line'><span class="err">*/</span>
</span><span class='line'><span class="o">+</span> <span class="p">(</span><span class="kt">instancetype</span><span class="p">)</span><span class="nl">newWithView</span><span class="p">:(</span><span class="k">const</span> <span class="n">CKComponentViewConfiguration</span> <span class="o">&amp;</span><span class="p">)</span><span class="n">view</span>
</span><span class='line'>                      <span class="nl">size</span><span class="p">:(</span><span class="k">const</span> <span class="n">CKComponentSize</span> <span class="o">&amp;</span><span class="p">)</span><span class="n">size</span>
</span><span class='line'>                  <span class="nl">children</span><span class="p">:(</span><span class="n">CKContainerWrapper</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">CKStaticLayoutComponentChild</span><span class="o">&gt;&gt;</span> <span class="o">&amp;&amp;</span><span class="p">)</span><span class="n">children</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Exmaple:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">CKStaticLayoutComponent</span> <span class="o">*</span><span class="n">staticComponent</span> <span class="o">=</span> <span class="p">[</span><span class="n">CKStaticLayoutComponent</span>
</span><span class='line'>  <span class="nl">newWithView</span><span class="p">:{}</span>
</span><span class='line'>  <span class="nl">size</span><span class="p">:{}</span>
</span><span class='line'>  <span class="nl">children</span><span class="p">:{</span>
</span><span class='line'>    <span class="p">{</span><span class="n">labelComponent</span><span class="p">},</span>
</span><span class='line'>    <span class="p">{</span><span class="n">buttonComponent</span><span class="p">},</span>
</span><span class='line'>    <span class="p">{</span><span class="n">imageComponent</span><span class="p">}</span>
</span><span class='line'>  <span class="p">}];</span>
</span></code></pre></td></tr></table></div></figure>


<h3>CKRatioLayoutComponent</h3>

<p>For when the content should respect a certain inherent ratio but can be scaled (think photos or videos).<br/>
The ratio passed is the ratio of height / width you expect.<br/>
Constructor:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="p">+</span> <span class="p">(</span><span class="kt">instancetype</span><span class="p">)</span><span class="nf">newWithRatio:</span><span class="p">(</span><span class="n">CGFloat</span><span class="p">)</span><span class="nv">ratio</span>
</span><span class='line'>                        <span class="nf">size:</span><span class="p">(</span><span class="k">const</span> <span class="n">CKComponentSize</span> <span class="o">&amp;</span><span class="p">)</span><span class="nv">size</span>
</span><span class='line'>                   <span class="nf">component:</span><span class="p">(</span><span class="n">CKComponent</span> <span class="o">*</span><span class="p">)</span><span class="nv">component</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Exmaple:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">CKRatioLayoutComponent</span> <span class="o">*</span><span class="n">ratioComponent</span> <span class="o">=</span> <span class="p">[</span><span class="n">CKRatioLayoutComponent</span>
</span><span class='line'>  <span class="nl">newWithRatio</span><span class="p">:</span><span class="mf">0.5</span>
</span><span class='line'>  <span class="nl">size</span><span class="p">:{}</span>
</span><span class='line'>  <span class="nl">component</span><span class="p">:</span><span class="n">imageComponent</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Apply in UICollectionView</h2>

<p>The collection view in ComponentKit is really different from the collection view in UIKit.</p>

<p>The UIKit way to add content to a collection view is:  <br/>
1. Tell the <code>UICollectionView</code> to add/insert/update items or sections.<br/>
2. Synchronously, the <code>UICollectionView</code> ask its data source for number of items, sections and layout info.<br/>
3. Depending on whether or not the updated index paths are visible the <code>UICollectionView</code> will Synchronously call <code>cellForItemAtIndexPath:</code>.<br/>
4. Finally, the data source returns a configured cell for this index path.</p>

<p>The ComponentKit uses an idiom that is more &ldquo;reactive&rdquo;:  <br/>
1. Tell the <code>CKCollectionViewTransactionalDataSource</code> to add/insert/update items or sections.<br/>
2. Asynchronously, and in the background, computes the corresponding components.<br/>
3. When the computation is done, apply the changes to the  <code>UICollectionView</code>.</p>

<p>ComponentKit really shines when used with a <code>UICollectionView</code>:  <br/>
1. <strong>Automatic reuse</strong>. You just need to setup the components and ComponentKit will automaitc reuse and reconfiguration.<br/>
2. <strong>Flexible height</strong>. You don&rsquo;t have to compute the height of each items yourself.<br/>
3. <strong>Scroll performance</strong>. ComponentKit addresses common scroll performance issues holistically.<br/>
4. <strong>Simple to use</strong>. You just need to care about two things, <strong>manipulating data</strong> and <strong>providing components</strong>.</p>

<p>Steps to use ComponentKit in <code>UICollectionView</code>:</p>

<p>1、ViewController()<CKComponentProvider>
ViewController需要遵守<code>CKComponentProvider</code>协议，实现<code>+componentForModel: context:</code>方法，将model转换为component。<br/>
在该方法中，通过不同类型的model返回不同类型的component。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="p">+</span> <span class="p">(</span><span class="n">CKComponent</span> <span class="o">*</span><span class="p">)</span><span class="nf">componentForModel:</span><span class="p">(</span><span class="kt">id</span><span class="o">&lt;</span><span class="bp">NSObject</span><span class="o">&gt;</span><span class="p">)</span><span class="nv">model</span>
</span><span class='line'>                           <span class="nf">context:</span><span class="p">(</span><span class="kt">id</span><span class="o">&lt;</span><span class="bp">NSObject</span><span class="o">&gt;</span><span class="p">)</span><span class="nv">context</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">([</span><span class="n">model</span> <span class="nl">isKindOfClass</span><span class="p">:[</span><span class="n">NewsModel</span> <span class="k">class</span><span class="p">]])</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="p">[</span><span class="n">NewsComponent</span> <span class="nl">newWithNewsModel</span><span class="p">:</span><span class="n">model</span> <span class="nl">context</span><span class="p">:</span><span class="n">context</span><span class="p">];</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="k">return</span> <span class="nb">nil</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>2、FlowLayout
创建<code>UICollectionViewFlowLayout</code>对象，设置滑动方向、间距参数等。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="bp">UICollectionViewFlowLayout</span> <span class="o">*</span><span class="n">flowLayout</span> <span class="o">=</span> <span class="p">[[</span><span class="bp">UICollectionViewFlowLayout</span> <span class="n">alloc</span><span class="p">]</span> <span class="n">init</span><span class="p">];</span>
</span><span class='line'><span class="p">[</span><span class="n">flowLayout</span> <span class="nl">setScrollDirection</span><span class="p">:</span><span class="n">UICollectionViewScrollDirectionVertical</span><span class="p">];</span>
</span><span class='line'><span class="p">[</span><span class="n">flowLayout</span> <span class="nl">setMinimumInteritemSpacing</span><span class="p">:</span><span class="mi">0</span><span class="p">];</span>
</span><span class='line'><span class="p">[</span><span class="n">flowLayout</span> <span class="nl">setMinimumLineSpacing</span><span class="p">:</span><span class="mi">0</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure>


<p>3、CollectionView
创建<code>UICollectionView</code>。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="nb">self</span><span class="p">.</span><span class="n">collectionView</span> <span class="o">=</span> <span class="p">[[</span><span class="bp">UICollectionView</span> <span class="n">alloc</span><span class="p">]</span> <span class="nl">initWithFrame</span><span class="p">:</span><span class="nb">self</span><span class="p">.</span><span class="n">view</span><span class="p">.</span><span class="n">bounds</span> <span class="nl">collectionViewLayout</span><span class="p">:</span><span class="n">flowLayout</span><span class="p">];</span>
</span><span class='line'><span class="nb">self</span><span class="p">.</span><span class="n">collectionView</span><span class="p">.</span><span class="n">delegate</span> <span class="o">=</span> <span class="nb">self</span><span class="p">;</span>
</span><span class='line'><span class="nb">self</span><span class="p">.</span><span class="n">collectionView</span><span class="p">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="p">[</span><span class="bp">UIColor</span> <span class="n">blackColor</span><span class="p">];</span>
</span><span class='line'><span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">view</span> <span class="nl">addSubview</span><span class="p">:</span><span class="nb">self</span><span class="p">.</span><span class="n">collectionView</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure>


<p>4、Item size range
Item size range。通过设置<code>CKComponentSizeRangeFlexibleHeight</code>使item的高度自适应。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="k">const</span> <span class="n">CKSizeRange</span> <span class="n">sizeRange</span> <span class="o">=</span> <span class="p">[[</span><span class="n">CKComponentFlexibleSizeRangeProvider</span>
</span><span class='line'>      <span class="nl">providerWithFlexibility</span><span class="p">:</span><span class="n">CKComponentSizeRangeFlexibleHeight</span><span class="p">]</span>
</span><span class='line'>     <span class="nl">sizeRangeForBoundingSize</span><span class="p">:</span><span class="nb">self</span><span class="p">.</span><span class="n">collectionView</span><span class="p">.</span><span class="n">bounds</span><span class="p">.</span><span class="n">size</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure>


<p>5、Context
Context可以是任何不可变对象，创建component时的不可变上下文信息，比如设备类型，图片下载器。<br/>
<code>MyContext *context = [MyContext new];</code><br/>
预先在主线程加载图片。</p>

<p>6、Configuration
<code>CKTransactionalComponentDataSourceConfiguration</code>，需要 <strong>ComponentProvider</strong>，<strong>sizeRange</strong>，<strong>context</strong> 三个参数。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">CKTransactionalComponentDataSourceConfiguration</span> <span class="o">*</span><span class="n">configuration</span> <span class="o">=</span>
</span><span class='line'>      <span class="p">[[</span><span class="n">CKTransactionalComponentDataSourceConfiguration</span> <span class="n">alloc</span><span class="p">]</span>
</span><span class='line'>          <span class="nl">initWithComponentProvider</span><span class="p">:[</span><span class="nb">self</span> <span class="k">class</span><span class="p">]</span>
</span><span class='line'>                            <span class="nl">context</span><span class="p">:</span><span class="n">context</span>
</span><span class='line'>                          <span class="nl">sizeRange</span><span class="p">:</span><span class="n">sizeRange</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure>


<p>7、DataSource
<code>CKCollectionViewTransactionalDataSource</code>,需要 <strong>collectionView</strong>，<strong>supplementaryViewDataSource</strong>，<strong>configuration</strong> 三个参数。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="nb">self</span><span class="p">.</span><span class="n">dataSource</span> <span class="o">=</span> <span class="p">[[</span><span class="n">CKCollectionViewTransactionalDataSource</span> <span class="n">alloc</span><span class="p">]</span>
</span><span class='line'>           <span class="nl">initWithCollectionView</span><span class="p">:</span><span class="nb">self</span><span class="p">.</span><span class="n">collectionView</span>
</span><span class='line'>      <span class="nl">supplementaryViewDataSource</span><span class="p">:</span><span class="nb">nil</span>
</span><span class='line'>                    <span class="nl">configuration</span><span class="p">:</span><span class="n">configuration</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure>


<p>8、Initial changeset
需要初始化DataSource，即向DataSource中添加Section。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="n">CKTransactionalComponentDataSourceChangeset</span> <span class="o">*</span><span class="n">initialChangeset</span> <span class="o">=</span>
</span><span class='line'>  <span class="p">[[[</span><span class="n">CKTransactionalComponentDataSourceChangesetBuilder</span>
</span><span class='line'>      <span class="n">transactionalComponentDataSourceChangeset</span><span class="p">]</span>
</span><span class='line'>      <span class="nl">withInsertedSections</span><span class="p">:[</span><span class="bp">NSIndexSet</span> <span class="nl">indexSetWithIndex</span><span class="p">:</span><span class="mi">0</span><span class="p">]]</span> <span class="n">build</span><span class="p">];</span>
</span><span class='line'><span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">dataSource</span> <span class="nl">applyChangeset</span><span class="p">:</span><span class="n">initialChangeset</span>
</span><span class='line'>                           <span class="nl">mode</span><span class="p">:</span><span class="n">CKUpdateModeAsynchronous</span>
</span><span class='line'>                       <span class="nl">userInfo</span><span class="p">:</span><span class="nb">nil</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure>


<p>9、Insert/Update items
向DataSource中插入Items才能显示。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="bp">NSMutableDictionary</span><span class="o">&lt;</span><span class="bp">NSIndexPath</span> <span class="o">*</span><span class="p">,</span> <span class="n">NewsModel</span> <span class="o">*&gt;</span> <span class="o">*</span><span class="n">items</span> <span class="o">=</span> <span class="p">[</span><span class="bp">NSMutableDictionary</span> <span class="n">new</span><span class="p">];</span>
</span><span class='line'><span class="k">for</span> <span class="p">(</span><span class="bp">NSInteger</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">50</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">NewsModel</span> <span class="o">*</span><span class="n">newsModel</span> <span class="o">=</span> <span class="p">[[</span><span class="n">NewsModel</span> <span class="n">alloc</span><span class="p">]</span> <span class="n">init</span><span class="p">];</span>
</span><span class='line'>  <span class="n">newsModel</span><span class="p">.</span><span class="n">title</span> <span class="o">=</span> <span class="p">[</span><span class="bp">NSString</span> <span class="nl">stringWithFormat</span><span class="p">:</span><span class="s">@&quot;News Title: Title %ld&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">];</span>
</span><span class='line'>  <span class="n">newsModel</span><span class="p">.</span><span class="n">category</span> <span class="o">=</span> <span class="s">@&quot;科技&quot;</span><span class="p">;</span>
</span><span class='line'>  <span class="n">newsModel</span><span class="p">.</span><span class="n">updateTime</span> <span class="o">=</span> <span class="p">[</span><span class="bp">NSDate</span> <span class="n">date</span><span class="p">];</span>
</span><span class='line'>  <span class="n">newsModel</span><span class="p">.</span><span class="n">source</span> <span class="o">=</span> <span class="s">@&quot;网易新闻&quot;</span><span class="p">;</span>
</span><span class='line'>  <span class="p">[</span><span class="n">items</span> <span class="nl">setObject</span><span class="p">:</span><span class="n">newsModel</span>
</span><span class='line'>            <span class="nl">forKey</span><span class="p">:[</span><span class="bp">NSIndexPath</span> <span class="nl">indexPathForRow</span><span class="p">:</span><span class="n">i</span> <span class="nl">inSection</span><span class="p">:</span><span class="mi">0</span><span class="p">]];</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="n">CKTransactionalComponentDataSourceChangeset</span> <span class="o">*</span><span class="n">changeset</span> <span class="o">=</span>
</span><span class='line'>  <span class="p">[[[</span><span class="n">CKTransactionalComponentDataSourceChangesetBuilder</span>
</span><span class='line'>      <span class="n">transactionalComponentDataSourceChangeset</span><span class="p">]</span>
</span><span class='line'>      <span class="nl">withInsertedItems</span><span class="p">:</span><span class="n">items</span><span class="p">]</span> <span class="n">build</span><span class="p">];</span>
</span><span class='line'><span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">dataSource</span> <span class="nl">applyChangeset</span><span class="p">:</span><span class="n">changeset</span>
</span><span class='line'>                           <span class="nl">mode</span><span class="p">:</span><span class="n">CKUpdateModeAsynchronous</span>
</span><span class='line'>                       <span class="nl">userInfo</span><span class="p">:</span><span class="nb">nil</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure>


<p>10、ViewController()&lt;UICollectionViewDelegate, UICollectionViewDelegateFlowLayout></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="p">-</span> <span class="p">(</span><span class="bp">CGSize</span><span class="p">)</span><span class="nf">collectionView:</span><span class="p">(</span><span class="bp">UICollectionView</span> <span class="o">*</span><span class="p">)</span><span class="nv">collectionView</span>
</span><span class='line'>                  <span class="nf">layout:</span><span class="p">(</span><span class="bp">UICollectionViewLayout</span> <span class="o">*</span><span class="p">)</span><span class="nv">collectionViewLayout</span>
</span><span class='line'>  <span class="nf">sizeForItemAtIndexPath:</span><span class="p">(</span><span class="bp">NSIndexPath</span> <span class="o">*</span><span class="p">)</span><span class="nv">indexPath</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">return</span> <span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">dataSource</span> <span class="nl">sizeForItemAtIndexPath</span><span class="p">:</span><span class="n">indexPath</span><span class="p">];</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">collectionView:</span><span class="p">(</span><span class="bp">UICollectionView</span> <span class="o">*</span><span class="p">)</span><span class="nv">collectionView</span>
</span><span class='line'>       <span class="nf">willDisplayCell:</span><span class="p">(</span><span class="bp">UICollectionViewCell</span> <span class="o">*</span><span class="p">)</span><span class="nv">cell</span>
</span><span class='line'>    <span class="nf">forItemAtIndexPath:</span><span class="p">(</span><span class="bp">NSIndexPath</span> <span class="o">*</span><span class="p">)</span><span class="nv">indexPath</span> <span class="p">{</span>
</span><span class='line'>  <span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">dataSource</span> <span class="nl">announceWillDisplayCell</span><span class="p">:</span><span class="n">cell</span><span class="p">];</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">collectionView:</span><span class="p">(</span><span class="bp">UICollectionView</span> <span class="o">*</span><span class="p">)</span><span class="nv">collectionView</span>
</span><span class='line'>  <span class="nf">didEndDisplayingCell:</span><span class="p">(</span><span class="bp">UICollectionViewCell</span> <span class="o">*</span><span class="p">)</span><span class="nv">cell</span>
</span><span class='line'>    <span class="nf">forItemAtIndexPath:</span><span class="p">(</span><span class="bp">NSIndexPath</span> <span class="o">*</span><span class="p">)</span><span class="nv">indexPath</span> <span class="p">{</span>
</span><span class='line'>  <span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">dataSource</span> <span class="nl">announceDidEndDisplayingCell</span><span class="p">:</span><span class="n">cell</span><span class="p">];</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Flexbox layout</h2>

<p><strong>flex container</strong>：容器。<br/>
main axis：main start， main end。<br/>
cross axis：cross start， cross end。<br/>
<strong>flex item</strong>：成员。<br/>
main size。<br/>
cross size。</p>

<h3>Container Properties</h3>

<p>flex-direction：决定主轴方向。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="k">typedef</span> <span class="nf">NS_ENUM</span><span class="p">(</span><span class="bp">NSUInteger</span><span class="p">,</span> <span class="n">CKStackLayoutDirection</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="c1">//  垂直方向</span>
</span><span class='line'>  <span class="n">CKStackLayoutDirectionVertical</span><span class="p">,</span>
</span><span class='line'>  <span class="c1">//  水平方向</span>
</span><span class='line'>  <span class="n">CKStackLayoutDirectionHorizontal</span><span class="p">,</span>
</span><span class='line'><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>


<p>flex-wrap：决定如何换行。<br/>
flex-flow：flex-direction和flex-wrap的简写形式。<br/>
<strong>justify-content</strong>：决定items在主轴上的对齐方式。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="cm">/** If no children are flexible, how should this component justify its children in the available space? */</span>
</span><span class='line'><span class="k">typedef</span> <span class="nf">NS_ENUM</span><span class="p">(</span><span class="bp">NSUInteger</span><span class="p">,</span> <span class="n">CKStackLayoutJustifyContent</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="cm">/**</span>
</span><span class='line'><span class="cm">   On overflow, children overflow out of this component&#39;s bounds on the right/bottom side.</span>
</span><span class='line'><span class="cm">   On underflow, children are left/top-aligned within this component&#39;s bounds.</span>
</span><span class='line'><span class="cm">   */</span>
</span><span class='line'>  <span class="c1">//  左对齐</span>
</span><span class='line'>  <span class="n">CKStackLayoutJustifyContentStart</span><span class="p">,</span>
</span><span class='line'>  <span class="cm">/**</span>
</span><span class='line'><span class="cm">   On overflow, children are centered and overflow on both sides.</span>
</span><span class='line'><span class="cm">   On underflow, children are centered within this component&#39;s bounds in the stacking direction.</span>
</span><span class='line'><span class="cm">   */</span>
</span><span class='line'>  <span class="c1">//  居中</span>
</span><span class='line'>  <span class="n">CKStackLayoutJustifyContentCenter</span><span class="p">,</span>
</span><span class='line'>  <span class="cm">/**</span>
</span><span class='line'><span class="cm">   On overflow, children overflow out of this component&#39;s bounds on the left/top side.</span>
</span><span class='line'><span class="cm">   On underflow, children are right/bottom-aligned within this component&#39;s bounds.</span>
</span><span class='line'><span class="cm">   */</span>
</span><span class='line'>  <span class="c1">//  右对齐</span>
</span><span class='line'>  <span class="n">CKStackLayoutJustifyContentEnd</span><span class="p">,</span>
</span><span class='line'><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>align-items</strong>：决定items在交叉轴上的对齐方式。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="k">typedef</span> <span class="nf">NS_ENUM</span><span class="p">(</span><span class="bp">NSUInteger</span><span class="p">,</span> <span class="n">CKStackLayoutAlignItems</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="cm">/** Align children to start of cross axis */</span>
</span><span class='line'>  <span class="c1">//  交叉轴起点对齐</span>
</span><span class='line'>  <span class="n">CKStackLayoutAlignItemsStart</span><span class="p">,</span>
</span><span class='line'>  <span class="cm">/** Align children with end of cross axis */</span>
</span><span class='line'>  <span class="n">CKStackLayoutAlignItemsEnd</span><span class="p">,</span>
</span><span class='line'>  <span class="c1">//  交叉轴终点对齐</span>
</span><span class='line'>  <span class="cm">/** Center children on cross axis */</span>
</span><span class='line'>  <span class="c1">//  交叉轴居中对齐</span>
</span><span class='line'>  <span class="n">CKStackLayoutAlignItemsCenter</span><span class="p">,</span>
</span><span class='line'>  <span class="cm">/** Expand children to fill cross axis */</span>
</span><span class='line'>  <span class="c1">//  交叉轴方向拉伸</span>
</span><span class='line'>  <span class="n">CKStackLayoutAlignItemsStretch</span><span class="p">,</span>
</span><span class='line'><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Item Properties</h3>

<p>order：决定item排列顺序，数值越小，排位越靠前。<br/>
<strong>flex-grow</strong>：决定item主轴方向的放大比例，默认为0，即如果存在剩余空间，也不放大。<br/>
如果所有项目的flex-grow属性都为1，则它们将等分剩余空间（如果有的话）。如果一个项目的flex-grow属性为2，其他项目都为1，则前者占据的剩余空间将比其他项多一倍。<br/>
<strong>flex-shrink</strong>：决定item主轴方向的缩小比例，默认为1，即如果空间不足，该item将缩小。<br/>
如果所有项目的flex-shrink属性都为1，当空间不足时，都将等比例缩小。如果一个项目的flex-shrink属性为0，其他项目都为1，则空间不足时，前者不缩小。<br/>
<strong>flex-basis</strong>：决定了在分配多余空间之前，item的main size大小，根据该值计算主轴是否有多余空间。<br/>
flex：flex-grow, flex-shrink 和 flex-basis的简写。<br/>
<strong>align-self</strong>：决定item单独的对齐方式，可以覆盖 <strong>align-items</strong> 属性。<br/>
默认值为auto，表示继承父元素的align-items属性，如果没有父元素，则等同于stretch。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="cm">/**</span>
</span><span class='line'><span class="cm"> Each child may override their parent stack&#39;s cross axis alignment.</span>
</span><span class='line'><span class="cm"> @see CKStackLayoutAlignItems</span>
</span><span class='line'><span class="cm"> */</span>
</span><span class='line'><span class="k">typedef</span> <span class="nf">NS_ENUM</span><span class="p">(</span><span class="bp">NSUInteger</span><span class="p">,</span> <span class="n">CKStackLayoutAlignSelf</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="cm">/** Inherit alignment value from containing stack. */</span>
</span><span class='line'>  <span class="n">CKStackLayoutAlignSelfAuto</span><span class="p">,</span>
</span><span class='line'>  <span class="n">CKStackLayoutAlignSelfStart</span><span class="p">,</span>
</span><span class='line'>  <span class="n">CKStackLayoutAlignSelfEnd</span><span class="p">,</span>
</span><span class='line'>  <span class="n">CKStackLayoutAlignSelfCenter</span><span class="p">,</span>
</span><span class='line'>  <span class="n">CKStackLayoutAlignSelfStretch</span><span class="p">,</span>
</span><span class='line'><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>


<h2>FBSnapshotTestCase</h2>

<p><code>FBSnapshotTestCase</code> takes a configured <code>UIView</code> or <code>CALayer</code> and uses the <code>renderInContext:</code> method to get an image snapshot of its contents. It compares this snapshot to a &ldquo;reference image&rdquo; stored in your source code repository and fails the test if the two images don&rsquo;t match.<br/>
It makes the comparison by drawing both the view or layer and the existing snapshot into two <code>CGContextRefs</code> and doing a memory comparison of them with the C function <code>memcmp()</code>.</p>

<h3>Features</h3>

<ol>
<li>It is esay to understand and visible and quickly.</li>
<li>Automatically names reference images on disk according to test class and selector.</li>
<li>Prints a descriptive error message to the console on failure.</li>
<li>Supply an optional &ldquo;identifier&rdquo; if you want to perform multiple snapshots in a single test method.</li>
<li>Support for <code>UIView</code> via <code>FBSnapshotVerifyView</code>.</li>
<li>Support for <code>CALayer</code> via <code>FBSnapshotVerifyLayer</code>.</li>
<li>Support for <code>CKComponent</code> via <code>FBSnapshotVerifyComponent</code>.</li>
<li><code>isDeviceAgnostic</code> to allow appending the device model (iPhone, etc), OS version and screen size to the images (allowing to have multiple tests for the same «snapshot» for different OSs and devices).</li>
<li>Provide a diff image to show the difference when test failed.</li>
<li>It&rsquo;s esay to test different state of the view.</li>
<li>Snapshot tests are run at the same time as the rest of your tests. They can mostly be run without pushing the view to the screen.</li>
<li>Snapshots give code reviews a narrative.</li>
<li>Snapshot tests are fast.</li>
</ol>


<h3>Disadvantages</h3>

<ol>
<li>Testing asynchronous code is hard.</li>
<li>Some components can be hard to test.</li>
<li>Apple’s OS patches can change the way their stock components are rendered.</li>
<li>Each snapshot is a PNG file stored in your repository, and together they average out at about 30-100kb per file.</li>
</ol>


<h3>Install</h3>

<ol>
<li><code>pod 'FBSnapshotTestCase'</code>.</li>
<li>Define <code>FB_REFERENCE_IMAGE_DIR</code> and <code>IMAGE_DIFF_DIR</code> in scheme(Edit Scheme -> Run -> Arguments -> Environment Variables).<br/>
<code>FB_REFERENCE_IMAGE_DIR</code> = <code>$(SOURCE_ROOT)/$(PROJECT_NAME)Tests/ReferenceImages</code><br/>
<code>IMAGE_DIFF_DIR</code> = <code>$(SOURCE_ROOT)/$(PROJECT_NAME)Tests/FailureDiffs</code></li>
</ol>


<h3>Create a snapshot test</h3>

<ol>
<li>Subclass <code>FBSnapshotTestCase</code> instead of <code>XCTestCase</code>.</li>
<li>From within your test, use <code>FBSnapshotVerifyComponent</code>.</li>
<li>Run the test once with <code>self.recordMode = YES;</code> in the test&rsquo;s <code>-setup</code> method. (This creates the reference images on disk)</li>
<li>Run the test again with <code>self.recordMode = NO;</code>.</li>
</ol>


<h3>Notes</h3>

<p>Your unit test must be an &ldquo;application test&rdquo;, not a &ldquo;logic test.&rdquo; (That is, it must be run within the Simulator so that it has access to <code>UIKit</code>.)</p>

<h3>Reference</h3>

<p><a href="https://github.com/facebook/ios-snapshot-test-case">FBSnapshotTestCase</a><br/>
<a href="https://www.objc.io/issues/15-testing/snapshot-testing/">Snapshot Testing</a><br/>
<a href="https://github.com/orta/snapshots">Snapshot Plugin</a></p>

<p class='post-footer'>
  原始地址：
  <a href='http://sxgfxm.github.io/blog/2017/06/13/componentkit-tutorial/'>http://sxgfxm.github.io/blog/2017/06/13/componentkit-tutorial/</a><br/>
  written by <a href='http://sxgfxm.github.io'>Light</a>
  &nbsp;posted at <a href='http://sxgfxm.github.io'>http://sxgfxm.github.io</a>
  </p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[iOS知识小集-170605]]></title>
    <link href="http://sxgfxm.github.io/blog/2017/06/12/ioszhi-shi-xiao-ji-170605/"/>
    <updated>2017-06-12T09:42:42+08:00</updated>
    <id>http://sxgfxm.github.io/blog/2017/06/12/ioszhi-shi-xiao-ji-170605</id>
    <content type="html"><![CDATA[<h2>fopen时路径名为日文时崩溃</h2>

<p>路径中尽量不要出现特殊字符。</p>

<!-- more -->


<h2>显示 &lt; 号</h2>

<p>居然因为是字体原因</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'>  <span class="n">CGFloat</span> <span class="n">width</span> <span class="o">=</span> <span class="n">kScaleFrom_iPhone6_Desgin</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
</span><span class='line'>  <span class="bp">CAShapeLayer</span> <span class="o">*</span><span class="n">shapeLayer</span> <span class="o">=</span> <span class="p">[</span><span class="bp">CAShapeLayer</span> <span class="n">layer</span><span class="p">];</span>
</span><span class='line'>  <span class="n">shapeLayer</span><span class="p">.</span><span class="n">frame</span> <span class="o">=</span> <span class="n">CGRectMake</span><span class="p">(</span><span class="n">CGRectGetMinX</span><span class="p">(</span><span class="n">textLayer</span><span class="p">.</span><span class="n">frame</span><span class="p">)</span> <span class="o">-</span> <span class="n">kScaleFrom_iPhone6_Desgin</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">width</span><span class="p">);</span>
</span><span class='line'>  <span class="n">shapeLayer</span><span class="p">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">CGPointMake</span><span class="p">(</span><span class="n">shapeLayer</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">point</span><span class="p">.</span><span class="n">y</span><span class="p">);</span>
</span><span class='line'>  <span class="bp">UIBezierPath</span> <span class="o">*</span><span class="n">path</span> <span class="o">=</span> <span class="p">[</span><span class="bp">UIBezierPath</span> <span class="n">bezierPath</span><span class="p">];</span>
</span><span class='line'>  <span class="p">[</span><span class="n">path</span> <span class="nl">moveToPoint</span><span class="p">:</span><span class="n">CGPointMake</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)];</span>
</span><span class='line'>  <span class="p">[</span><span class="n">path</span> <span class="nl">addLineToPoint</span><span class="p">:</span><span class="n">CGPointMake</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="mi">0</span><span class="p">)];</span>
</span><span class='line'>  <span class="p">[</span><span class="n">path</span> <span class="nl">moveToPoint</span><span class="p">:</span><span class="n">CGPointMake</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)];</span>
</span><span class='line'>  <span class="p">[</span><span class="n">path</span> <span class="nl">addLineToPoint</span><span class="p">:</span><span class="n">CGPointMake</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">width</span><span class="p">)];</span>
</span><span class='line'>  <span class="n">shapeLayer</span><span class="p">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">path</span><span class="p">.</span><span class="bp">CGPath</span><span class="p">;</span>
</span><span class='line'>  <span class="n">shapeLayer</span><span class="p">.</span><span class="n">strokeColor</span> <span class="o">=</span> <span class="n">UIColorFromRGBA</span><span class="p">(</span><span class="mh">0xff959595</span><span class="p">).</span><span class="bp">CGColor</span><span class="p">;</span>
</span><span class='line'>  <span class="n">shapeLayer</span><span class="p">.</span><span class="n">fillColor</span> <span class="o">=</span> <span class="p">[</span><span class="bp">UIColor</span> <span class="n">clearColor</span><span class="p">].</span><span class="bp">CGColor</span><span class="p">;</span>
</span><span class='line'>  <span class="n">shapeLayer</span><span class="p">.</span><span class="n">lineWidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>  <span class="n">shapeLayer</span><span class="p">.</span><span class="n">lineCap</span> <span class="o">=</span> <span class="n">kCALineCapButt</span><span class="p">;</span>
</span><span class='line'>  <span class="n">shapeLayer</span><span class="p">.</span><span class="n">lineJoin</span> <span class="o">=</span> <span class="n">kCALineJoinMiter</span><span class="p">;</span>
</span><span class='line'>  <span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">yAxisLayer</span> <span class="nl">addSublayer</span><span class="p">:</span><span class="n">shapeLayer</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Register DDLog</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'>  <span class="c1">// Register DDLog</span>
</span><span class='line'>  <span class="p">[</span><span class="n">DDLog</span> <span class="nl">addLogger</span><span class="p">:[</span><span class="n">DDTTYLogger</span> <span class="n">sharedInstance</span><span class="p">]];</span>  <span class="c1">// TTY = Xcode console</span>
</span><span class='line'>  <span class="p">[</span><span class="n">DDLog</span> <span class="nl">addLogger</span><span class="p">:[</span><span class="n">DDASLLogger</span> <span class="n">sharedInstance</span><span class="p">]];</span>  <span class="c1">// ASL = File log</span>
</span></code></pre></td></tr></table></div></figure>




<p class='post-footer'>
  原始地址：
  <a href='http://sxgfxm.github.io/blog/2017/06/12/ioszhi-shi-xiao-ji-170605/'>http://sxgfxm.github.io/blog/2017/06/12/ioszhi-shi-xiao-ji-170605/</a><br/>
  written by <a href='http://sxgfxm.github.io'>Light</a>
  &nbsp;posted at <a href='http://sxgfxm.github.io'>http://sxgfxm.github.io</a>
  </p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[iOS知识小集-170529]]></title>
    <link href="http://sxgfxm.github.io/blog/2017/06/09/ioszhi-shi-xiao-ji-170529/"/>
    <updated>2017-06-09T10:08:09+08:00</updated>
    <id>http://sxgfxm.github.io/blog/2017/06/09/ioszhi-shi-xiao-ji-170529</id>
    <content type="html"><![CDATA[<h2>Open system wifi settings</h2>

<p><code>[[UIApplication sharedApplication] openURL:[NSURL URLWithString:@"App-Prefs:root=WIFI"]];</code></p>

<!-- more -->


<h2>UITextField</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">setupTextField</span><span class="p">{</span>
</span><span class='line'>  <span class="nb">self</span><span class="p">.</span><span class="n">wifiNameTF</span> <span class="o">=</span>
</span><span class='line'>      <span class="p">[[</span><span class="bp">UITextField</span> <span class="n">alloc</span><span class="p">]</span> <span class="nl">initWithFrame</span><span class="p">:</span><span class="n">CGRectMake</span><span class="p">(</span><span class="n">kScaleFrom_iPhone6_Desgin</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span>
</span><span class='line'>                                                    <span class="nb">self</span><span class="p">.</span><span class="n">view</span><span class="p">.</span><span class="n">bounds</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">width</span> <span class="o">-</span> <span class="n">kScaleFrom_iPhone6_Desgin</span><span class="p">(</span><span class="mi">32</span><span class="p">),</span>
</span><span class='line'>                                                    <span class="n">kScaleFrom_iPhone6_Desgin</span><span class="p">(</span><span class="mi">54</span><span class="p">))];</span>
</span><span class='line'>  <span class="nb">self</span><span class="p">.</span><span class="n">wifiNameTF</span><span class="p">.</span><span class="n">placeholder</span> <span class="o">=</span> <span class="s">@&quot;请输入Wi-Fi名称&quot;</span><span class="p">;</span>
</span><span class='line'>  <span class="nb">self</span><span class="p">.</span><span class="n">wifiNameTF</span><span class="p">.</span><span class="n">font</span> <span class="o">=</span> <span class="p">[</span><span class="bp">UIFont</span> <span class="nl">systemFontOfSize</span><span class="p">:</span><span class="n">kScaleFrom_iPhone6_Desgin</span><span class="p">(</span><span class="mi">16</span><span class="p">)];</span>
</span><span class='line'>  <span class="nb">self</span><span class="p">.</span><span class="n">wifiNameTF</span><span class="p">.</span><span class="n">textColor</span> <span class="o">=</span> <span class="n">UIColorFromRGBA</span><span class="p">(</span><span class="mh">0xff16181d</span><span class="p">);</span>
</span><span class='line'>  <span class="nb">self</span><span class="p">.</span><span class="n">wifiNameTF</span><span class="p">.</span><span class="n">clearButtonMode</span> <span class="o">=</span> <span class="n">UITextFieldViewModeWhileEditing</span><span class="p">;</span>
</span><span class='line'>  <span class="nb">self</span><span class="p">.</span><span class="n">wifiNameTF</span><span class="p">.</span><span class="n">autocapitalizationType</span> <span class="o">=</span> <span class="n">UITextAutocapitalizationTypeNone</span><span class="p">;</span>
</span><span class='line'>  <span class="nb">self</span><span class="p">.</span><span class="n">wifiNameTF</span><span class="p">.</span><span class="n">returnKeyType</span> <span class="o">=</span> <span class="n">UIReturnKeyDone</span><span class="p">;</span>
</span><span class='line'>  <span class="nb">self</span><span class="p">.</span><span class="n">wifiNameTF</span><span class="p">.</span><span class="n">delegate</span> <span class="o">=</span> <span class="nb">self</span><span class="p">;</span>
</span><span class='line'>  <span class="nb">self</span><span class="p">.</span><span class="n">wifiNameTF</span><span class="p">.</span><span class="n">secureTextEntry</span> <span class="o">=</span> <span class="nb">YES</span><span class="p">;</span>
</span><span class='line'>  <span class="nb">self</span><span class="p">.</span><span class="n">wifiNameTF</span><span class="p">.</span><span class="n">rightView</span> <span class="o">=</span> <span class="n">secureBtn</span><span class="p">;</span>
</span><span class='line'>  <span class="nb">self</span><span class="p">.</span><span class="n">wifiNameTF</span><span class="p">.</span><span class="n">rightViewMode</span> <span class="o">=</span> <span class="n">UITextFieldViewModeAlways</span><span class="p">;</span>
</span><span class='line'>  <span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">view</span> <span class="nl">addSubview</span><span class="p">:</span><span class="nb">self</span><span class="p">.</span><span class="n">wifiNameTF</span><span class="p">];</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Gradient flow animation</h2>

<p>两倍长度，添加左右移动动画，并添加左右两边覆盖层。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'>  <span class="c1">//  progress bar</span>
</span><span class='line'>  <span class="nb">self</span><span class="p">.</span><span class="n">progressBar</span> <span class="o">=</span>
</span><span class='line'>      <span class="p">[[</span><span class="bp">UIView</span> <span class="n">alloc</span><span class="p">]</span> <span class="nl">initWithFrame</span><span class="p">:</span><span class="n">CGRectMake</span><span class="p">((</span><span class="nb">self</span><span class="p">.</span><span class="n">view</span><span class="p">.</span><span class="n">bounds</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">width</span> <span class="o">-</span> <span class="n">kScaleFrom_iPhone6_Desgin</span><span class="p">(</span><span class="mi">120</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
</span><span class='line'>                                               <span class="n">kScaleFrom_iPhone6_Desgin</span><span class="p">(</span><span class="mi">360</span><span class="p">),</span> <span class="n">kScaleFrom_iPhone6_Desgin</span><span class="p">(</span><span class="mi">120</span><span class="p">),</span>
</span><span class='line'>                                               <span class="n">kScaleFrom_iPhone6_Desgin</span><span class="p">(</span><span class="mi">4</span><span class="p">))];</span>
</span><span class='line'>  <span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">view</span> <span class="nl">addSubview</span><span class="p">:</span><span class="nb">self</span><span class="p">.</span><span class="n">progressBar</span><span class="p">];</span>
</span><span class='line'>  <span class="nb">self</span><span class="p">.</span><span class="n">gradientLayer</span> <span class="o">=</span> <span class="p">[</span><span class="bp">CAGradientLayer</span> <span class="n">layer</span><span class="p">];</span>
</span><span class='line'>  <span class="nb">self</span><span class="p">.</span><span class="n">gradientLayer</span><span class="p">.</span><span class="n">frame</span> <span class="o">=</span>
</span><span class='line'>      <span class="n">CGRectMake</span><span class="p">(</span><span class="o">-</span><span class="n">kScaleFrom_iPhone6_Desgin</span><span class="p">(</span><span class="mi">120</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">kScaleFrom_iPhone6_Desgin</span><span class="p">(</span><span class="mi">240</span><span class="p">),</span> <span class="n">kScaleFrom_iPhone6_Desgin</span><span class="p">(</span><span class="mi">4</span><span class="p">));</span>
</span><span class='line'>  <span class="nb">self</span><span class="p">.</span><span class="n">gradientLayer</span><span class="p">.</span><span class="n">locations</span> <span class="o">=</span> <span class="l">@[</span> <span class="mi">@0</span><span class="p">,</span> <span class="mf">@0.15</span><span class="p">,</span> <span class="mf">@0.3</span><span class="p">,</span> <span class="mf">@0.5</span><span class="p">,</span> <span class="mf">@0.65</span><span class="p">,</span> <span class="mf">@0.8</span><span class="p">,</span> <span class="mi">@1</span> <span class="l">]</span><span class="p">;</span>
</span><span class='line'>  <span class="nb">self</span><span class="p">.</span><span class="n">gradientLayer</span><span class="p">.</span><span class="n">colors</span> <span class="o">=</span> <span class="l">@[</span>
</span><span class='line'>    <span class="p">(</span><span class="k">__bridge</span> <span class="kt">id</span><span class="p">)</span><span class="n">UIColorFromRGBA</span><span class="p">(</span><span class="mh">0xff1af28f</span><span class="p">)</span>
</span><span class='line'>        <span class="p">.</span><span class="bp">CGColor</span><span class="p">,</span>
</span><span class='line'>    <span class="p">(</span><span class="k">__bridge</span> <span class="kt">id</span><span class="p">)</span><span class="n">UIColorFromRGBA</span><span class="p">(</span><span class="mh">0xff0de9c5</span><span class="p">).</span><span class="bp">CGColor</span><span class="p">,</span>
</span><span class='line'>    <span class="p">(</span><span class="k">__bridge</span> <span class="kt">id</span><span class="p">)</span><span class="n">UIColorFromRGBA</span><span class="p">(</span><span class="mh">0xff3293fe</span><span class="p">).</span><span class="bp">CGColor</span><span class="p">,</span>
</span><span class='line'>    <span class="p">(</span><span class="k">__bridge</span> <span class="kt">id</span><span class="p">)</span><span class="n">UIColorFromRGBA</span><span class="p">(</span><span class="mh">0xff1af28f</span><span class="p">).</span><span class="bp">CGColor</span><span class="p">,</span>
</span><span class='line'>    <span class="p">(</span><span class="k">__bridge</span> <span class="kt">id</span><span class="p">)</span><span class="n">UIColorFromRGBA</span><span class="p">(</span><span class="mh">0xff0de9c5</span><span class="p">).</span><span class="bp">CGColor</span><span class="p">,</span>
</span><span class='line'>    <span class="p">(</span><span class="k">__bridge</span> <span class="kt">id</span><span class="p">)</span><span class="n">UIColorFromRGBA</span><span class="p">(</span><span class="mh">0xff3293fe</span><span class="p">).</span><span class="bp">CGColor</span><span class="p">,</span>
</span><span class='line'>    <span class="p">(</span><span class="k">__bridge</span> <span class="kt">id</span><span class="p">)</span><span class="n">UIColorFromRGBA</span><span class="p">(</span><span class="mh">0xff1af28f</span><span class="p">).</span><span class="bp">CGColor</span>
</span><span class='line'>  <span class="l">]</span><span class="p">;</span>
</span><span class='line'>  <span class="nb">self</span><span class="p">.</span><span class="n">gradientLayer</span><span class="p">.</span><span class="n">startPoint</span> <span class="o">=</span> <span class="n">CGPointMake</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span><span class='line'>  <span class="nb">self</span><span class="p">.</span><span class="n">gradientLayer</span><span class="p">.</span><span class="n">endPoint</span> <span class="o">=</span> <span class="n">CGPointMake</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span><span class='line'>  <span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">progressBar</span><span class="p">.</span><span class="n">layer</span> <span class="nl">addSublayer</span><span class="p">:</span><span class="nb">self</span><span class="p">.</span><span class="n">gradientLayer</span><span class="p">];</span>
</span><span class='line'>  <span class="bp">CALayer</span> <span class="o">*</span><span class="n">leftMask</span> <span class="o">=</span> <span class="p">[</span><span class="bp">CALayer</span> <span class="n">layer</span><span class="p">];</span>
</span><span class='line'>  <span class="n">leftMask</span><span class="p">.</span><span class="n">frame</span> <span class="o">=</span>
</span><span class='line'>      <span class="n">CGRectMake</span><span class="p">(</span><span class="o">-</span><span class="n">kScaleFrom_iPhone6_Desgin</span><span class="p">(</span><span class="mi">120</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">kScaleFrom_iPhone6_Desgin</span><span class="p">(</span><span class="mi">120</span><span class="p">),</span> <span class="n">kScaleFrom_iPhone6_Desgin</span><span class="p">(</span><span class="mi">4</span><span class="p">));</span>
</span><span class='line'>  <span class="n">leftMask</span><span class="p">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="p">[</span><span class="bp">UIColor</span> <span class="n">whiteColor</span><span class="p">].</span><span class="bp">CGColor</span><span class="p">;</span>
</span><span class='line'>  <span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">progressBar</span><span class="p">.</span><span class="n">layer</span> <span class="nl">addSublayer</span><span class="p">:</span><span class="n">leftMask</span><span class="p">];</span>
</span><span class='line'>  <span class="bp">CALayer</span> <span class="o">*</span><span class="n">rightMask</span> <span class="o">=</span> <span class="p">[</span><span class="bp">CALayer</span> <span class="n">layer</span><span class="p">];</span>
</span><span class='line'>  <span class="n">rightMask</span><span class="p">.</span><span class="n">frame</span> <span class="o">=</span>
</span><span class='line'>      <span class="n">CGRectMake</span><span class="p">(</span><span class="n">kScaleFrom_iPhone6_Desgin</span><span class="p">(</span><span class="mi">120</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">kScaleFrom_iPhone6_Desgin</span><span class="p">(</span><span class="mi">120</span><span class="p">),</span> <span class="n">kScaleFrom_iPhone6_Desgin</span><span class="p">(</span><span class="mi">4</span><span class="p">));</span>
</span><span class='line'>  <span class="n">rightMask</span><span class="p">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="p">[</span><span class="bp">UIColor</span> <span class="n">whiteColor</span><span class="p">].</span><span class="bp">CGColor</span><span class="p">;</span>
</span><span class='line'>  <span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">progressBar</span><span class="p">.</span><span class="n">layer</span> <span class="nl">addSublayer</span><span class="p">:</span><span class="n">rightMask</span><span class="p">];</span>
</span><span class='line'>  <span class="bp">CABasicAnimation</span> <span class="o">*</span><span class="n">moveAnimation</span> <span class="o">=</span> <span class="p">[</span><span class="bp">CABasicAnimation</span> <span class="nl">animationWithKeyPath</span><span class="p">:</span><span class="s">@&quot;position.x&quot;</span><span class="p">];</span>
</span><span class='line'>  <span class="n">moveAnimation</span><span class="p">.</span><span class="n">fromValue</span> <span class="o">=</span> <span class="l">@(</span><span class="nb">self</span><span class="p">.</span><span class="n">gradientLayer</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">x</span><span class="l">)</span><span class="p">;</span>
</span><span class='line'>  <span class="n">moveAnimation</span><span class="p">.</span><span class="n">toValue</span> <span class="o">=</span> <span class="l">@(</span><span class="nb">self</span><span class="p">.</span><span class="n">gradientLayer</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">kScaleFrom_iPhone6_Desgin</span><span class="p">(</span><span class="mi">120</span><span class="p">)</span><span class="l">)</span><span class="p">;</span>
</span><span class='line'>  <span class="n">moveAnimation</span><span class="p">.</span><span class="n">repeatCount</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
</span><span class='line'>  <span class="n">moveAnimation</span><span class="p">.</span><span class="n">duration</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
</span><span class='line'>  <span class="n">moveAnimation</span><span class="p">.</span><span class="n">autoreverses</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span>
</span><span class='line'>  <span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">gradientLayer</span> <span class="nl">addAnimation</span><span class="p">:</span><span class="n">moveAnimation</span> <span class="nl">forKey</span><span class="p">:</span><span class="s">@&quot;animation&quot;</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Alert with text field</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">changeName</span> <span class="p">{</span>
</span><span class='line'>  <span class="c1">// 修改昵称提示框</span>
</span><span class='line'>  <span class="n">UIAlertController</span> <span class="o">*</span><span class="n">alertController</span> <span class="o">=</span>
</span><span class='line'>      <span class="p">[</span><span class="n">UIAlertController</span> <span class="nl">alertControllerWithTitle</span><span class="p">:</span><span class="s">@&quot;Title&quot;</span>
</span><span class='line'>                                          <span class="nl">message</span><span class="p">:</span><span class="nb">nil</span>
</span><span class='line'>                                   <span class="nl">preferredStyle</span><span class="p">:</span><span class="n">UIAlertControllerStyleAlert</span><span class="p">];</span>
</span><span class='line'>  <span class="c1">// 添加输入框</span>
</span><span class='line'>  <span class="p">[</span><span class="n">alertController</span> <span class="nl">addTextFieldWithConfigurationHandler</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="bp">UITextField</span> <span class="o">*</span><span class="n">_Nonnull</span> <span class="n">textField</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">textField</span><span class="p">.</span><span class="n">placeholder</span> <span class="o">=</span> <span class="s">@&quot;Please input&quot;</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}];</span>
</span><span class='line'>  <span class="c1">// 添加确定按钮</span>
</span><span class='line'>  <span class="p">[</span><span class="n">alertController</span> <span class="nl">addAction</span><span class="p">:[</span><span class="n">UIAlertAction</span> <span class="nl">actionWithTitle</span><span class="p">:</span><span class="s">@&quot;Done&quot;</span>
</span><span class='line'>                                                      <span class="nl">style</span><span class="p">:</span><span class="n">UIAlertActionStyleDefault</span>
</span><span class='line'>                                                    <span class="nl">handler</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">UIAlertAction</span> <span class="o">*</span><span class="n">_Nonnull</span> <span class="n">action</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                                                      <span class="c1">// 获得当前输入的字符串</span>
</span><span class='line'>                                                      <span class="bp">NSString</span> <span class="o">*</span><span class="n">name</span> <span class="o">=</span> <span class="n">alertController</span><span class="p">.</span><span class="n">textFields</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">text</span><span class="p">;</span>
</span><span class='line'>                                                      <span class="nb">self</span><span class="p">.</span><span class="n">tichomeNameLbl</span><span class="p">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">name</span><span class="p">;</span>
</span><span class='line'>                                                    <span class="p">}]];</span>
</span><span class='line'>  <span class="c1">// 添加取消按钮</span>
</span><span class='line'>  <span class="p">[</span><span class="n">alertController</span> <span class="nl">addAction</span><span class="p">:[</span><span class="n">UIAlertAction</span> <span class="nl">actionWithTitle</span><span class="p">:</span><span class="s">@&quot;Cancel&quot;</span>
</span><span class='line'>                                                      <span class="nl">style</span><span class="p">:</span><span class="n">UIAlertActionStyleCancel</span>
</span><span class='line'>                                                    <span class="nl">handler</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">UIAlertAction</span> <span class="o">*</span><span class="n">_Nonnull</span> <span class="n">action</span><span class="p">){</span>
</span><span class='line'>                                                    <span class="p">}]];</span>
</span><span class='line'>  <span class="p">[</span><span class="nb">self</span> <span class="nl">presentViewController</span><span class="p">:</span><span class="n">alertController</span> <span class="nl">animated</span><span class="p">:</span><span class="nb">YES</span> <span class="nl">completion</span><span class="p">:</span><span class="nb">nil</span><span class="p">];</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>UISlider</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">setupSlider</span><span class="p">{</span>
</span><span class='line'>  <span class="nb">self</span><span class="p">.</span><span class="n">volumeSlider</span> <span class="o">=</span> <span class="p">[</span><span class="bp">UISlider</span> <span class="n">new</span><span class="p">];</span>
</span><span class='line'>  <span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">volumeSlider</span> <span class="nl">addTarget</span><span class="p">:</span><span class="nb">self</span> <span class="nl">action</span><span class="p">:</span><span class="k">@selector</span><span class="p">(</span><span class="n">changeVolumeAction</span><span class="p">)</span> <span class="nl">forControlEvents</span><span class="p">:</span><span class="n">UIControlEventTouchUpInside</span><span class="p">];</span>
</span><span class='line'>  <span class="nb">self</span><span class="p">.</span><span class="n">volumeSlider</span><span class="p">.</span><span class="n">minimumValueImage</span> <span class="o">=</span> <span class="p">[</span><span class="bp">UIImage</span> <span class="nl">imageNamed</span><span class="p">:</span><span class="s">@&quot;icVolumeDown&quot;</span><span class="p">];</span>
</span><span class='line'>  <span class="nb">self</span><span class="p">.</span><span class="n">volumeSlider</span><span class="p">.</span><span class="n">maximumValueImage</span> <span class="o">=</span> <span class="p">[</span><span class="bp">UIImage</span> <span class="nl">imageNamed</span><span class="p">:</span><span class="s">@&quot;icVolumeUp&quot;</span><span class="p">];</span>
</span><span class='line'>  <span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">volumeSlider</span> <span class="nl">setThumbImage</span><span class="p">:[</span><span class="bp">UIImage</span> <span class="nl">imageNamed</span><span class="p">:</span><span class="s">@&quot;icVolumeBtn&quot;</span><span class="p">]</span> <span class="nl">forState</span><span class="p">:</span><span class="n">UIControlStateNormal</span><span class="p">];</span>
</span><span class='line'>  <span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">volumeSlider</span> <span class="nl">setMinimumTrackImage</span><span class="p">:[</span><span class="bp">UIImage</span> <span class="nl">imageNamed</span><span class="p">:</span><span class="s">@&quot;minTrackBg&quot;</span><span class="p">]</span> <span class="nl">forState</span><span class="p">:</span><span class="n">UIControlStateNormal</span><span class="p">];</span>
</span><span class='line'>  <span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">volumeSlider</span> <span class="nl">setMaximumTrackImage</span><span class="p">:[</span><span class="bp">UIImage</span> <span class="nl">imageNamed</span><span class="p">:</span><span class="s">@&quot;maxTrackBg&quot;</span><span class="p">]</span> <span class="nl">forState</span><span class="p">:</span><span class="n">UIControlStateNormal</span><span class="p">];</span>
</span><span class='line'>  <span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">contentView</span> <span class="nl">addSubview</span><span class="p">:</span><span class="nb">self</span><span class="p">.</span><span class="n">volumeSlider</span><span class="p">];</span>
</span><span class='line'>  <span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">volumeSlider</span> <span class="nl">mas_makeConstraints</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">MASConstraintMaker</span> <span class="o">*</span><span class="n">make</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">make</span><span class="p">.</span><span class="n">centerX</span><span class="p">.</span><span class="n">equalTo</span><span class="p">(</span><span class="nb">self</span><span class="p">.</span><span class="n">contentView</span><span class="p">.</span><span class="n">mas_centerX</span><span class="p">);</span>
</span><span class='line'>    <span class="n">make</span><span class="p">.</span><span class="n">bottom</span><span class="p">.</span><span class="n">equalTo</span><span class="p">(</span><span class="nb">self</span><span class="p">.</span><span class="n">contentView</span><span class="p">.</span><span class="n">mas_bottom</span><span class="p">).</span><span class="n">offset</span><span class="p">(</span><span class="o">-</span><span class="n">kScaleFrom_iPhone6_Desgin</span><span class="p">(</span><span class="mi">15</span><span class="p">));</span>
</span><span class='line'>    <span class="n">make</span><span class="p">.</span><span class="n">width</span><span class="p">.</span><span class="n">equalTo</span><span class="p">(</span><span class="l">@(</span><span class="n">kScaleFrom_iPhone6_Desgin</span><span class="p">(</span><span class="mi">270</span><span class="p">)</span><span class="l">)</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}];</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>UITextView</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">setupTextView</span><span class="p">{</span>
</span><span class='line'>  <span class="nb">self</span><span class="p">.</span><span class="n">textView</span> <span class="o">=</span> <span class="p">[</span><span class="bp">UITextView</span> <span class="n">new</span><span class="p">];</span>
</span><span class='line'>  <span class="nb">self</span><span class="p">.</span><span class="n">textView</span><span class="p">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="p">[</span><span class="bp">UIColor</span> <span class="n">clearColor</span><span class="p">];</span>
</span><span class='line'>  <span class="nb">self</span><span class="p">.</span><span class="n">textView</span><span class="p">.</span><span class="n">text</span> <span class="o">=</span> <span class="s">@&quot;placeholder&quot;</span><span class="p">;</span>
</span><span class='line'>  <span class="nb">self</span><span class="p">.</span><span class="n">textView</span><span class="p">.</span><span class="n">textColor</span> <span class="o">=</span> <span class="p">[[</span><span class="bp">UIColor</span> <span class="n">whiteColor</span><span class="p">]</span> <span class="nl">colorWithAlphaComponent</span><span class="p">:</span><span class="mf">0.2</span><span class="p">];</span>
</span><span class='line'>  <span class="nb">self</span><span class="p">.</span><span class="n">textView</span><span class="p">.</span><span class="n">font</span> <span class="o">=</span> <span class="p">[</span><span class="bp">UIFont</span> <span class="nl">systemFontOfSize</span><span class="p">:</span><span class="mi">14</span><span class="p">];</span>
</span><span class='line'>  <span class="nb">self</span><span class="p">.</span><span class="n">textView</span><span class="p">.</span><span class="n">delegate</span> <span class="o">=</span> <span class="nb">self</span><span class="p">;</span>
</span><span class='line'>  <span class="nb">self</span><span class="p">.</span><span class="n">textView</span><span class="p">.</span><span class="n">autocapitalizationType</span> <span class="o">=</span> <span class="n">UITextAutocapitalizationTypeNone</span><span class="p">;</span>
</span><span class='line'>  <span class="nb">self</span><span class="p">.</span><span class="n">textView</span><span class="p">.</span><span class="n">returnKeyType</span> <span class="o">=</span> <span class="n">UIReturnKeyDone</span><span class="p">;</span>
</span><span class='line'>  <span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">contentView</span> <span class="nl">addSubview</span><span class="p">:</span><span class="nb">self</span><span class="p">.</span><span class="n">textView</span><span class="p">];</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//  实现placeholder功能</span>
</span><span class='line'><span class="p">-</span> <span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span><span class="nf">textViewShouldBeginEditing:</span><span class="p">(</span><span class="bp">UITextView</span> <span class="o">*</span><span class="p">)</span><span class="nv">textView</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="nb">self</span><span class="p">.</span><span class="n">isEmpty</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">textView</span><span class="p">.</span><span class="n">textColor</span> <span class="o">=</span> <span class="p">[</span><span class="bp">UIColor</span> <span class="n">whiteColor</span><span class="p">];</span>
</span><span class='line'>    <span class="n">textView</span><span class="p">.</span><span class="n">text</span> <span class="o">=</span> <span class="s">@&quot;&quot;</span><span class="p">;</span>
</span><span class='line'>    <span class="nb">self</span><span class="p">.</span><span class="n">isEmpty</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="k">return</span> <span class="nb">YES</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">textViewDidEndEditing:</span><span class="p">(</span><span class="bp">UITextView</span> <span class="o">*</span><span class="p">)</span><span class="nv">textView</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="n">textView</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">length</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nb">self</span><span class="p">.</span><span class="n">isEmpty</span> <span class="o">=</span> <span class="nb">YES</span><span class="p">;</span>
</span><span class='line'>    <span class="n">textView</span><span class="p">.</span><span class="n">text</span> <span class="o">=</span> <span class="s">@&quot;placeholder&quot;</span><span class="p">;</span>
</span><span class='line'>    <span class="n">textView</span><span class="p">.</span><span class="n">textColor</span> <span class="o">=</span> <span class="p">[[</span><span class="bp">UIColor</span> <span class="n">whiteColor</span><span class="p">]</span> <span class="nl">colorWithAlphaComponent</span><span class="p">:</span><span class="mf">0.2</span><span class="p">];</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="p">[</span><span class="n">textView</span> <span class="n">resignFirstResponder</span><span class="p">];</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//  实现换行替换为结束编辑</span>
</span><span class='line'><span class="p">-</span> <span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span><span class="nf">textView:</span><span class="p">(</span><span class="bp">UITextView</span> <span class="o">*</span><span class="p">)</span><span class="nv">textView</span> <span class="nf">shouldChangeTextInRange:</span><span class="p">(</span><span class="n">NSRange</span><span class="p">)</span><span class="nv">range</span> <span class="nf">replacementText:</span><span class="p">(</span><span class="bp">NSString</span> <span class="o">*</span><span class="p">)</span><span class="nv">text</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">([</span><span class="n">text</span> <span class="nl">isEqualToString</span><span class="p">:</span><span class="s">@&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">])</span> <span class="p">{</span>
</span><span class='line'>    <span class="p">[</span><span class="n">textView</span> <span class="n">resignFirstResponder</span><span class="p">];</span>
</span><span class='line'>    <span class="k">return</span> <span class="nb">NO</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="k">return</span> <span class="nb">YES</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>IQActionSheetPickerView</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
</pre></td><td class='code'><pre><code class='objective-c'><span class='line'><span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">setupPickerView</span><span class="p">{</span>
</span><span class='line'>  <span class="bp">NSArray</span> <span class="o">*</span><span class="n">dataSource</span> <span class="o">=</span> <span class="l">@[</span><span class="s">@&quot;item1&quot;</span><span class="p">,</span><span class="s">@&quot;item2&quot;</span><span class="p">,</span><span class="s">@&quot;item3&quot;</span><span class="l">]</span><span class="p">;</span>
</span><span class='line'>  <span class="n">IQActionSheetPickerView</span> <span class="o">*</span><span class="n">categoryPicker</span> <span class="o">=</span> <span class="p">[[</span><span class="n">IQActionSheetPickerView</span> <span class="n">alloc</span><span class="p">]</span> <span class="nl">initWithTitle</span><span class="p">:</span><span class="s">@&quot;选择&quot;</span> <span class="nl">delegate</span><span class="p">:</span><span class="nb">self</span><span class="p">];</span>
</span><span class='line'>  <span class="c1">//  tool bar</span>
</span><span class='line'>  <span class="p">[</span><span class="n">categoryPicker</span> <span class="nl">setTitleFont</span><span class="p">:[</span><span class="bp">UIFont</span> <span class="nl">systemFontOfSize</span><span class="p">:</span><span class="mi">17</span><span class="p">]];</span>
</span><span class='line'>  <span class="p">[</span><span class="n">categoryPicker</span> <span class="nl">setTitleColor</span><span class="p">:[</span><span class="bp">UIColor</span> <span class="n">whiteColor</span><span class="p">]];</span>
</span><span class='line'>  <span class="p">[</span><span class="n">categoryPicker</span> <span class="nl">setToolbarTintColor</span><span class="p">:[</span><span class="n">UIColorFromRGBA</span><span class="p">(</span><span class="mh">0xff26272e</span><span class="p">)</span> <span class="nl">colorWithAlphaComponent</span><span class="p">:</span><span class="mf">0.6</span><span class="p">]];</span>
</span><span class='line'>  <span class="p">[</span><span class="n">categoryPicker</span> <span class="nl">setDoneButtonAttributes</span><span class="p">:</span><span class="l">@{</span>
</span><span class='line'>    <span class="nl">kIQActionSheetAttributesForNormalStateKey</span> <span class="p">:</span> <span class="l">@{</span>
</span><span class='line'>      <span class="nl">NSForegroundColorAttributeName</span> <span class="p">:</span> <span class="p">[[</span><span class="bp">UIColor</span> <span class="n">whiteColor</span><span class="p">]</span> <span class="nl">colorWithAlphaComponent</span><span class="p">:</span><span class="mf">0.5</span><span class="p">],</span>
</span><span class='line'>      <span class="nl">NSFontAttributeName</span> <span class="p">:</span> <span class="p">[</span><span class="bp">UIFont</span> <span class="nl">systemFontOfSize</span><span class="p">:</span><span class="mi">15</span><span class="p">]</span>
</span><span class='line'>    <span class="l">}</span>
</span><span class='line'>  <span class="l">}</span><span class="p">];</span>
</span><span class='line'>  <span class="p">[</span><span class="n">categoryPicker</span> <span class="nl">setCancelButtonAttributes</span><span class="p">:</span><span class="l">@{</span>
</span><span class='line'>    <span class="nl">kIQActionSheetAttributesForNormalStateKey</span> <span class="p">:</span> <span class="l">@{</span>
</span><span class='line'>      <span class="nl">NSForegroundColorAttributeName</span> <span class="p">:</span> <span class="p">[[</span><span class="bp">UIColor</span> <span class="n">grayColor</span><span class="p">]</span> <span class="nl">colorWithAlphaComponent</span><span class="p">:</span><span class="mf">0.5</span><span class="p">],</span>
</span><span class='line'>      <span class="nl">NSFontAttributeName</span> <span class="p">:</span> <span class="p">[</span><span class="bp">UIFont</span> <span class="nl">systemFontOfSize</span><span class="p">:</span><span class="mi">15</span><span class="p">]</span>
</span><span class='line'>    <span class="l">}</span>
</span><span class='line'>  <span class="l">}</span><span class="p">];</span>
</span><span class='line'>  <span class="c1">//  component</span>
</span><span class='line'>  <span class="p">[</span><span class="n">categoryPicker</span> <span class="nl">setPickerViewBackgroundColor</span><span class="p">:</span><span class="n">UIColorFromRGBA</span><span class="p">(</span><span class="mh">0xff1c1d24</span><span class="p">)];</span>
</span><span class='line'>  <span class="p">[</span><span class="n">categoryPicker</span> <span class="nl">setPickerComponentsFont</span><span class="p">:[</span><span class="bp">UIFont</span> <span class="nl">systemFontOfSize</span><span class="p">:</span><span class="mi">16</span><span class="p">]];</span>
</span><span class='line'>  <span class="p">[</span><span class="n">categoryPicker</span> <span class="nl">setPickerComponentsColor</span><span class="p">:[</span><span class="bp">UIColor</span> <span class="n">whiteColor</span><span class="p">]];</span>
</span><span class='line'>  <span class="c1">//  data source</span>
</span><span class='line'>  <span class="p">[</span><span class="n">categoryPicker</span> <span class="nl">setTitlesForComponents</span><span class="p">:</span><span class="l">@[</span> <span class="n">dataSource</span> <span class="l">]</span><span class="p">];</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="nb">self</span><span class="p">.</span><span class="n">category</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="p">[</span><span class="n">categoryPicker</span> <span class="nl">setSelectedTitles</span><span class="p">:</span><span class="l">@[</span> <span class="s">@&quot;item2&quot;</span> <span class="l">]</span><span class="p">];</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="c1">//  show</span>
</span><span class='line'>  <span class="p">[</span><span class="n">categoryPicker</span> <span class="n">show</span><span class="p">];</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">actionSheetPickerView:</span><span class="p">(</span><span class="n">IQActionSheetPickerView</span> <span class="o">*</span><span class="p">)</span><span class="nv">pickerView</span> <span class="nf">didSelectTitles:</span><span class="p">(</span><span class="bp">NSArray</span> <span class="o">*</span><span class="p">)</span><span class="nv">titles</span> <span class="p">{</span>
</span><span class='line'>  <span class="c1">//  do something with selected item</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>NSURLSession</h2>

<p>completion handler 并非在主线程回调。<br/>
UI相关操作必须在主线程执行。</p>

<h2>Protocol Buffers</h2>

<p>Protocol buffers – a language-neutral, platform-neutral, extensible way of serializing structured data for use in communications protocols, data storage, and more.<br/>
Protocol buffers have many advantages over XML for serializing structured data. Protocol buffers:<br/>
  are simpler<br/>
  are 3 to 10 times smaller<br/>
  are 20 to 100 times faster<br/>
  are less ambiguous<br/>
  generate data access classes that are easier to use programmatically</p>

<ol>
<li>protoc</li>
<li>build rules</li>
<li>build phases</li>
</ol>


<h2>Undefined symbols for architecture arm64</h2>

<p>build phases -> compile source</p>

<h2>NSError</h2>

<p>error.localizedDescription</p>

<h2>block</h2>

<p>循环引用。</p>

<p class='post-footer'>
  原始地址：
  <a href='http://sxgfxm.github.io/blog/2017/06/09/ioszhi-shi-xiao-ji-170529/'>http://sxgfxm.github.io/blog/2017/06/09/ioszhi-shi-xiao-ji-170529/</a><br/>
  written by <a href='http://sxgfxm.github.io'>Light</a>
  &nbsp;posted at <a href='http://sxgfxm.github.io'>http://sxgfxm.github.io</a>
  </p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[iOS知识小集-170522]]></title>
    <link href="http://sxgfxm.github.io/blog/2017/06/09/ioszhi-shi-xiao-ji-170522/"/>
    <updated>2017-06-09T09:57:35+08:00</updated>
    <id>http://sxgfxm.github.io/blog/2017/06/09/ioszhi-shi-xiao-ji-170522</id>
    <content type="html"><![CDATA[<h2>Networking Concepts</h2>

<p><a href="https://developer.apple.com/library/content/documentation/NetworkingInternet/Conceptual/NetworkingConcepts/Introduction/Introduction.html#//apple_ref/doc/uid/TP40012487">Networking Concepts</a></p>

<!-- more -->


<h3>Networking Terminology</h3>

<p><strong>host</strong>: a host is any device that is connected to a network and provides an endpoint for networked communication.It is called a host because it hosts the applications and daemons that run on it.<br/>
<strong>nfrastructure device</strong>: an infrastructure device is any piece of equipment that is responsible for making the network function.
When one host sends data across a network, it divides the data into small pieces called packets.
A packet generally contains three basic parts: a <strong>header</strong> that tells where the packet should be sent, a <strong>payload</strong> that contains the actual data, and a <strong>trailer</strong> that contains checksum information to ensure that the packet was received correctly.<br/>
<strong>encapsulation</strong>: When one packet contains another packet (generally of a different type), this is called encapsulation.</p>

<h3>Networking Layers</h3>

<p><strong>Link Layer</strong>: The bottommost layer is the link layer, or <strong>physical layer</strong>.This layer of the networking stack involves the actual hardware used to communicate with nearby physically connected hosts.A network interface is a piece of hardware that provides a link-layer interconnect.<br/>
<strong>IP Layer</strong>: Sitting on top of the link layer is the IP layer. The IP layer provides packet transport from one host to another in such a way that the packets can pass across multiple physical networks. The path your packets take is called a route, and each link that the packets follow from one router to another along the route is called a hop.To hide this difference, the IP layer splits packets into multiple pieces—a process known as fragmentation—and reassembles them at the other end.<br/>
<strong>Transport Layer</strong>: On top of the IP layer, you’ll find several transport layers. The two most common protocols at this layer are the transmission control protocol (TCP) and the user datagram protocol (UDP). Both TCP and UDP provide basic data transport from one host to another, much like IP, but add the notion of port numbers.<br/>
<strong>UDP</strong><br/>
  No guarantee &mdash;- Like the layers below it, UDP provides no guarantee that the data will ever reach its destination.<br/>
  Low latency &mdash;- UDP may be a good choice for situations where low latency is required.<br/>
  Broadcast messages in IPv4 &mdash;- packets sent to a broadcast address are received by every host within its broadcast domain.<br/>
  Multicast messages &mdash;- UDP packets sent to a multicast address are sent out to any host that subscribes to them.<br/>
  Preservation of record (packet) boundaries &mdash;- With UDP, the receiver sees each message individually instead of as a continuous stream of bytes.<br/>
<strong>TCP </strong> <br/>
  Delivery guarantees &mdash;- Data transmitted using TCP is guaranteed to be received in the order in which it was sent and (connection failures notwithstanding) in its entirety.<br/>
  Congestion control &mdash;- Sending hosts back off the speed of transmission (and retransmission) if data is getting dropped along the way due to an over-utilized link.<br/>
  Flow control &mdash;- When busy, receiving hosts tell sending hosts to wait until they are ready to handle more data.<br/>
  Stream-based data flow &mdash;- Your software sees the data as a series of bytes instead of as a series of discrete records (messages, in UDP parlance)<br/>
  Path MTU discovery &mdash;- TCP chooses the largest packet size that avoids fragmentation en route.<br/>
<strong>Application Layer</strong>: The application layer sits at the top of the protocol stack. This layer includes such protocols as hypertext transfer protocol (HTTP) and file transfer protocol (FTP).</p>

<h3>Understanding Latency</h3>

<p>Latency refers to the round-trip time for a request. Every network has latency.<br/>
The minimum latency between two points on the earth can be calculated by dividing the distance by the speed at which light or electricity moves in a particular medium.<br/>
Routing delays.<br/>
Retransmission and exponential backoff.<br/>
Signal propagation delays within hardware that receives, transmits, forwards, or repeats packets.</p>

<h3>Addressing Schemes and Domain Names</h3>

<p>At every level of networking, each host is assigned one or more numeric identifiers that uniquely represent it within a particular network.<br/>
<strong>Link-Layer Addressing</strong>: At the link layer (physical layer), each network interface is usually identified by a globally unique hardware ID: Ethernet—MAC address etc.The hardware ID is used to determine whether a particular device should listen to a packet or ignore it.<br/>
<strong>IP-Layer Addressing</strong>: At the IP layer and above, hosts are identified by an IP address. An IP address can be in one of two forms: IPv4 or IPv6.<br/>
  <strong>IPv4</strong>: An IPv4 address consists of four bytes, and is usually represented to the user as a series of four numbers separated by decimal points.<br/>
  <strong>IPv6</strong>: An IPv6 address is a 128-bit value, and is usually written as eight groups of 16-bit hexadecimal numbers separated by colons. Leading zeros in each group can be omitted as long as there is at least one digit in each group.<br/>
<strong>Domain Name System (DNS)</strong>:
A domain name is a human-readable name that describes a particular host. Each domain name is made up of a series of parts separated by periods.<br/>
Features:<br/>
  Minimize service disruption when an IP address changes.<br/>
  Allow a host to be accessed by more than one address.<br/>
  Allow multiple physical hosts to pretend to be a single host.<br/>
  Can adapt to changes in the underlying technology.<br/>
  Being easier to remember.</p>

<h3>Packet Routing and Delivery</h3>

<p>Each packet contains a the link-layer address of its intended recipient.</p>

<h2>Networking Overview</h2>

<p><a href="https://developer.apple.com/library/content/documentation/NetworkingInternetWeb/Conceptual/NetworkingOverview/Introduction/Introduction.html#//apple_ref/doc/uid/TP40010220">Networking Overview</a></p>

<h2>Bonjour Overview</h2>

<p><a href="https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/NetServices/Introduction.html#//apple_ref/doc/uid/10000119i">Bonjour Overview</a></p>

<p>The Bonjour zero-configuration networking architecture provides support for publishing and discovering TCP/IP-based services on a local area or wide area network.<br/>
Bonjour is Apple’s implementation of a suite of zero-configuration networking protocols. Bonjour is designed to make network configuration easier for users.</p>

<h2>NSNetServices and CFNetworkServices Programming Guide</h2>

<p><a href="https://developer.apple.com/library/content/documentation/Networking/Conceptual/NSNetServiceProgGuide/Introduction.html#//apple_ref/doc/uid/TP40002736">NSNetServices and CFNetworkServices Programming Guide</a></p>

<h2>DNS Service Discovery Programming Guide</h2>

<p><a href="https://developer.apple.com/library/content/documentation/Networking/Conceptual/dns_discovery_api/Introduction.html#//apple_ref/doc/uid/TP30000964">DNS Service Discovery Programming Guide</a></p>

<p class='post-footer'>
  原始地址：
  <a href='http://sxgfxm.github.io/blog/2017/06/09/ioszhi-shi-xiao-ji-170522/'>http://sxgfxm.github.io/blog/2017/06/09/ioszhi-shi-xiao-ji-170522/</a><br/>
  written by <a href='http://sxgfxm.github.io'>Light</a>
  &nbsp;posted at <a href='http://sxgfxm.github.io'>http://sxgfxm.github.io</a>
  </p>

]]></content>
  </entry>
  
</feed>
